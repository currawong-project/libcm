<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>cmScore.h</title>
    <link href="cdg_code.css"    rel="stylesheet" type="text/css" media="screen" />
  </head>
  <body>
    <div class="highlight">

      <div class="license">
	<p>
	  Copyright (C) Kevin Larke 2009-2020
	</p>

	<p>
	  This file is part of libcm.
	</p>

	<p>
	  libcm is free software: you can redistribute it and/or modify it under
	  the terms of the GNU General Public License as published by the Free
	  Software Foundation, either version 3 of the License, or (at your
	  option) any later version.
	</p>

	<p>
	  libcm is distributed in the hope that it will be useful, but WITHOUT
	  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
	  FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
	  for more details.
	</p>

	<p>
	  See the GNU General Public License distributed with the libcm
	  package or look here: <https://www.gnu.org/licenses/>.
	</p>


      </div>

      <hr>
<a name="cmScore.h"></a><!-- Begin nodes -->
<div class="cod"><div class="blk_title">cmScore : Object for managing musical score data.</div><pre><a name="cmScore_h_code_0"></a>
<span class="k">enum</span>
<span class="p">{</span>
  <a name="kOkScRC"></a><span class="e">kOkScRC</span> <span class="p">=</span> <a href="cmGlobal_h_0.html#cmOkRC">cmOkRC</a><span class="p">,</span>
  <a name="kCsvFailScRC"></a><span class="e">kCsvFailScRC</span><span class="p">,</span>
  <a name="kSyntaxErrScRC"></a><span class="e">kSyntaxErrScRC</span><span class="p">,</span>
  <a name="kInvalidIdxScRC"></a><span class="e">kInvalidIdxScRC</span><span class="p">,</span>
  <a name="kTimeLineFailScRC"></a><span class="e">kTimeLineFailScRC</span><span class="p">,</span>
  <a name="kInvalidDynRefCntScRC"></a><span class="e">kInvalidDynRefCntScRC</span><span class="p">,</span>
  <a name="kMidiFileFailScRC"></a><span class="e">kMidiFileFailScRC</span><span class="p">,</span>
  <a name="kPedalInvalidScRC"></a><span class="e">kPedalInvalidScRC</span><span class="p">,</span>
  <a name="kFileFailScRC"></a><span class="e">kFileFailScRC</span>
<span class="p">}</span><span class="p">;</span>

<span class="k">enum</span>
<span class="p">{</span>
  <a name="kInvalidEvtScId"></a><span class="e">kInvalidEvtScId</span> <span class="p">=</span> <span class="l">0</span><span class="p">,</span>
  <a name="kTimeSigEvtScId"></a><span class="e">kTimeSigEvtScId</span><span class="p">,</span>
  <a name="kKeySigEvtScId"></a><span class="e">kKeySigEvtScId</span><span class="p">,</span>
  <a name="kTempoEvtScId"></a><span class="e">kTempoEvtScId</span><span class="p">,</span>
  <a name="kTrackEvtScId"></a><span class="e">kTrackEvtScId</span><span class="p">,</span>
  <a name="kTextEvtScId"></a><span class="e">kTextEvtScId</span><span class="p">,</span>
  <a name="kNameEvtScId"></a><span class="e">kNameEvtScId</span><span class="p">,</span>
  <a name="kEOTrackEvtScId"></a><span class="e">kEOTrackEvtScId</span><span class="p">,</span>
  <a name="kCopyEvtScId"></a><span class="e">kCopyEvtScId</span><span class="p">,</span>
  <a name="kBlankEvtScId"></a><span class="e">kBlankEvtScId</span><span class="p">,</span>
  <a name="kBarEvtScId"></a><span class="e">kBarEvtScId</span><span class="p">,</span>
  <a name="kPgmEvtScId"></a><span class="e">kPgmEvtScId</span><span class="p">,</span>
  <a name="kCtlEvtScId"></a><span class="e">kCtlEvtScId</span><span class="p">,</span>
  <a name="kNonEvtScId"></a><span class="e">kNonEvtScId</span><span class="p">,</span>
  <a name="kPedalEvtScId"></a><span class="e">kPedalEvtScId</span>
<span class="p">}</span><span class="p">;</span>

<span class="c">// Flags used by cmScoreEvt_t.flags</span>
<span class="k">enum</span>
<span class="p">{</span>
  <a name="kEvenScFl"></a><span class="e">kEvenScFl</span>    <span class="p">=</span> <span class="l">0x001</span><span class="p">,</span>        <span class="c"> // This note is marked for evenness measurement</span>
  <a name="kDynScFl"></a><span class="e">kDynScFl</span>     <span class="p">=</span> <span class="l">0x002</span><span class="p">,</span>        <span class="c"> // This note is marked for dynamics measurement</span>
  <a name="kTempoScFl"></a><span class="e">kTempoScFl</span>   <span class="p">=</span> <span class="l">0x004</span><span class="p">,</span>        <span class="c"> // This note is marked for tempo measurement</span>
  <a name="kSkipScFl"></a><span class="e">kSkipScFl</span>    <span class="p">=</span> <span class="l">0x008</span><span class="p">,</span>        <span class="c"> // This isn't a real event (e.g. tied note) skip over it</span>
  <a name="kGraceScFl"></a><span class="e">kGraceScFl</span>   <span class="p">=</span> <span class="l">0x010</span><span class="p">,</span>        <span class="c"> // This is a grace note</span>
  <a name="kInvalidScFl"></a><span class="e">kInvalidScFl</span> <span class="p">=</span> <span class="l">0x020</span><span class="p">,</span>        <span class="c"> // This note has a calculated time</span>
  <a name="kPedalDnScFl"></a><span class="e">kPedalDnScFl</span>   <span class="p">=</span> <span class="l">0x040</span><span class="p">,</span>        <span class="c"> // This is a pedal down event (pitch holds the pedal id and durSecs holds the time the pedal will remain down.)</span>
  <a name="kPedalUpScFl"></a><span class="e">kPedalUpScFl</span>   <span class="p">=</span> <span class="l">0x080</span>         <span class="c"> // This is a pedal up event (pitch holds the pedal id)</span>
<span class="p">}</span><span class="p">;</span>


<span class="c">// Id's used by cmScoreSet_t.varId and as indexes into
// cmScoreSection_t.vars[].</span>
<span class="k">enum</span>
<span class="p">{</span>
  <a name="kInvalidVarScId"></a><span class="e">kInvalidVarScId</span><span class="p">,</span> <span class="c"> // 0</span>
  <a name="kEvenVarScId"></a><span class="e">kEvenVarScId</span><span class="p">,</span>    <span class="c"> // 1</span>
  <a name="kDynVarScId"></a><span class="e">kDynVarScId</span><span class="p">,</span>     <span class="c"> // 2</span>
  <a name="kTempoVarScId"></a><span class="e">kTempoVarScId</span><span class="p">,</span>   <span class="c"> // 3</span>
  <a name="kScVarCnt"></a><span class="e">kScVarCnt</span>       
<span class="p">}</span><span class="p">;</span>

<span class="k">struct</span> <span class="i"><a href="#cmScoreLoc_str">cmScoreLoc_str</a></span><span class="p">;</span>
<span class="k">struct</span> <span class="i"><a href="#cmScoreSet_str">cmScoreSet_str</a></span><span class="p">;</span>

<span class="c">// The score can be divided into arbitrary non-overlapping sections.</span>
<a name="cmScoreSection_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span>         <span class="i">label</span><span class="p">;</span>             <span class="c"> // section label</span>
  <span class="k">unsigned</span>                <a name="cmScoreSection_t.index"></a><span class="i">index</span><span class="p">;</span>             <span class="c"> // index of this record in the internal section array</span>
  <span class="k">struct</span> <a href="#cmScoreLoc_str">cmScoreLoc_str</a><span class="p">*</span>  <a name="cmScoreSection_t.locPtr"></a><span class="i">locPtr</span><span class="p">;</span>            <span class="c"> // location where this section starts</span>
  <span class="k">unsigned</span>                <a name="cmScoreSection_t.begEvtIndex"></a><span class="i">begEvtIndex</span><span class="p">;</span>       <span class="c"> // score element index where this section starts </span>
  <span class="k">unsigned</span>                <a name="cmScoreSection_t.setCnt"></a><span class="i">setCnt</span><span class="p">;</span>            <span class="c"> // Count of elements in setArray[]</span>
  <span class="k">struct</span> <a href="#cmScoreSet_str">cmScoreSet_str</a><span class="p">*</span><span class="p">*</span> <a name="cmScoreSection_t.setArray"></a><span class="i">setArray</span><span class="p">;</span>          <span class="c"> // Ptrs to sets which are applied to this section.</span>
  <span class="k">double</span>                  <a name="cmScoreSection_t.vars"></a><span class="i">vars</span><span class="p">[</span> <a href="#kScVarCnt">kScVarCnt</a> <span class="p">]</span><span class="p">;</span> <span class="c"> // Set to DBL_MAX by default.</span>
<span class="p">}</span> <span class="t"><a href="#cmScoreSection_t">cmScoreSection_t</a></span><span class="p">;</span>

<a name="cmScoreEvt_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <span class="k">unsigned</span>     <a name="cmScoreEvt_t.type"></a><span class="i">type</span><span class="p">;</span>         <span class="c"> // Event type</span>
  <span class="k">double</span>       <a name="cmScoreEvt_t.secs"></a><span class="i">secs</span><span class="p">;</span>         <span class="c"> // Time location in seconds </span>
  <span class="k">double</span>       <a name="cmScoreEvt_t.durSecs"></a><span class="i">durSecs</span><span class="p">;</span>      <span class="c"> // Duration in seconds</span>
  <span class="k">unsigned</span>     <a name="cmScoreEvt_t.index"></a><span class="i">index</span><span class="p">;</span>        <span class="c"> // Index of this event in the event array.</span>
  <span class="k">unsigned</span>     <a name="cmScoreEvt_t.locIdx"></a><span class="i">locIdx</span><span class="p">;</span>       <span class="c"> // Index of the location containing this event</span>
  <a href="cmMidi_h_0.html#cmMidiByte_t">cmMidiByte_t</a> <a name="cmScoreEvt_t.pitch"></a><span class="i">pitch</span><span class="p">;</span>        <span class="c"> // MIDI pitch of this note or the MIDI pedal id of pedal down/up msg (64=sustain 65=sostenuto 66=soft)</span>
  <a href="cmMidi_h_0.html#cmMidiByte_t">cmMidiByte_t</a> <a name="cmScoreEvt_t.vel"></a><span class="i">vel</span><span class="p">;</span>          <span class="c"> // MIDI velocity of this note</span>
  <span class="k">unsigned</span>     <a name="cmScoreEvt_t.flags"></a><span class="i">flags</span><span class="p">;</span>        <span class="c"> // Attribute flags for this event</span>
  <span class="k">unsigned</span>     <a name="cmScoreEvt_t.dynVal"></a><span class="i">dynVal</span><span class="p">;</span>       <span class="c"> // Dynamcis value pppp to ffff (1 to 11) for this note.</span>
  <span class="k">double</span>       <a name="cmScoreEvt_t.frac"></a><span class="i">frac</span><span class="p">;</span>         <span class="c"> // Note's time value for tempo and non-grace evenness notes.</span>
  <span class="k">unsigned</span>     <a name="cmScoreEvt_t.barNumb"></a><span class="i">barNumb</span><span class="p">;</span>      <span class="c"> // Bar id of the measure containing this event.</span>
  <span class="k">unsigned</span>     <a name="cmScoreEvt_t.barNoteIdx"></a><span class="i">barNoteIdx</span><span class="p">;</span>   <span class="c"> // Index of this note in this bar</span>
  <span class="k">unsigned</span>     <a name="cmScoreEvt_t.csvRowNumb"></a><span class="i">csvRowNumb</span><span class="p">;</span>   <span class="c"> // File row number (not index) from which this record originated</span>
  <span class="k">unsigned</span>     <a name="cmScoreEvt_t.perfSmpIdx"></a><span class="i">perfSmpIdx</span><span class="p">;</span>   <span class="c"> // Time this event was performed or <a href="cmGlobal_h_0.html#cmInvalidIdx">cmInvalidIdx</a> if the event was not performed.</span>
  <span class="k">unsigned</span>     <a name="cmScoreEvt_t.perfVel"></a><span class="i">perfVel</span><span class="p">;</span>      <span class="c"> // Velocity of the performed note or 0 if the note was not performed.</span>
  <span class="k">unsigned</span>     <a name="cmScoreEvt_t.perfDynLvl"></a><span class="i">perfDynLvl</span><span class="p">;</span>   <span class="c"> // Index into dynamic level ref. array assoc'd with perfVel </span>
  <span class="k">unsigned</span>     <a name="cmScoreEvt_t.line"></a><span class="i">line</span><span class="p">;</span>         <span class="c"> // Line number of this event in the score file.</span>
  <span class="k">unsigned</span>     <a name="cmScoreEvt_t.csvEventId"></a><span class="i">csvEventId</span><span class="p">;</span>   <span class="c"> // EventId from CSV 'evt' column.</span>
<span class="p">}</span> <span class="t"><a href="#cmScoreEvt_t">cmScoreEvt_t</a></span><span class="p">;</span>

<span class="c">// A 'set' is a collection of events that are grouped in time and all marked with a given attribute.
// (e.g. eveness, tempo, dynamcs ... )</span>
<a name="cmScoreSet_t"></a><span class="k">typedef</span> <span class="k">struct</span> <a name="cmScoreSet_str"></a>cmScoreSet_str
<span class="p">{</span>
  <span class="k">unsigned</span>               <a name="cmScoreSet_t.varId"></a><span class="i">varId</span><span class="p">;</span>      <span class="c"> // See kXXXVarScId flags above</span>
  <a href="#cmScoreEvt_t">cmScoreEvt_t</a><span class="p">*</span><span class="p">*</span>         <a name="cmScoreSet_t.eleArray"></a><span class="i">eleArray</span><span class="p">;</span>   <span class="c"> // Events that make up this set in time order</span>
  <span class="k">unsigned</span>               <a name="cmScoreSet_t.eleCnt"></a><span class="i">eleCnt</span><span class="p">;</span>     <span class="c"> </span>
  <a href="#cmScoreSection_t">cmScoreSection_t</a><span class="p">*</span><span class="p">*</span>     <a name="cmScoreSet_t.sectArray"></a><span class="i">sectArray</span><span class="p">;</span>  <span class="c"> // Sections this set will be applied to</span>
  <span class="k">unsigned</span>               <a name="cmScoreSet_t.sectCnt"></a><span class="i">sectCnt</span><span class="p">;</span>    <span class="c"> </span>
  <span class="k">unsigned</span><span class="p">*</span>              <a name="cmScoreSet_t.symArray"></a><span class="i">symArray</span><span class="p">;</span>   <span class="c"> // symArray[sectCnt] - symbol name of all variables represented by this set (e.g '1a-e', '1b-e', '2-t', etc)</span>
  <span class="k">unsigned</span><span class="p">*</span>              <a name="cmScoreSet_t.costSymArray"></a><span class="i">costSymArray</span><span class="p">;</span> <span class="c"> // costSymArray[sectCnt] - same as symbols in symArray[] with 'c' prepended to front</span>
  <span class="k">bool</span>                   <a name="cmScoreSet_t.doneFl"></a><span class="i">doneFl</span><span class="p">;</span>
  <span class="k">double</span>                 <a name="cmScoreSet_t.value"></a><span class="i">value</span><span class="p">;</span>
  <span class="k">struct</span> <a href="#cmScoreSet_str">cmScoreSet_str</a><span class="p">*</span> <a name="cmScoreSet_t.llink"></a><span class="i">llink</span><span class="p">;</span>      <span class="c"> // <a href="#cmScoreLoc_t">cmScoreLoc_t</a> setList link</span>
<span class="p">}</span> <span class="t"><a href="#cmScoreSet_t">cmScoreSet_t</a></span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">enum</span>
<span class="p">{</span>
  <a name="kInvalidScMId"></a><span class="e">kInvalidScMId</span><span class="p">,</span>
  <a name="kRecdBegScMId"></a><span class="e">kRecdBegScMId</span><span class="p">,</span>
  <a name="kRecdEndScMId"></a><span class="e">kRecdEndScMId</span><span class="p">,</span>
  <a name="kFadeScMId"></a><span class="e">kFadeScMId</span><span class="p">,</span>
  <a name="kPlayBegScMId"></a><span class="e">kPlayBegScMId</span><span class="p">,</span>
  <a name="kPlayEndScMId"></a><span class="e">kPlayEndScMId</span>  
<span class="p">}</span> <a name="cmMarkScMId_t"></a><span class="t">cmMarkScMId_t</span><span class="p">;</span>

<span class="c">// score markers</span>
<a name="cmScoreMarker_t"></a><span class="k">typedef</span> <span class="k">struct</span> <a name="cmScoreMarker_str"></a>cmScoreMarker_str
<span class="p">{</span>
  <a href="#cmMarkScMId_t">cmMarkScMId_t</a>             <a name="cmScoreMarker_t.markTypeId"></a><span class="i">markTypeId</span><span class="p">;</span>  <span class="c"> // marker type</span>
  <span class="k">unsigned</span>                  <a name="cmScoreMarker_t.labelSymId"></a><span class="i">labelSymId</span><span class="p">;</span>  <span class="c"> // marker label</span>
  <span class="k">struct</span> <a href="#cmScoreLoc_str">cmScoreLoc_str</a><span class="p">*</span>    <a name="cmScoreMarker_t.scoreLocPtr"></a><span class="i">scoreLocPtr</span><span class="p">;</span> <span class="c"> // score location of the marker</span>
  <span class="k">unsigned</span>                  <a name="cmScoreMarker_t.csvRowIdx"></a><span class="i">csvRowIdx</span><span class="p">;</span>   <span class="c"> // score CSV file line assoc'd w/ this marker</span>
  <span class="k">struct</span> <a href="#cmScoreMarker_str">cmScoreMarker_str</a><span class="p">*</span> <a name="cmScoreMarker_t.link"></a><span class="i">link</span><span class="p">;</span>        <span class="c"> // cmScoreLoc_t.markList links</span>
<span class="p">}</span> <span class="t"><a href="#cmScoreMarker_t">cmScoreMarker_t</a></span><span class="p">;</span>

<span class="c">// All events which are simultaneous are collected into a single
// <a href="#cmScoreLoc_t">cmScoreLoc_t</a> record.</span>
<a name="cmScoreLoc_t"></a><span class="k">typedef</span> <span class="k">struct</span> <a name="cmScoreLoc_str"></a>cmScoreLoc_str
<span class="p">{</span>    
  <span class="k">unsigned</span>          <a name="cmScoreLoc_t.index"></a><span class="i">index</span><span class="p">;</span>         <span class="c"> // index of this location record</span>
  <span class="k">double</span>            <a name="cmScoreLoc_t.secs"></a><span class="i">secs</span><span class="p">;</span>          <span class="c"> // Time of this location</span>
  <span class="k">unsigned</span>          <a name="cmScoreLoc_t.evtCnt"></a><span class="i">evtCnt</span><span class="p">;</span>        <span class="c"> // Count of events in evtArray[].</span>
  <a href="#cmScoreEvt_t">cmScoreEvt_t</a><span class="p">*</span><span class="p">*</span>    <a name="cmScoreLoc_t.evtArray"></a><span class="i">evtArray</span><span class="p">;</span>      <span class="c"> // Events which occur at this time.</span>
  <span class="k">unsigned</span>          <a name="cmScoreLoc_t.barNumb"></a><span class="i">barNumb</span><span class="p">;</span>       <span class="c"> // Bar number this event is contained by. </span>
  <a href="#cmScoreSet_t">cmScoreSet_t</a><span class="p">*</span>     <a name="cmScoreLoc_t.setList"></a><span class="i">setList</span><span class="p">;</span>       <span class="c"> // Set's which end on this time location (linked through cmScoreSet_t.llink)</span>
  <a href="#cmScoreSection_t">cmScoreSection_t</a><span class="p">*</span> <a name="cmScoreLoc_t.begSectPtr"></a><span class="i">begSectPtr</span><span class="p">;</span>    <span class="c"> // NULL if this location does not start a section</span>
  <a href="#cmScoreMarker_t">cmScoreMarker_t</a><span class="p">*</span>  <a name="cmScoreLoc_t.markList"></a><span class="i">markList</span><span class="p">;</span>      <span class="c"> // List of markers assigned to this location</span>
<span class="p">}</span> <span class="t"><a href="#cmScoreLoc_t">cmScoreLoc_t</a></span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">void</span> <span class="p">(</span><span class="p">*</span><a name="cmScCb_t"></a><span class="t">cmScCb_t</span><span class="p">)</span><span class="p">(</span> <span class="k">void</span><span class="p">*</span> <span class="i">arg</span><span class="p">,</span> <span class="k">const</span> <span class="k">void</span><span class="p">*</span> <span class="i">data</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">byteCnt</span> <span class="p">)</span><span class="p">;</span>

<span class="k">typedef</span> <a href="cmGlobal_h_0.html#cmRC_t">cmRC_t</a>     <a name="cmScRC_t"></a><span class="t">cmScRC_t</span><span class="p">;</span>
<span class="k">typedef</span> <a href="cmGlobal_h_0.html#cmHandle_t">cmHandle_t</a> <a name="cmScH_t"></a><span class="t">cmScH_t</span><span class="p">;</span>

<span class="k">extern</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">cmScNullHandle</span><span class="p">;</span>

<span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> <a name="cmScEvtTypeIdToLabel"></a><span class="f">cmScEvtTypeIdToLabel</span><span class="p">(</span> <span class="k">unsigned</span> <span class="i">id</span> <span class="p">)</span><span class="p">;</span>
<span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> <a name="cmScDynIdToLabel"></a><span class="f">cmScDynIdToLabel</span><span class="p">(</span> <span class="k">unsigned</span> <span class="i">id</span> <span class="p">)</span><span class="p">;</span>
<span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> <a name="cmScStatusToOpString"></a><span class="f">cmScStatusToOpString</span><span class="p">(</span> <span class="k">unsigned</span> <span class="i">id</span> <span class="p">)</span><span class="p">;</span>

<span class="c">// Initialize a score object from a CSV File generated from a score spreadsheet.
// The dynRefArray[dynRefCnt] and cbFunc(cbArg) are optional if these 
// features are not used.
// If provided the dynRefArray[] is copied into an internal array.
// The physical array passed here therefore does not need to remain valid.
// Set 'srate' to zero if the score will not be used to perform measurement calculations.
// The symbol table is only necessary if valid symbols are to be assigned to the cmScoreSet_t.symArray[].</span>
<a href="#cmScRC_t">cmScRC_t</a>      <a name="cmScoreInitialize"></a><span class="f">cmScoreInitialize</span><span class="p">(</span> <a href="cmCtx_h_0.html#cmCtx_t">cmCtx_t</a><span class="p">*</span> <span class="i">ctx</span><span class="p">,</span> <a href="#cmScH_t">cmScH_t</a><span class="p">*</span> <span class="i">hp</span><span class="p">,</span> <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> <span class="i">fn</span><span class="p">,</span> <span class="k">double</span> <span class="i">srate</span><span class="p">,</span> <span class="k">const</span> <span class="k">unsigned</span><span class="p">*</span> <span class="i">dynRefArray</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">dynRefCnt</span><span class="p">,</span> <a href="#cmScCb_t">cmScCb_t</a> <span class="i">cbFunc</span><span class="p">,</span> <span class="k">void</span><span class="p">*</span> <span class="i">cbArg</span><span class="p">,</span> <a href="cmSymTbl_h_0.html#cmSymTblH_t">cmSymTblH_t</a> <span class="i">stH</span> <span class="p">)</span><span class="p">;</span>
<a href="#cmScRC_t">cmScRC_t</a>      <a name="cmScoreFinalize"></a><span class="f">cmScoreFinalize</span><span class="p">(</span>   <a href="#cmScH_t">cmScH_t</a><span class="p">*</span> <span class="i">hp</span> <span class="p">)</span><span class="p">;</span>

<span class="c">// Filename of last successfuly loaded score file.</span>
<span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> <a name="cmScoreFileName"></a><span class="f">cmScoreFileName</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span> <span class="p">)</span><span class="p">;</span>

<span class="c">// Sample rate as set in <a href="#cmScoreInitialize">cmScoreInitialize</a>()</span>
<span class="k">double</span>          <a name="cmScoreSampleRate"></a><span class="f">cmScoreSampleRate</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span> <span class="p">)</span><span class="p">;</span>

<span class="c">// Validate the score handle</span>
<span class="k">bool</span>          <a name="cmScoreIsValid"></a><span class="f">cmScoreIsValid</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span> <span class="p">)</span><span class="p">;</span>

<span class="c">// Access the score data.</span>
<span class="k">unsigned</span>      <a name="cmScoreEvtCount"></a><span class="f">cmScoreEvtCount</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span> <span class="p">)</span><span class="p">;</span>
<a href="#cmScoreEvt_t">cmScoreEvt_t</a><span class="p">*</span> <a name="cmScoreEvt"></a><span class="f">cmScoreEvt</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">idx</span> <span class="p">)</span><span class="p">;</span>

<span class="c">// Given a bar number return the associated 'bar' event record.</span>
<span class="k">const</span> <a href="#cmScoreEvt_t">cmScoreEvt_t</a><span class="p">*</span> <a name="cmScoreBarEvt"></a><span class="f">cmScoreBarEvt</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">barNumb</span> <span class="p">)</span><span class="p">;</span>

<span class="c">// Given a csvEventId return the associated event</span>
<span class="k">const</span> <a href="#cmScoreEvt_t">cmScoreEvt_t</a><span class="p">*</span> <a name="cmScoreIdToEvt"></a><span class="f">cmScoreIdToEvt</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">csvEventId</span> <span class="p">)</span><span class="p">;</span>

<span class="c">// Access section records</span>
<span class="k">unsigned</span>      <a name="cmScoreSectionCount"></a><span class="f">cmScoreSectionCount</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span> <span class="p">)</span><span class="p">;</span>
<a href="#cmScoreSection_t">cmScoreSection_t</a><span class="p">*</span> <a name="cmScoreSection"></a><span class="f">cmScoreSection</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">idx</span> <span class="p">)</span><span class="p">;</span>

<span class="c">// Access the score location data</span>
<span class="k">unsigned</span>      <a name="cmScoreLocCount"></a><span class="f">cmScoreLocCount</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span> <span class="p">)</span><span class="p">;</span>
<a href="#cmScoreLoc_t">cmScoreLoc_t</a><span class="p">*</span> <a name="cmScoreLoc"></a><span class="f">cmScoreLoc</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">idx</span> <span class="p">)</span><span class="p">;</span>
<span class="k">void</span>          <a name="cmScorePrintLoc"></a><span class="f">cmScorePrintLoc</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span> <span class="p">)</span><span class="p">;</span>

<span class="c">// Return the location associated with a given score event.</span>
<a href="#cmScoreLoc_t">cmScoreLoc_t</a><span class="p">*</span> <a name="cmScoreEvtLoc"></a><span class="f">cmScoreEvtLoc</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span><span class="p">,</span> <span class="k">const</span> <a href="#cmScoreEvt_t">cmScoreEvt_t</a><span class="p">*</span> <span class="i">evt</span> <span class="p">)</span><span class="p">;</span>

<span class="c">// Return the count of sets.</span>
<span class="k">unsigned</span>      <a name="cmScoreSetCount"></a><span class="f">cmScoreSetCount</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span> <span class="p">)</span><span class="p">;</span>

<span class="k">unsigned</span>      <a name="cmScoreMarkerLabelCount"></a><span class="f">cmScoreMarkerLabelCount</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span> <span class="p">)</span><span class="p">;</span>
<span class="k">unsigned</span>      <a name="cmScoreMarkerLabelSymbolId"></a><span class="f">cmScoreMarkerLabelSymbolId</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">idx</span> <span class="p">)</span><span class="p">;</span>
<span class="k">const</span> <a href="#cmScoreMarker_t">cmScoreMarker_t</a><span class="p">*</span> <a name="cmScoreMarker"></a><span class="f">cmScoreMarker</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span><span class="p">,</span> <a href="#cmMarkScMId_t">cmMarkScMId_t</a> <span class="i">markMId</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">labelSymId</span> <span class="p">)</span><span class="p">;</span>

<span class="c">// Make callbacks for all events in the score. The callbacks
// contain <a href="#cmScMsg_t">cmScMsg_t</a> records serialized as a byte stream.
// Use <a href="#cmScoreDecode">cmScoreDecode</a>() to convert the byte string to a
// <a href="#cmScMsg_t">cmScMsg_t</a> record.</span>
<a href="#cmScRC_t">cmScRC_t</a>      <a name="cmScoreSeqNotify"></a><span class="f">cmScoreSeqNotify</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span> <span class="p">)</span><span class="p">;</span>
<a href="#cmScRC_t">cmScRC_t</a>      <a name="cmScoreSeqNotifyCb"></a><span class="f">cmScoreSeqNotifyCb</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span><span class="p">,</span> <a href="#cmScCb_t">cmScCb_t</a> <span class="i">cbFunc</span><span class="p">,</span> <span class="k">void</span><span class="p">*</span> <span class="i">cbArg</span> <span class="p">)</span><span class="p">;</span>

<span class="k">void</span>          <a name="cmScoreClearPerfInfo"></a><span class="f">cmScoreClearPerfInfo</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span> <span class="p">)</span><span class="p">;</span>

<span class="c">// Assign 'smpIdx' and 'vel'  to the event matching 'pitch' at 'locIdx'
// but do not trigger any variable calculations. Return true if as a
// result of this call all events assigned to 'locIdx' have been received
// otherwise return false.</span>
<span class="k">bool</span>          <a name="cmScoreSetPerfEvent"></a><span class="f">cmScoreSetPerfEvent</span><span class="p">(</span>  <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">locIdx</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">smpIdx</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">pitch</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">vel</span> <span class="p">)</span><span class="p">;</span>

<span class="c">// Assign 'smpIdx' and 'vel'  to the event matching 'pitch' at 'locIdx'
// but and trigger any variable calculations which may happen on, or before, 'locIdx'.</span>
<span class="k">void</span>          <a name="cmScoreExecPerfEvent"></a><span class="f">cmScoreExecPerfEvent</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">locIdx</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">smpIdx</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">pitch</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">vel</span> <span class="p">)</span><span class="p">;</span>

<span class="c">// Assign 'value' to the section at, or before, 'locIdx'.</span>
<span class="k">void</span>          <a name="cmScoreSetPerfValue"></a><span class="f">cmScoreSetPerfValue</span><span class="p">(</span>  <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">locIdx</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">varId</span><span class="p">,</span> <span class="k">double</span> <span class="i">value</span> <span class="p">)</span><span class="p">;</span>

<span class="c">// Set the performed dynamic level of a score event.</span>
<span class="k">void</span>          <a name="cmScoreSetPerfDynLevel"></a><span class="f">cmScoreSetPerfDynLevel</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">evtIdx</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">dynLvl</span> <span class="p">)</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">enum</span>
<span class="p">{</span>
  <a name="kInvalidMsgScId"></a><span class="e">kInvalidMsgScId</span><span class="p">,</span>
  <a name="kBeginMsgScId"></a><span class="e">kBeginMsgScId</span><span class="p">,</span>
  <a name="kEventMsgScId"></a><span class="e">kEventMsgScId</span><span class="p">,</span>
  <a name="kSectionMsgScId"></a><span class="e">kSectionMsgScId</span><span class="p">,</span>
  <a name="kEndMsgScId"></a><span class="e">kEndMsgScId</span><span class="p">,</span>
  <a name="kVarMsgScId"></a><span class="e">kVarMsgScId</span><span class="p">,</span>
  <a name="kDynMsgScId"></a><span class="e">kDynMsgScId</span>
<span class="p">}</span> <a name="cmScMsgTypeId_t"></a><span class="t">cmScMsgTypeId_t</span><span class="p">;</span>

<a name="cmScMeas_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <span class="k">unsigned</span> <a name="cmScMeas_t.varId"></a><span class="i">varId</span><span class="p">;</span>  <span class="c"> // see kXXXVarScId from cmScoreSet_t.varId</span>
  <span class="k">double</span>   <a name="cmScMeas_t.value"></a><span class="i">value</span><span class="p">;</span>   <span class="c"> // value of a variable</span>
<span class="p">}</span> <span class="t"><a href="#cmScMeas_t">cmScMeas_t</a></span><span class="p">;</span>

<a name="cmScDyn_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <span class="k">unsigned</span> <a name="cmScDyn_t.evtIdx"></a><span class="i">evtIdx</span><span class="p">;</span>
  <span class="k">unsigned</span> <a name="cmScDyn_t.dynLvl"></a><span class="i">dynLvl</span><span class="p">;</span>
<span class="p">}</span> <span class="t"><a href="#cmScDyn_t">cmScDyn_t</a></span><span class="p">;</span>

<a name="cmScMsg_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <a href="#cmScMsgTypeId_t">cmScMsgTypeId_t</a> <a name="cmScMsg_t.typeId"></a><span class="i">typeId</span><span class="p">;</span>
  <a name="u"></a><span class="k">union</span>
  <span class="p">{</span>
    <a href="#cmScoreEvt_t">cmScoreEvt_t</a>     <a name="cmScMsg_t.u.evt"></a><span class="i">evt</span><span class="p">;</span>      <span class="c"> // only used when typeId == <a href="#kEventMsgScId">kEventMsgScId</a></span>
    <a href="#cmScMeas_t">cmScMeas_t</a>       <a name="cmScMsg_t.u.meas"></a><span class="i">meas</span><span class="p">;</span>     <span class="c"> // only used when typeId == <a href="#kVarMsgScId">kVarMsgScId</a> </span>
    <a href="#cmScoreSection_t">cmScoreSection_t</a> <a name="cmScMsg_t.u.sect"></a><span class="i">sect</span><span class="p">;</span>     <span class="c"> // only used when typeId == <a href="#kSectionMsgScId">kSectionMsgScId</a></span>
    <a href="#cmScDyn_t">cmScDyn_t</a>        <a name="cmScMsg_t.u.dyn"></a><span class="i">dyn</span><span class="p">;</span>      <span class="c"> // only used when typeId == kDynLvlMsgScId</span>
  <span class="p">}</span> <span class="i">u</span><span class="p">;</span>
<span class="p">}</span> <span class="t"><a href="#cmScMsg_t">cmScMsg_t</a></span><span class="p">;</span>

<span class="c">// Decode a serialized <a href="#cmScMsg_t">cmScMsg_t</a> from a byte stream as passed to the 
// <a href="#cmScCb_t">cmScCb_t</a> function.</span>
<a href="#cmScRC_t">cmScRC_t</a>      <a name="cmScoreDecode"></a><span class="f">cmScoreDecode</span><span class="p">(</span> <span class="k">const</span> <span class="k">void</span><span class="p">*</span> <span class="i">msg</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">msgByteCnt</span><span class="p">,</span> <a href="#cmScMsg_t">cmScMsg_t</a><span class="i">*</span> <span class="p">)</span><span class="p">;</span>

<span class="k">void</span>          <a name="cmScorePrint"></a><span class="f">cmScorePrint</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span><span class="p">,</span> <a href="cmRpt_h_0.html#cmRpt_t">cmRpt_t</a><span class="p">*</span> <span class="i">rpt</span> <span class="p">)</span><span class="p">;</span>
<span class="k">void</span>          <a name="cmScorePrintSets"></a><span class="f">cmScorePrintSets</span><span class="p">(</span> <a href="#cmScH_t">cmScH_t</a> <span class="i">h</span><span class="p">,</span> <a href="cmRpt_h_0.html#cmRpt_t">cmRpt_t</a><span class="p">*</span> <span class="i">rpt</span> <span class="p">)</span><span class="p">;</span>

<span class="c">// Generate a new score file from a MIDI file.</span>
<a href="#cmScRC_t">cmScRC_t</a>      <a name="cmScoreFileFromMidi"></a><span class="f">cmScoreFileFromMidi</span><span class="p">(</span> <a href="cmCtx_h_0.html#cmCtx_t">cmCtx_t</a><span class="p">*</span> <span class="i">ctx</span><span class="p">,</span> <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> <span class="i">midiFn</span><span class="p">,</span> <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> <span class="i">scoreFn</span> <span class="p">)</span><span class="p">;</span>

<span class="c">// <a href="cmVectOpsDocOut_h_0.html#Print">Print</a> open the score file 'fn' and report the contents.  This function
// simply wraps calls to <a href="#cmScoreInitialize">cmScoreInitialize</a>() and <a href="#cmScorePrint">cmScorePrint</a>().</span>
<span class="k">void</span>          <a name="cmScoreReport"></a><span class="f">cmScoreReport</span><span class="p">(</span> <a href="cmCtx_h_0.html#cmCtx_t">cmCtx_t</a><span class="p">*</span> <span class="i">ctx</span><span class="p">,</span> <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> <span class="i">fn</span><span class="p">,</span> <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> <span class="i">outFn</span> <span class="p">)</span><span class="p">;</span>

<span class="k">void</span>          <a name="cmScoreTest"></a><span class="f">cmScoreTest</span><span class="p">(</span> <a href="cmCtx_h_0.html#cmCtx_t">cmCtx_t</a><span class="p">*</span> <span class="i">ctx</span><span class="p">,</span> <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> <span class="i">fn</span> <span class="p">)</span><span class="p">;</span>
</pre>
</div>
<!-- End nodes -->
</div>
</body>
</html>
