<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>cmDspKr.c</title>
    <link href="cdg_code.css"    rel="stylesheet" type="text/css" media="screen" />
  </head>
  <body>
    <div class="highlight">

      <div class="license">
	<p>
	  Copyright (C) Kevin Larke 2009-2020
	</p>

	<p>
	  This file is part of libcm.
	</p>

	<p>
	  libcm is free software: you can redistribute it and/or modify it under
	  the terms of the GNU General Public License as published by the Free
	  Software Foundation, either version 3 of the License, or (at your
	  option) any later version.
	</p>

	<p>
	  libcm is distributed in the hope that it will be useful, but WITHOUT
	  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
	  FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
	  for more details.
	</p>

	<p>
	  See the GNU General Public License distributed with the libcm
	  package or look here: <https://www.gnu.org/licenses/>.
	</p>


      </div>

      <hr>
<a name="cmDspKr.c"></a><!-- Begin nodes -->
<div class="cod"><div class="blk_title">cmDspKr : 'snap' audio effects performance analysis units.</div><pre><a name="cmDspKr_c_code_0"></a>
<span class="m">#include &quot<a href="cmTime_h_0.html#cmTime.h">cmTime.h</a>&quot</span>
<span class="m">#include &quot<a href="cmAudioSys_h_0.html#cmAudioSys.h">cmAudioSys.h</a>&quot</span>
<span class="m">#include &quot<a href="cmDspCtx_h_0.html#cmDspCtx.h">cmDspCtx.h</a>&quot</span>
<span class="m">#include &quot<a href="cmDspClass_h_0.html#cmDspClass.h">cmDspClass.h</a>&quot</span>
<span class="m">#include &quot<a href="cmDspStore_h_0.html#cmDspStore.h">cmDspStore.h</a>&quot</span>
<span class="m">#include &quot<a href="cmDspUi_h_0.html#cmDspUi.h">cmDspUi.h</a>&quot</span>
<span class="m">#include &quot<a href="cmDspSys_h_0.html#cmDspSys.h">cmDspSys.h</a>&quot</span>
<span class="m">#include &quot<a href="cmMath_h_0.html#cmMath.h">cmMath.h</a>&quot</span>

<span class="m">#include &quot<a href="cmAudioFile_h_0.html#cmAudioFile.h">cmAudioFile.h</a>&quot</span>
<span class="m">#include &quot<a href="cmFileSys_h_0.html#cmFileSys.h">cmFileSys.h</a>&quot</span>
<span class="m">#include &quot<a href="cmProcObj_h_0.html#cmProcObj.h">cmProcObj.h</a>&quot</span>
<span class="m">#include &quotcmProcTemplateMain.h&quot</span>
<span class="m">#include &quot<a href="cmProc_h_0.html#cmProc.h">cmProc.h</a>&quot</span>
<span class="m">#include &quot<a href="cmMidi_h_0.html#cmMidi.h">cmMidi.h</a>&quot</span>
<span class="m">#include &quot<a href="cmProc2_h_0.html#cmProc2.h">cmProc2.h</a>&quot</span>
<span class="m">#include &quotcmVectOpsTemplateMain.h&quot</span>

<span class="m">#include &quot<a href="cmAudioFile_h_0.html#cmAudioFile.h">cmAudioFile.h</a>&quot</span>
<span class="m">#include &quot<a href="cmMidiFile_h_0.html#cmMidiFile.h">cmMidiFile.h</a>&quot</span>
<span class="m">#include &quot<a href="cmTimeLine_h_0.html#cmTimeLine.h">cmTimeLine.h</a>&quot</span>
<span class="m">#include &quot<a href="cmScore_h_0.html#cmScore.h">cmScore.h</a>&quot</span>
<span class="m">#include &quot<a href="cmProc4_h_0.html#cmProc4.h">cmProc4.h</a>&quot</span>
<span class="m">#include &quot<a href="cmProc5_h_0.html#cmProc5.h">cmProc5.h</a>&quot</span>
<span class="m">#include &quot<a href="cmSyncRecd_h_0.html#cmSyncRecd.h">cmSyncRecd.h</a>&quot</span>
<span class="m">#include &quot<a href="cmTakeSeqBldr_h_0.html#cmTakeSeqBldr.h">cmTakeSeqBldr.h</a>&quot</span>

<span class="c"><hr id="hr1"></span></pre>
</div>
<div class="cod"><div class="blk_title">cmDspKr : Spectral non-linear distortion effect.</div><pre><a name="cmDspKr"></a>
<span class="k">enum</span>
<span class="p">{</span>
  <a name="kWndSmpCntKrId"></a><span class="e">kWndSmpCntKrId</span><span class="p">,</span>
  <a name="kHopFactKrId"></a><span class="e">kHopFactKrId</span><span class="p">,</span>
  <a name="kModeKrId"></a><span class="e">kModeKrId</span><span class="p">,</span>
  <a name="kThreshKrId"></a><span class="e">kThreshKrId</span><span class="p">,</span>
  <a name="kLwrSlopeKrId"></a><span class="e">kLwrSlopeKrId</span><span class="p">,</span>
  <a name="kUprSlopeKrId"></a><span class="e">kUprSlopeKrId</span><span class="p">,</span>
  <a name="kOffsetKrId"></a><span class="e">kOffsetKrId</span><span class="p">,</span>
  <a name="kInvertKrId"></a><span class="e">kInvertKrId</span><span class="p">,</span>
  <a name="kBypassKrId"></a><span class="e">kBypassKrId</span><span class="p">,</span>
  <a name="kWetKrId"></a><span class="e">kWetKrId</span><span class="p">,</span>
  <a name="kAudioInKrId"></a><span class="e">kAudioInKrId</span><span class="p">,</span>
  <a name="kAudioOutKrId"></a><span class="e">kAudioOutKrId</span>
<span class="p">}</span><span class="p">;</span>

<a name="cmDspKr_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a>   <a name="cmDspKr_t.inst"></a><span class="i">inst</span><span class="p">;</span>
  <a href="cmProcObj_h_0.html#cmCtx">cmCtx</a><span class="p">*</span>        <a name="cmDspKr_t.ctx"></a><span class="i">ctx</span><span class="p">;</span>
  <a href="cmProc2_h_0.html#cmSpecDist_t">cmSpecDist_t</a><span class="p">*</span> <a name="cmDspKr_t.sdp"></a><span class="i">sdp</span><span class="p">;</span>
<span class="p">}</span> <span class="t"><a href="#cmDspKr_t">cmDspKr_t</a></span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a> _cmKrDC<span class="p">;</span>


<a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span>  <a name="_cmDspKrAlloc_defn"></a><a name="_cmDspKrAlloc"></a><span class="f">_cmDspKrAlloc</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> classPtr<span class="p">,</span> <span class="k">unsigned</span> storeSymId<span class="p">,</span> <span class="k">unsigned</span> instSymId<span class="p">,</span> <span class="k">unsigned</span> id<span class="p">,</span> <span class="k">unsigned</span> va_cnt<span class="p">,</span> va_list vl <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspVarArg_t">cmDspVarArg_t</a> args<span class="p">[</span><span class="p">]</span> <span class="p">=</span>
  <span class="p">{</span>
    <span class="p">{</span> <span class="l">&quotwndn&quot</span><span class="p">,</span>    <a href="#kWndSmpCntKrId">kWndSmpCntKrId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kReqArgDsvFl">kReqArgDsvFl</a><span class="p">,</span>   <span class="l">&quotWindow sample count&quot</span>   <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quothopf&quot</span><span class="p">,</span>    <a href="#kHopFactKrId">kHopFactKrId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span>   <span class="l">&quotHop factor&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotmode&quot</span><span class="p">,</span>    <a href="#kModeKrId">kModeKrId</a><span class="p">,</span>        <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span>   <span class="l">&quotMode 0=bypass 1=basic 2=spec cnt 3=amp env&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotthrh&quot</span><span class="p">,</span>    <a href="#kThreshKrId">kThreshKrId</a><span class="p">,</span>      <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span>   <span class="l">&quotThreshold&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotlwrs&quot</span><span class="p">,</span>    <a href="#kLwrSlopeKrId">kLwrSlopeKrId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span>   <span class="l">&quotLower Slope&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotuprs&quot</span><span class="p">,</span>    <a href="#kUprSlopeKrId">kUprSlopeKrId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span>   <span class="l">&quotUpper Slope&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotoffs&quot</span><span class="p">,</span>    <a href="#kOffsetKrId">kOffsetKrId</a><span class="p">,</span>      <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span>   <span class="l">&quotOffset&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotinvt&quot</span><span class="p">,</span>    <a href="#kInvertKrId">kInvertKrId</a><span class="p">,</span>      <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span>   <span class="l">&quotInvert&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotbypass&quot</span><span class="p">,</span>  <a href="#kBypassKrId">kBypassKrId</a><span class="p">,</span>      <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kBoolDsvFl">kBoolDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span>   <span class="l">&quotBypass enable flag.&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotwet&quot</span><span class="p">,</span>     <a href="#kWetKrId">kWetKrId</a><span class="p">,</span>         <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kSampleDsvFl">kSampleDsvFl</a><span class="p">,</span>                  <span class="l">&quotWet mix level.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotin&quot</span><span class="p">,</span>      <a href="#kAudioInKrId">kAudioInKrId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kAudioBufDsvFl">kAudioBufDsvFl</a><span class="p">,</span> <span class="l">&quotAudio Input&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotout&quot</span><span class="p">,</span>     <a href="#kAudioOutKrId">kAudioOutKrId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span> <span class="l">1</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kAudioBufDsvFl">kAudioBufDsvFl</a><span class="p">,</span> <span class="l">&quotAudio Output&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> NULL<span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span> <span class="p">}</span>
  <span class="p">}</span><span class="p">;</span>
  
  <a href="#cmDspKr_t">cmDspKr_t</a><span class="p">*</span> p            <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstAlloc">cmDspInstAlloc</a><span class="p">(</span><a href="#cmDspKr_t">cmDspKr_t</a><span class="p">,</span>ctx<span class="p">,</span>classPtr<span class="p">,</span>args<span class="p">,</span>instSymId<span class="p">,</span>id<span class="p">,</span>storeSymId<span class="p">,</span>va_cnt<span class="p">,</span>vl<span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>   defWndSmpCnt <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDefaultUInt">cmDspDefaultUInt</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kWndSmpCntKrId">kWndSmpCntKrId</a><span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>   wndSmpCnt    <span class="p">=</span> <a href="cmMath_h_0.html#cmNextPowerOfTwo">cmNextPowerOfTwo</a><span class="p">(</span> defWndSmpCnt <span class="p">)</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>   ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kWndSmpCntKrId">kWndSmpCntKrId</a><span class="p">,</span> defWndSmpCnt<span class="p">,</span> wndSmpCnt <span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>   ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kHopFactKrId">kHopFactKrId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span> <span class="l">4</span> <span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>   ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kModeKrId">kModeKrId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <a href="cmProc2_h_0.html#kBasicModeSdId">kBasicModeSdId</a> <span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span> ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kThreshKrId">kThreshKrId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span> <span class="l">60.0</span> <span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span> ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kLwrSlopeKrId">kLwrSlopeKrId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">2.0</span> <span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span> ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kUprSlopeKrId">kUprSlopeKrId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0.0</span> <span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span> ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kOffsetKrId">kOffsetKrId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span> <span class="l">30.0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>   ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kInvertKrId">kInvertKrId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span> <span class="l">0</span> <span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>   ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kBypassKrId">kBypassKrId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span> <span class="l">0</span> <span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultSample">cmDspSetDefaultSample</a><span class="p">(</span> ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kWetKrId">kWetKrId</a><span class="p">,</span>      <span class="l">0</span><span class="p">,</span> <span class="l">1.0</span><span class="p">)</span><span class="p">;</span>
  
  <span class="c">//_cmDspKrCmInit(ctx,p); // initialize the cm library</span>
  
  p<span class="p">-</span><span class="p">&gt</span>ctx <span class="p">=</span> <a href="cmProcObj_h_0.html#cmCtxAlloc">cmCtxAlloc</a><span class="p">(</span>NULL<span class="p">,</span>ctx<span class="p">-</span><span class="p">&gt</span>rpt<span class="p">,</span>ctx<span class="p">-</span><span class="p">&gt</span>lhH<span class="p">,</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspKrFree_defn"></a><a name="_cmDspKrFree"></a><span class="f">_cmDspKrFree</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspKr_t">cmDspKr_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspKr_t">cmDspKr_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <a href="cmProc2_h_0.html#cmSpecDistFree">cmSpecDistFree</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">)</span><span class="p">;</span>
  
  <a href="cmProcObj_h_0.html#cmCtxFree">cmCtxFree</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>ctx<span class="p">)</span><span class="p">;</span>
  <span class="c">//_cmDspKrCmFinal(ctx,p);  // finalize the cm library</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>


<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspKrSetup_defn"></a><a name="_cmDspKrSetup"></a><span class="f">_cmDspKrSetup</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="#cmDspKr_t">cmDspKr_t</a><span class="p">*</span> p <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> rc           <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <span class="k">unsigned</span>  wndSmpCnt    <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kWndSmpCntKrId">kWndSmpCntKrId</a><span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>  hopFact      <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kHopFactKrId">kHopFactKrId</a><span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>  olaWndTypeId <span class="p">=</span><a href="cmProc_h_0.html#kHannWndId">kHannWndId</a><span class="p">;</span>
  
  <a href="cmProc2_h_0.html#cmSpecDistFree">cmSpecDistFree</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">)</span><span class="p">;</span>
  
  p<span class="p">-</span><span class="p">&gt</span>sdp <span class="p">=</span> <a href="cmProc2_h_0.html#cmSpecDistAlloc">cmSpecDistAlloc</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>ctx<span class="p">,</span> NULL<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspSamplesPerCycle">cmDspSamplesPerCycle</a><span class="p">(</span>ctx<span class="p">)</span><span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspSampleRate">cmDspSampleRate</a><span class="p">(</span>ctx<span class="p">)</span><span class="p">,</span> wndSmpCnt<span class="p">,</span> hopFact<span class="p">,</span> olaWndTypeId<span class="p">)</span><span class="p">;</span>
  
  assert<span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>sdp <span class="p">!</span><span class="p">=</span> NULL <span class="p">)</span><span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span><span class="p">(</span>rc <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspZeroAudioBuf">cmDspZeroAudioBuf</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kAudioOutKrId">kAudioOutKrId</a><span class="p">)</span><span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a> <span class="p">)</span>
    <span class="k">return</span> rc<span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>


<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspKrReset_defn"></a><a name="_cmDspKrReset"></a><span class="f">_cmDspKrReset</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspKr_t">cmDspKr_t</a><span class="p">*</span>   p  <span class="p">=</span> <span class="p">(</span><a href="#cmDspKr_t">cmDspKr_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>    rc<span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span><span class="p">(</span>rc <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspApplyAllDefaults">cmDspApplyAllDefaults</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a> <span class="p">)</span>
    <span class="k">return</span> rc<span class="p">;</span>
  
  <span class="k">return</span> <a href="#_cmDspKrSetup">_cmDspKrSetup</a><span class="p">(</span>ctx<span class="p">,</span>p<span class="p">)</span><span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspKrExec_defn"></a><a name="_cmDspKrExec"></a><span class="f">_cmDspKrExec</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspKr_t">cmDspKr_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspKr_t">cmDspKr_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  
  <span class="k">unsigned</span>          iChIdx  <span class="p">=</span> <span class="l">0</span><span class="p">;</span>
  <span class="k">const</span> <a href="cmFloatTypes_h_0.html#cmSample_t">cmSample_t</a><span class="p">*</span> ip      <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBuf">cmDspAudioBuf</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kAudioInKrId">kAudioInKrId</a><span class="p">,</span>iChIdx<span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>          iSmpCnt <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspVarRows">cmDspVarRows</a><span class="p">(</span>inst<span class="p">,</span><a href="#kAudioInKrId">kAudioInKrId</a><span class="p">)</span><span class="p">;</span>
  
  <span class="c">// if no connected</span>
  <span class="k">if</span><span class="p">(</span> iSmpCnt <span class="p">=</span><span class="p">=</span> <span class="l">0</span> <span class="p">)</span>
    <span class="k">return</span> rc<span class="p">;</span>
  
  <span class="k">unsigned</span>          oChIdx  <span class="p">=</span> <span class="l">0</span><span class="p">;</span>
  <a href="cmFloatTypes_h_0.html#cmSample_t">cmSample_t</a><span class="p">*</span>       op      <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBuf">cmDspAudioBuf</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kAudioOutKrId">kAudioOutKrId</a><span class="p">,</span>oChIdx<span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>          oSmpCnt <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspVarRows">cmDspVarRows</a><span class="p">(</span>inst<span class="p">,</span><a href="#kAudioOutKrId">kAudioOutKrId</a><span class="p">)</span><span class="p">;</span>
  <span class="k">const</span> <a href="cmFloatTypes_h_0.html#cmSample_t">cmSample_t</a><span class="p">*</span> sp<span class="p">;</span>
  
  <a href="cmFloatTypes_h_0.html#cmSample_t">cmSample_t</a> wet <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspSample">cmDspSample</a><span class="p">(</span>inst<span class="p">,</span><a href="#kWetKrId">kWetKrId</a><span class="p">)</span><span class="p">;</span>
  
  <a href="cmProc2_h_0.html#cmSpecDistExec">cmSpecDistExec</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">,</span>ip<span class="p">,</span>iSmpCnt<span class="p">)</span><span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span><span class="p">(</span>sp <span class="p">=</span> <a href="cmProc2_h_0.html#cmSpecDistOut">cmSpecDistOut</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">)</span><span class="p">)</span> <span class="p">!</span><span class="p">=</span> NULL <span class="p">)</span>
  <span class="p">{</span>
    cmVOS_MultVVS<span class="p">(</span>op<span class="p">,</span>oSmpCnt<span class="p">,</span>sp<span class="p">,</span>wet<span class="p">)</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="k">if</span><span class="p">(</span> wet<span class="p">&lt</span><span class="l">1.0</span> <span class="p">)</span>
    cmVOS_MultSumVVS<span class="p">(</span>op<span class="p">,</span>oSmpCnt<span class="p">,</span>ip<span class="p">,</span><span class="l">1.0</span><span class="p">-</span>wet<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspKrRecv_defn"></a><a name="_cmDspKrRecv"></a><span class="f">_cmDspKrRecv</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspKr_t">cmDspKr_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspKr_t">cmDspKr_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  
  
  <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
  
  <span class="k">switch</span><span class="p">(</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">)</span>
  <span class="p">{</span>
  <span class="k">case</span> <a href="#kWndSmpCntKrId">kWndSmpCntKrId</a><span class="p">:</span>
  <span class="k">case</span> <a href="#kHopFactKrId">kHopFactKrId</a><span class="p">:</span>
    <a href="#_cmDspKrSetup">_cmDspKrSetup</a><span class="p">(</span>ctx<span class="p">,</span>p<span class="p">)</span><span class="p">;</span>
    
    <span class="c">// THIS IS A HACK
    // WHEN WND OR HOP CHANGE THE RESULTING CHANGES
    // SHOULD BE ISOLATED IN <a href="cmProc2_h_0.html#cmSpecDist">cmSpecDist</a>() AND THE
    // CURRENT STATE OF THE PARAMETERS SHOULD NOT BE
    // LOST - IF THE CHANGES WERE ISOLATED WITHIN PVANL 
    // AND PVSYN IT MIGHT BE POSSIBLE TO DO WITH 
    // MINIMAL AUDIO INTERUPTION.</span>    
    
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>mode <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kModeKrId">kModeKrId</a><span class="p">)</span><span class="p">;</span>
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>thresh   <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kThreshKrId">kThreshKrId</a><span class="p">)</span><span class="p">;</span>   
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>uprSlope <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kUprSlopeKrId">kUprSlopeKrId</a><span class="p">)</span><span class="p">;</span> 
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>lwrSlope <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kLwrSlopeKrId">kLwrSlopeKrId</a><span class="p">)</span><span class="p">;</span> 
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>offset   <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kOffsetKrId">kOffsetKrId</a><span class="p">)</span><span class="p">;</span>   
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>invertFl <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kInvertKrId">kInvertKrId</a><span class="p">)</span><span class="p">!</span><span class="p">=</span><span class="l">0</span><span class="p">;</span>  
    
    printf<span class="p">(</span><span class="l">&quotwsn:%i hsn:%i\n&quot</span><span class="p">,</span>p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>wndSmpCnt<span class="p">,</span>p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>hopSmpCnt<span class="p">)</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kModeKrId">kModeKrId</a><span class="p">:</span>
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>mode <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kModeKrId">kModeKrId</a><span class="p">)</span><span class="p">;</span>
    printf<span class="p">(</span><span class="l">&quotmode:%i\n&quot</span><span class="p">,</span>p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>mode<span class="p">)</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kThreshKrId">kThreshKrId</a><span class="p">:</span>     
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>thresh   <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kThreshKrId">kThreshKrId</a><span class="p">)</span><span class="p">;</span>   
    <span class="c">//printf(&ampquotthr:p:%p sdp:%p %f\n&ampquot,p,p-&ampgtsdp,p-&ampgtsdp-&ampgtthresh);</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kUprSlopeKrId">kUprSlopeKrId</a><span class="p">:</span>   
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>uprSlope <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kUprSlopeKrId">kUprSlopeKrId</a><span class="p">)</span><span class="p">;</span> 
    <span class="c">//printf(&ampquotupr slope:%f\n&ampquot,p-&ampgtsdp-&ampgtuprSlope);</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kLwrSlopeKrId">kLwrSlopeKrId</a><span class="p">:</span>   
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>lwrSlope <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kLwrSlopeKrId">kLwrSlopeKrId</a><span class="p">)</span><span class="p">;</span> 
    <span class="c">//printf(&ampquotupr slope:%f\n&ampquot,p-&ampgtsdp-&ampgtlwrSlope);</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kOffsetKrId">kOffsetKrId</a><span class="p">:</span>     
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>offset   <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kOffsetKrId">kOffsetKrId</a><span class="p">)</span><span class="p">;</span>   
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kInvertKrId">kInvertKrId</a><span class="p">:</span>     
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>invertFl <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kInvertKrId">kInvertKrId</a><span class="p">)</span><span class="p">!</span><span class="p">=</span><span class="l">0</span><span class="p">;</span>  
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kWetKrId">kWetKrId</a><span class="p">:</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">default</span><span class="p">:</span>
    <span class="p">{</span> assert<span class="p">(</span><span class="l">0</span><span class="p">)</span><span class="p">;</span> <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> <a name="cmKrClassCons_defn"></a><span class="f"><a href="cmDspKr_h_0.html#cmKrClassCons">cmKrClassCons</a></span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspClassSetup">cmDspClassSetup</a><span class="p">(</span><span class="p">&amp</span>_cmKrDC<span class="p">,</span>ctx<span class="p">,</span><span class="l">&quotKr&quot</span><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspKrAlloc">_cmDspKrAlloc</a><span class="p">,</span>
  <a href="#_cmDspKrFree">_cmDspKrFree</a><span class="p">,</span>
  <a href="#_cmDspKrReset">_cmDspKrReset</a><span class="p">,</span>
  <a href="#_cmDspKrExec">_cmDspKrExec</a><span class="p">,</span>
  <a href="#_cmDspKrRecv">_cmDspKrRecv</a><span class="p">,</span>
  NULL<span class="p">,</span>NULL<span class="p">,</span>
  <span class="l">&quotFourier based non-linear transformer.&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>_cmKrDC<span class="p">;</span>
<span class="p">}</span>

<span class="c"><hr id="hr1"></span></pre>
</div>
<div class="cod"><div class="blk_title">cmDspKr2 : Spectral non-linear distortion effect.</div><pre><a name="cmDspKr2"></a>
<span class="k">enum</span>
<span class="p">{</span>
  <a name="kWndSmpCntKr2Id"></a><span class="e">kWndSmpCntKr2Id</span><span class="p">,</span>
  <a name="kHopFactKr2Id"></a><span class="e">kHopFactKr2Id</span><span class="p">,</span>
  
  <a name="kCeilKr2Id"></a><span class="e">kCeilKr2Id</span><span class="p">,</span>
  <a name="kExpoKr2Id"></a><span class="e">kExpoKr2Id</span><span class="p">,</span>
  
  <a name="kThreshKr2Id"></a><span class="e">kThreshKr2Id</span><span class="p">,</span>
  <a name="kLwrSlopeKr2Id"></a><span class="e">kLwrSlopeKr2Id</span><span class="p">,</span>
  <a name="kUprSlopeKr2Id"></a><span class="e">kUprSlopeKr2Id</span><span class="p">,</span>
  
  <a name="kMixKr2Id"></a><span class="e">kMixKr2Id</span><span class="p">,</span>
  
  <a name="kWetKr2Id"></a><span class="e">kWetKr2Id</span><span class="p">,</span>
  <a name="kIgainKr2Id"></a><span class="e">kIgainKr2Id</span><span class="p">,</span>
  
  <a name="kAudioInKr2Id"></a><span class="e">kAudioInKr2Id</span><span class="p">,</span>
  <a name="kAudioOutKr2Id"></a><span class="e">kAudioOutKr2Id</span>
<span class="p">}</span><span class="p">;</span>

<a name="cmDspKr2_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a>   <a name="cmDspKr2_t.inst"></a><span class="i">inst</span><span class="p">;</span>
  <a href="cmProcObj_h_0.html#cmCtx">cmCtx</a><span class="p">*</span>        <a name="cmDspKr2_t.ctx"></a><span class="i">ctx</span><span class="p">;</span>
  <a href="cmProc2_h_0.html#cmSpecDist2_t">cmSpecDist2_t</a><span class="p">*</span> <a name="cmDspKr2_t.sdp"></a><span class="i">sdp</span><span class="p">;</span>
<span class="p">}</span> <span class="t"><a href="#cmDspKr2_t">cmDspKr2_t</a></span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a> _cmKr2DC<span class="p">;</span>


<a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span>  <a name="_cmDspKr2Alloc_defn"></a><a name="_cmDspKr2Alloc"></a><span class="f">_cmDspKr2Alloc</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> classPtr<span class="p">,</span> <span class="k">unsigned</span> storeSymId<span class="p">,</span> <span class="k">unsigned</span> instSymId<span class="p">,</span> <span class="k">unsigned</span> id<span class="p">,</span> <span class="k">unsigned</span> va_cnt<span class="p">,</span> va_list vl <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspVarArg_t">cmDspVarArg_t</a> args<span class="p">[</span><span class="p">]</span> <span class="p">=</span>
  <span class="p">{</span>
    <span class="p">{</span> <span class="l">&quotwndn&quot</span><span class="p">,</span>    <a href="#kWndSmpCntKr2Id">kWndSmpCntKr2Id</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kReqArgDsvFl">kReqArgDsvFl</a><span class="p">,</span>   <span class="l">&quotWindow sample count&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quothopf&quot</span><span class="p">,</span>    <a href="#kHopFactKr2Id">kHopFactKr2Id</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span>   <span class="l">&quotHop factor&quot</span> <span class="p">}</span><span class="p">,</span>
    
    <span class="p">{</span> <span class="l">&quotceil&quot</span><span class="p">,</span>    <a href="#kCeilKr2Id">kCeilKr2Id</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span>   <span class="l">&quotCeiling&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotexpo&quot</span><span class="p">,</span>    <a href="#kExpoKr2Id">kExpoKr2Id</a><span class="p">,</span>        <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span>   <span class="l">&quotExponent&quot</span> <span class="p">}</span><span class="p">,</span>
    
    <span class="p">{</span> <span class="l">&quotthrh&quot</span><span class="p">,</span>    <a href="#kThreshKr2Id">kThreshKr2Id</a><span class="p">,</span>      <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span>   <span class="l">&quotThreshold&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotlwrs&quot</span><span class="p">,</span>    <a href="#kLwrSlopeKr2Id">kLwrSlopeKr2Id</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span>   <span class="l">&quotLower Slope&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotuprs&quot</span><span class="p">,</span>    <a href="#kUprSlopeKr2Id">kUprSlopeKr2Id</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span>   <span class="l">&quotUpper Slope&quot</span><span class="p">}</span><span class="p">,</span>
    
    <span class="p">{</span> <span class="l">&quotmix&quot</span><span class="p">,</span>     <a href="#kMixKr2Id">kMixKr2Id</a><span class="p">,</span>         <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span>   <span class="l">&quotMix&quot</span><span class="p">}</span><span class="p">,</span>
    
    <span class="p">{</span> <span class="l">&quotwet&quot</span><span class="p">,</span>     <a href="#kWetKr2Id">kWetKr2Id</a><span class="p">,</span>         <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kSampleDsvFl">kSampleDsvFl</a><span class="p">,</span>                  <span class="l">&quotWet mix level.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotigain&quot</span><span class="p">,</span>   <a href="#kIgainKr2Id">kIgainKr2Id</a><span class="p">,</span>       <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span>   <span class="l">&quotInput gain.&quot</span><span class="p">}</span><span class="p">,</span>
    
    <span class="p">{</span> <span class="l">&quotin&quot</span><span class="p">,</span>      <a href="#kAudioInKr2Id">kAudioInKr2Id</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kAudioBufDsvFl">kAudioBufDsvFl</a><span class="p">,</span> <span class="l">&quotAudio Input&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotout&quot</span><span class="p">,</span>     <a href="#kAudioOutKr2Id">kAudioOutKr2Id</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span> <span class="l">1</span><span class="p">,</span>   <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kAudioBufDsvFl">kAudioBufDsvFl</a><span class="p">,</span> <span class="l">&quotAudio Output&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> NULL<span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span> <span class="p">}</span>
  <span class="p">}</span><span class="p">;</span>
  
  <a href="#cmDspKr2_t">cmDspKr2_t</a><span class="p">*</span> p           <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstAlloc">cmDspInstAlloc</a><span class="p">(</span><a href="#cmDspKr2_t">cmDspKr2_t</a><span class="p">,</span>ctx<span class="p">,</span>classPtr<span class="p">,</span>args<span class="p">,</span>instSymId<span class="p">,</span>id<span class="p">,</span>storeSymId<span class="p">,</span>va_cnt<span class="p">,</span>vl<span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>   defWndSmpCnt <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDefaultUInt">cmDspDefaultUInt</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kWndSmpCntKr2Id">kWndSmpCntKr2Id</a><span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>   wndSmpCnt    <span class="p">=</span> <a href="cmMath_h_0.html#cmNextPowerOfTwo">cmNextPowerOfTwo</a><span class="p">(</span> defWndSmpCnt <span class="p">)</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>   ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kWndSmpCntKr2Id">kWndSmpCntKr2Id</a><span class="p">,</span> defWndSmpCnt<span class="p">,</span> wndSmpCnt <span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>   ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kHopFactKr2Id">kHopFactKr2Id</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span> <span class="l">4</span> <span class="p">)</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span> ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kCeilKr2Id">kCeilKr2Id</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span> <span class="l">20.0</span> <span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span> ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kExpoKr2Id">kExpoKr2Id</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>  <span class="l">2.0</span> <span class="p">)</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span> ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kThreshKr2Id">kThreshKr2Id</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span> <span class="l">60.0</span> <span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span> ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kLwrSlopeKr2Id">kLwrSlopeKr2Id</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">2.0</span> <span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span> ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kUprSlopeKr2Id">kUprSlopeKr2Id</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0.0</span> <span class="p">)</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span> ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kMixKr2Id">kMixKr2Id</a><span class="p">,</span>      <span class="l">0</span><span class="p">,</span> <span class="l">0.0</span> <span class="p">)</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultSample">cmDspSetDefaultSample</a><span class="p">(</span> ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kWetKr2Id">kWetKr2Id</a><span class="p">,</span>      <span class="l">0</span><span class="p">,</span> <span class="l">1.0</span><span class="p">)</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span> ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kIgainKr2Id">kIgainKr2Id</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span> <span class="l">0.0</span> <span class="p">)</span><span class="p">;</span>
  
  
  <span class="c">//_cmDspKr2CmInit(ctx,p); // initialize the cm library</span>
  
  p<span class="p">-</span><span class="p">&gt</span>ctx <span class="p">=</span> <a href="cmProcObj_h_0.html#cmCtxAlloc">cmCtxAlloc</a><span class="p">(</span>NULL<span class="p">,</span>ctx<span class="p">-</span><span class="p">&gt</span>rpt<span class="p">,</span>ctx<span class="p">-</span><span class="p">&gt</span>lhH<span class="p">,</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspKr2Free_defn"></a><a name="_cmDspKr2Free"></a><span class="f">_cmDspKr2Free</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspKr2_t">cmDspKr2_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspKr2_t">cmDspKr2_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <a href="cmProc2_h_0.html#cmSpecDist2Free">cmSpecDist2Free</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">)</span><span class="p">;</span>
  
  <a href="cmProcObj_h_0.html#cmCtxFree">cmCtxFree</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>ctx<span class="p">)</span><span class="p">;</span>
  <span class="c">//_cmDspKr2CmFinal(ctx,p);  // finalize the cm library</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>


<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspKr2Setup_defn"></a><a name="_cmDspKr2Setup"></a><span class="f">_cmDspKr2Setup</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="#cmDspKr2_t">cmDspKr2_t</a><span class="p">*</span> p <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> rc           <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <span class="k">unsigned</span>  wndSmpCnt    <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kWndSmpCntKr2Id">kWndSmpCntKr2Id</a><span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>  hopFact      <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kHopFactKr2Id">kHopFactKr2Id</a><span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>  olaWndTypeId <span class="p">=</span><a href="cmProc_h_0.html#kHannWndId">kHannWndId</a><span class="p">;</span>
  
  <a href="cmProc2_h_0.html#cmSpecDist2Free">cmSpecDist2Free</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">)</span><span class="p">;</span>
  
  p<span class="p">-</span><span class="p">&gt</span>sdp <span class="p">=</span> <a href="cmProc2_h_0.html#cmSpecDist2Alloc">cmSpecDist2Alloc</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>ctx<span class="p">,</span> NULL<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspSamplesPerCycle">cmDspSamplesPerCycle</a><span class="p">(</span>ctx<span class="p">)</span><span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspSampleRate">cmDspSampleRate</a><span class="p">(</span>ctx<span class="p">)</span><span class="p">,</span> wndSmpCnt<span class="p">,</span> hopFact<span class="p">,</span> olaWndTypeId<span class="p">)</span><span class="p">;</span>
  
  assert<span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>sdp <span class="p">!</span><span class="p">=</span> NULL <span class="p">)</span><span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span><span class="p">(</span>rc <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspZeroAudioBuf">cmDspZeroAudioBuf</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kAudioOutKr2Id">kAudioOutKr2Id</a><span class="p">)</span><span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a> <span class="p">)</span>
    <span class="k">return</span> rc<span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>


<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspKr2Reset_defn"></a><a name="_cmDspKr2Reset"></a><span class="f">_cmDspKr2Reset</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspKr2_t">cmDspKr2_t</a><span class="p">*</span>   p  <span class="p">=</span> <span class="p">(</span><a href="#cmDspKr2_t">cmDspKr2_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>    rc<span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span><span class="p">(</span>rc <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspApplyAllDefaults">cmDspApplyAllDefaults</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a> <span class="p">)</span>
    <span class="k">return</span> rc<span class="p">;</span>
  
  <span class="k">return</span> <a href="#_cmDspKr2Setup">_cmDspKr2Setup</a><span class="p">(</span>ctx<span class="p">,</span>p<span class="p">)</span><span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspKr2Exec_defn"></a><a name="_cmDspKr2Exec"></a><span class="f">_cmDspKr2Exec</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspKr2_t">cmDspKr2_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspKr2_t">cmDspKr2_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  
  <span class="k">unsigned</span>          iChIdx  <span class="p">=</span> <span class="l">0</span><span class="p">;</span>
  <span class="k">const</span> <a href="cmFloatTypes_h_0.html#cmSample_t">cmSample_t</a><span class="p">*</span> ip      <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBuf">cmDspAudioBuf</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kAudioInKr2Id">kAudioInKr2Id</a><span class="p">,</span>iChIdx<span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>          iSmpCnt <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspVarRows">cmDspVarRows</a><span class="p">(</span>inst<span class="p">,</span><a href="#kAudioInKr2Id">kAudioInKr2Id</a><span class="p">)</span><span class="p">;</span>
  
  <span class="c">// if no connected</span>
  <span class="k">if</span><span class="p">(</span> iSmpCnt <span class="p">=</span><span class="p">=</span> <span class="l">0</span> <span class="p">)</span>
    <span class="k">return</span> rc<span class="p">;</span>
  
  <span class="k">unsigned</span>          oChIdx  <span class="p">=</span> <span class="l">0</span><span class="p">;</span>
  <a href="cmFloatTypes_h_0.html#cmSample_t">cmSample_t</a><span class="p">*</span>       op      <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBuf">cmDspAudioBuf</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kAudioOutKr2Id">kAudioOutKr2Id</a><span class="p">,</span>oChIdx<span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>          oSmpCnt <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspVarRows">cmDspVarRows</a><span class="p">(</span>inst<span class="p">,</span><a href="#kAudioOutKr2Id">kAudioOutKr2Id</a><span class="p">)</span><span class="p">;</span>
  <span class="k">const</span> <a href="cmFloatTypes_h_0.html#cmSample_t">cmSample_t</a><span class="p">*</span> sp<span class="p">;</span>
  
  <a href="cmFloatTypes_h_0.html#cmSample_t">cmSample_t</a> wet <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspSample">cmDspSample</a><span class="p">(</span>inst<span class="p">,</span><a href="#kWetKr2Id">kWetKr2Id</a><span class="p">)</span><span class="p">;</span>
  
  <a href="cmProc2_h_0.html#cmSpecDist2Exec">cmSpecDist2Exec</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">,</span>ip<span class="p">,</span>iSmpCnt<span class="p">)</span><span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span><span class="p">(</span>sp <span class="p">=</span> <a href="cmProc2_h_0.html#cmSpecDist2Out">cmSpecDist2Out</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">)</span><span class="p">)</span> <span class="p">!</span><span class="p">=</span> NULL <span class="p">)</span>
  <span class="p">{</span>
    cmVOS_MultVVS<span class="p">(</span>op<span class="p">,</span>oSmpCnt<span class="p">,</span>sp<span class="p">,</span>wet<span class="p">)</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="k">if</span><span class="p">(</span> wet<span class="p">&lt</span><span class="l">1.0</span> <span class="p">)</span>
    cmVOS_MultSumVVS<span class="p">(</span>op<span class="p">,</span>oSmpCnt<span class="p">,</span>ip<span class="p">,</span><span class="l">1.0</span><span class="p">-</span>wet<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspKr2Recv_defn"></a><a name="_cmDspKr2Recv"></a><span class="f">_cmDspKr2Recv</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspKr2_t">cmDspKr2_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspKr2_t">cmDspKr2_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  
  
  <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
  
  <span class="k">switch</span><span class="p">(</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">)</span>
  <span class="p">{</span>
  <span class="k">case</span> <a href="#kWndSmpCntKr2Id">kWndSmpCntKr2Id</a><span class="p">:</span>
  <span class="k">case</span> <a href="#kHopFactKr2Id">kHopFactKr2Id</a><span class="p">:</span>
    <a href="#_cmDspKr2Setup">_cmDspKr2Setup</a><span class="p">(</span>ctx<span class="p">,</span>p<span class="p">)</span><span class="p">;</span>
    
    <span class="c">// THIS IS A HACK
    // WHEN WND OR HOP CHANGE THE RESULTING CHANGES
    // SHOULD BE ISOLATED IN <a href="cmProc2_h_0.html#cmSpecDist">cmSpecDist</a>() AND THE
    // CURRENT STATE OF THE PARAMETERS SHOULD NOT BE
    // LOST - IF THE CHANGES WERE ISOLATED WITHIN PVANL 
    // AND PVSYN IT MIGHT BE POSSIBLE TO DO WITH 
    // MINIMAL AUDIO INTERUPTION.</span>    
    
    
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>ceiling   <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kCeilKr2Id">kCeilKr2Id</a><span class="p">)</span><span class="p">;</span>   
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>expo      <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kExpoKr2Id">kExpoKr2Id</a><span class="p">)</span><span class="p">;</span>   
    
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>thresh   <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kThreshKr2Id">kThreshKr2Id</a><span class="p">)</span><span class="p">;</span>   
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>uprSlope <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kUprSlopeKr2Id">kUprSlopeKr2Id</a><span class="p">)</span><span class="p">;</span> 
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>lwrSlope <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kLwrSlopeKr2Id">kLwrSlopeKr2Id</a><span class="p">)</span><span class="p">;</span> 
    
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>mix      <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kMixKr2Id">kMixKr2Id</a><span class="p">)</span><span class="p">;</span>
    
    printf<span class="p">(</span><span class="l">&quotwsn:%i hsn:%i\n&quot</span><span class="p">,</span>p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>wndSmpCnt<span class="p">,</span>p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>hopSmpCnt<span class="p">)</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kCeilKr2Id">kCeilKr2Id</a><span class="p">:</span>     
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>ceiling  <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kCeilKr2Id">kCeilKr2Id</a><span class="p">)</span><span class="p">;</span>   
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kExpoKr2Id">kExpoKr2Id</a><span class="p">:</span>     
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>expo  <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kExpoKr2Id">kExpoKr2Id</a><span class="p">)</span><span class="p">;</span>   
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kThreshKr2Id">kThreshKr2Id</a><span class="p">:</span>     
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>thresh   <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kThreshKr2Id">kThreshKr2Id</a><span class="p">)</span><span class="p">;</span>   
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kUprSlopeKr2Id">kUprSlopeKr2Id</a><span class="p">:</span>   
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>uprSlope <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kUprSlopeKr2Id">kUprSlopeKr2Id</a><span class="p">)</span><span class="p">;</span> 
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kLwrSlopeKr2Id">kLwrSlopeKr2Id</a><span class="p">:</span>   
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>lwrSlope <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kLwrSlopeKr2Id">kLwrSlopeKr2Id</a><span class="p">)</span><span class="p">;</span> 
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kMixKr2Id">kMixKr2Id</a><span class="p">:</span>   
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>mix <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kMixKr2Id">kMixKr2Id</a><span class="p">)</span><span class="p">;</span> 
    <span class="k">break</span><span class="p">;</span>
    
    
  <span class="k">case</span> <a href="#kWetKr2Id">kWetKr2Id</a><span class="p">:</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kIgainKr2Id">kIgainKr2Id</a><span class="p">:</span>
    p<span class="p">-</span><span class="p">&gt</span>sdp<span class="p">-</span><span class="p">&gt</span>igain <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kIgainKr2Id">kIgainKr2Id</a><span class="p">)</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">default</span><span class="p">:</span>
    <span class="p">{</span> assert<span class="p">(</span><span class="l">0</span><span class="p">)</span><span class="p">;</span> <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="c">//<a href="cmProc2_h_0.html#cmSpecDist2Report">cmSpecDist2Report</a>(p-&ampgtsdp);</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> <a name="cmKr2ClassCons_defn"></a><span class="f"><a href="cmDspKr_h_0.html#cmKr2ClassCons">cmKr2ClassCons</a></span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspClassSetup">cmDspClassSetup</a><span class="p">(</span><span class="p">&amp</span>_cmKr2DC<span class="p">,</span>ctx<span class="p">,</span><span class="l">&quotKr2&quot</span><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspKr2Alloc">_cmDspKr2Alloc</a><span class="p">,</span>
  <a href="#_cmDspKr2Free">_cmDspKr2Free</a><span class="p">,</span>
  <a href="#_cmDspKr2Reset">_cmDspKr2Reset</a><span class="p">,</span>
  <a href="#_cmDspKr2Exec">_cmDspKr2Exec</a><span class="p">,</span>
  <a href="#_cmDspKr2Recv">_cmDspKr2Recv</a><span class="p">,</span>
  NULL<span class="p">,</span>NULL<span class="p">,</span>
  <span class="l">&quotFourier based non-linear transformer two.&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>_cmKr2DC<span class="p">;</span>
<span class="p">}</span>


<span class="c"><hr id="hr1"></span></pre>
</div>
<div class="cod"><div class="blk_title">cmDspTimeLine : Time line user interface unit.</div><pre><a name="cmDspTimeLine"></a>
<span class="k">enum</span>
<span class="p">{</span>
  <a name="kTlFileTlId"></a><span class="e">kTlFileTlId</span><span class="p">,</span>
  <a name="kPrefixPathTlId"></a><span class="e">kPrefixPathTlId</span><span class="p">,</span>
  <a name="kSelTlId"></a><span class="e">kSelTlId</span><span class="p">,</span>
  <a name="kMeasTlId"></a><span class="e">kMeasTlId</span><span class="p">,</span>
  <a name="kCursTlId"></a><span class="e">kCursTlId</span><span class="p">,</span>
  <a name="kResetTlId"></a><span class="e">kResetTlId</span><span class="p">,</span>
  <a name="kAudFnTlId"></a><span class="e">kAudFnTlId</span><span class="p">,</span>
  <a name="kAudLblTlId"></a><span class="e">kAudLblTlId</span><span class="p">,</span>
  <a name="kMidiFnTlId"></a><span class="e">kMidiFnTlId</span><span class="p">,</span>
  <a name="kMidiLblTlId"></a><span class="e">kMidiLblTlId</span><span class="p">,</span>
  <a name="kBegAudSmpIdxTlId"></a><span class="e">kBegAudSmpIdxTlId</span><span class="p">,</span>
  <a name="kEndAudSmpIdxTlId"></a><span class="e">kEndAudSmpIdxTlId</span><span class="p">,</span>
  <a name="kBegMidiSmpIdxTlId"></a><span class="e">kBegMidiSmpIdxTlId</span><span class="p">,</span>
  <a name="kEndMidiSmpIdxTlId"></a><span class="e">kEndMidiSmpIdxTlId</span><span class="p">,</span>
<span class="p">}</span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a> _cmTimeLineDC<span class="p">;</span>

<a name="cmDspTimeLine_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a> <a name="cmDspTimeLine_t.inst"></a><span class="i">inst</span><span class="p">;</span>
  <a href="cmTimeLine_h_0.html#cmTlH_t">cmTlH_t</a>     <a name="cmDspTimeLine_t.tlH"></a><span class="i">tlH</span><span class="p">;</span>
  <span class="k">unsigned</span>    <a name="cmDspTimeLine_t.afIdx"></a><span class="i">afIdx</span><span class="p">;</span>
<span class="p">}</span> <span class="t"><a href="#cmDspTimeLine_t">cmDspTimeLine_t</a></span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span>  <a name="_cmDspTimeLineAlloc_defn"></a><a name="_cmDspTimeLineAlloc"></a><span class="f">_cmDspTimeLineAlloc</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> classPtr<span class="p">,</span> <span class="k">unsigned</span> storeSymId<span class="p">,</span> <span class="k">unsigned</span> instSymId<span class="p">,</span> <span class="k">unsigned</span> id<span class="p">,</span> <span class="k">unsigned</span> va_cnt<span class="p">,</span> va_list vl <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspVarArg_t">cmDspVarArg_t</a> args<span class="p">[</span><span class="p">]</span> <span class="p">=</span>
  <span class="p">{</span>
    <span class="p">{</span> <span class="l">&quottlfile&quot</span><span class="p">,</span>  <a href="#kTlFileTlId">kTlFileTlId</a><span class="p">,</span>         <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kStrzDsvFl">kStrzDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kReqArgDsvFl">kReqArgDsvFl</a><span class="p">,</span> <span class="l">&quotTime line file.&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotpath&quot</span><span class="p">,</span>    <a href="#kPrefixPathTlId">kPrefixPathTlId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kStrzDsvFl">kStrzDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kReqArgDsvFl">kReqArgDsvFl</a><span class="p">,</span> <span class="l">&quotTime line data file prefix path&quot</span>    <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotsel&quot</span><span class="p">,</span>     <a href="#kSelTlId">kSelTlId</a><span class="p">,</span>            <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>   <span class="l">&quotSelected marker id.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotmeas&quot</span><span class="p">,</span>    <a href="#kMeasTlId">kMeasTlId</a><span class="p">,</span>           <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>  <span class="l">&quotSelect a bar marker and generate a 'sel' output.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotcurs&quot</span><span class="p">,</span>    <a href="#kCursTlId">kCursTlId</a><span class="p">,</span>           <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>  <span class="l">&quotCurrent audio file index.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotreset&quot</span><span class="p">,</span>   <a href="#kResetTlId">kResetTlId</a><span class="p">,</span>          <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kSymDsvFl">kSymDsvFl</a><span class="p">,</span>   <span class="l">&quotResend all outputs.&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotafn&quot</span><span class="p">,</span>     <a href="#kAudFnTlId">kAudFnTlId</a><span class="p">,</span>          <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kStrzDsvFl">kStrzDsvFl</a><span class="p">,</span>  <span class="l">&quotSelected Audio file.&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotalbl&quot</span><span class="p">,</span>    <a href="#kAudLblTlId">kAudLblTlId</a><span class="p">,</span>         <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kStrzDsvFl">kStrzDsvFl</a><span class="p">,</span>  <span class="l">&quotSelect Audio file time line label.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotmfn&quot</span><span class="p">,</span>     <a href="#kMidiFnTlId">kMidiFnTlId</a><span class="p">,</span>         <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kStrzDsvFl">kStrzDsvFl</a><span class="p">,</span>  <span class="l">&quotSelected MIDI file.&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotmlbl&quot</span><span class="p">,</span>    <a href="#kMidiLblTlId">kMidiLblTlId</a><span class="p">,</span>        <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kStrzDsvFl">kStrzDsvFl</a><span class="p">,</span>  <span class="l">&quotSelect MIDI file time line label.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotabsi&quot</span><span class="p">,</span>    <a href="#kBegAudSmpIdxTlId">kBegAudSmpIdxTlId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kIntDsvFl">kIntDsvFl</a><span class="p">,</span>   <span class="l">&quotBegin audio sample index.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotaesi&quot</span><span class="p">,</span>    <a href="#kEndAudSmpIdxTlId">kEndAudSmpIdxTlId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kIntDsvFl">kIntDsvFl</a><span class="p">,</span>   <span class="l">&quotEnd audio sample index.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotmbsi&quot</span><span class="p">,</span>    <a href="#kBegMidiSmpIdxTlId">kBegMidiSmpIdxTlId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kIntDsvFl">kIntDsvFl</a><span class="p">,</span>   <span class="l">&quotBegin MIDI sample index.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotmesi&quot</span><span class="p">,</span>    <a href="#kEndMidiSmpIdxTlId">kEndMidiSmpIdxTlId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kIntDsvFl">kIntDsvFl</a><span class="p">,</span>   <span class="l">&quotEnd MIDI sample index.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> NULL<span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span> <span class="p">}</span>
  <span class="p">}</span><span class="p">;</span>
  
  <a href="#cmDspTimeLine_t">cmDspTimeLine_t</a><span class="p">*</span> p <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstAlloc">cmDspInstAlloc</a><span class="p">(</span><a href="#cmDspTimeLine_t">cmDspTimeLine_t</a><span class="p">,</span>ctx<span class="p">,</span>classPtr<span class="p">,</span>args<span class="p">,</span>instSymId<span class="p">,</span>id<span class="p">,</span>storeSymId<span class="p">,</span>va_cnt<span class="p">,</span>vl<span class="p">)</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span> ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kSelTlId">kSelTlId</a><span class="p">,</span>           <span class="l">0</span><span class="p">,</span> <a href="cmGlobal_h_0.html#cmInvalidId">cmInvalidId</a><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span> ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kCursTlId">kCursTlId</a><span class="p">,</span>          <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultStrcz">cmDspSetDefaultStrcz</a><span class="p">(</span>ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kAudFnTlId">kAudFnTlId</a><span class="p">,</span>         NULL<span class="p">,</span> <span class="l">&quot&quot</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultStrcz">cmDspSetDefaultStrcz</a><span class="p">(</span>ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kAudLblTlId">kAudLblTlId</a><span class="p">,</span>        NULL<span class="p">,</span> <span class="l">&quot&quot</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultStrcz">cmDspSetDefaultStrcz</a><span class="p">(</span>ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kMidiFnTlId">kMidiFnTlId</a><span class="p">,</span>        NULL<span class="p">,</span> <span class="l">&quot&quot</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultStrcz">cmDspSetDefaultStrcz</a><span class="p">(</span>ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kMidiLblTlId">kMidiLblTlId</a><span class="p">,</span>       NULL<span class="p">,</span> <span class="l">&quot&quot</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultInt">cmDspSetDefaultInt</a><span class="p">(</span>  ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kBegAudSmpIdxTlId">kBegAudSmpIdxTlId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span> <a href="cmGlobal_h_0.html#cmInvalidIdx">cmInvalidIdx</a><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultInt">cmDspSetDefaultInt</a><span class="p">(</span>  ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kEndAudSmpIdxTlId">kEndAudSmpIdxTlId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span> <a href="cmGlobal_h_0.html#cmInvalidIdx">cmInvalidIdx</a><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultInt">cmDspSetDefaultInt</a><span class="p">(</span>  ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kBegMidiSmpIdxTlId">kBegMidiSmpIdxTlId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmGlobal_h_0.html#cmInvalidIdx">cmInvalidIdx</a><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultInt">cmDspSetDefaultInt</a><span class="p">(</span>  ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kEndMidiSmpIdxTlId">kEndMidiSmpIdxTlId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmGlobal_h_0.html#cmInvalidIdx">cmInvalidIdx</a><span class="p">)</span><span class="p">;</span>
  
  <span class="c">// create the UI control</span>
  <a href="cmDspClass_h_0.html#cmDspUiTimeLineCreate">cmDspUiTimeLineCreate</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kTlFileTlId">kTlFileTlId</a><span class="p">,</span><a href="#kPrefixPathTlId">kPrefixPathTlId</a><span class="p">,</span><a href="#kSelTlId">kSelTlId</a><span class="p">,</span><a href="#kMeasTlId">kMeasTlId</a><span class="p">,</span><a href="#kCursTlId">kCursTlId</a><span class="p">)</span><span class="p">;</span>
  
  p<span class="p">-</span><span class="p">&gt</span>tlH <span class="p">=</span> cmTimeLineNullHandle<span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspTimeLineFree_defn"></a><a name="_cmDspTimeLineFree"></a><span class="f">_cmDspTimeLineFree</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>        rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspTimeLine_t">cmDspTimeLine_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspTimeLine_t">cmDspTimeLine_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> <a href="cmTimeLine_h_0.html#cmTimeLineFinalize">cmTimeLineFinalize</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>tlH<span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmTimeLine_h_0.html#kOkTlRC">kOkTlRC</a> <span class="p">)</span>
    <span class="k">return</span> <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>inst<span class="p">-</span><span class="p">&gt</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span> <a href="cmDspClass_h_0.html#kInstFinalFailDspRC">kInstFinalFailDspRC</a><span class="p">,</span> <span class="l">&quotTime-line finalize failed.&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>


<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspTimeLineReset_defn"></a><a name="_cmDspTimeLineReset"></a><span class="f">_cmDspTimeLineReset</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>        rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspTimeLine_t">cmDspTimeLine_t</a><span class="p">*</span> p  <span class="p">=</span> <span class="p">(</span><a href="#cmDspTimeLine_t">cmDspTimeLine_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspApplyAllDefaults">cmDspApplyAllDefaults</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">;</span>
  
  <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> tlFn<span class="p">;</span>
  
  <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> tlPrePath <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspStrcz">cmDspStrcz</a><span class="p">(</span>inst<span class="p">,</span><a href="#kPrefixPathTlId">kPrefixPathTlId</a><span class="p">)</span><span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span><span class="p">(</span>tlFn <span class="p">=</span>  <a href="cmDspClass_h_0.html#cmDspStrcz">cmDspStrcz</a><span class="p">(</span>inst<span class="p">,</span> <a href="#kTlFileTlId">kTlFileTlId</a> <span class="p">)</span><span class="p">)</span> <span class="p">!</span><span class="p">=</span>  NULL <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <a href="cmTimeLine_h_0.html#cmTimeLineInitializeFromFile">cmTimeLineInitializeFromFile</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span><a href="cmProcObj_h_0.html#cmCtx">cmCtx</a><span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>tlH<span class="p">,</span> NULL<span class="p">,</span> NULL<span class="p">,</span> tlFn<span class="p">,</span> tlPrePath <span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmTimeLine_h_0.html#kOkTlRC">kOkTlRC</a> <span class="p">)</span>
      rc <span class="p">=</span> <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>inst<span class="p">-</span><span class="p">&gt</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span> <a href="cmDspClass_h_0.html#kInstResetFailDspRC">kInstResetFailDspRC</a><span class="p">,</span> <span class="l">&quotTime-line file open failed.&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspTimeLineRecv_defn"></a><a name="_cmDspTimeLineRecv"></a><span class="f">_cmDspTimeLineRecv</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspTimeLine_t">cmDspTimeLine_t</a><span class="p">*</span> p  <span class="p">=</span> <span class="p">(</span><a href="#cmDspTimeLine_t">cmDspTimeLine_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <span class="k">switch</span><span class="p">(</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">)</span>
  <span class="p">{</span>
  <span class="k">case</span> <a href="#kPrefixPathTlId">kPrefixPathTlId</a><span class="p">:</span>
    <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kCursTlId">kCursTlId</a><span class="p">:</span>
    <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kResetTlId">kResetTlId</a><span class="p">:</span>
  <span class="k">case</span> <a href="#kSelTlId">kSelTlId</a><span class="p">:</span>
    <span class="p">{</span>
      <span class="k">unsigned</span> markerId<span class="p">;</span>
      <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
      
      <span class="c">// get the id of the selected marker</span>
      <span class="k">if</span><span class="p">(</span><span class="p">(</span>markerId <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kSelTlId">kSelTlId</a><span class="p">)</span><span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmGlobal_h_0.html#cmInvalidId">cmInvalidId</a> <span class="p">)</span>
      <span class="p">{</span>
        <span class="c">// get the marker object</span>
        <a href="cmTimeLine_h_0.html#cmTlObj_t">cmTlObj_t</a><span class="p">*</span> op<span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="p">(</span>op <span class="p">=</span> <a href="cmTimeLine_h_0.html#cmTimeLineIdToObj">cmTimeLineIdToObj</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>tlH<span class="p">,</span> <a href="cmGlobal_h_0.html#cmInvalidId">cmInvalidId</a><span class="p">,</span> markerId <span class="p">)</span><span class="p">)</span> <span class="p">!</span><span class="p">=</span> NULL <span class="p">)</span>
        <span class="p">{</span>
          assert<span class="p">(</span>op<span class="p">-</span><span class="p">&gt</span>typeId <span class="p">=</span><span class="p">=</span> <a href="cmTimeLine_h_0.html#kMarkerTlId">kMarkerTlId</a> <span class="p">|</span><span class="p">|</span> op<span class="p">-</span><span class="p">&gt</span>typeId <span class="p">=</span><span class="p">=</span> <a href="cmTimeLine_h_0.html#kMidiEvtTlId">kMidiEvtTlId</a> <span class="p">)</span><span class="p">;</span>
          
          p<span class="p">-</span><span class="p">&gt</span>afIdx <span class="p">=</span> op<span class="p">-</span><span class="p">&gt</span>begSmpIdx<span class="p">;</span>
          
          <a href="cmDspClass_h_0.html#cmDspSetInt">cmDspSetInt</a><span class="p">(</span>ctx<span class="p">,</span> inst<span class="p">,</span> <a href="#kBegAudSmpIdxTlId">kBegAudSmpIdxTlId</a><span class="p">,</span>  op<span class="p">-</span><span class="p">&gt</span>begSmpIdx <span class="p">)</span><span class="p">;</span>
          <a href="cmDspClass_h_0.html#cmDspSetInt">cmDspSetInt</a><span class="p">(</span>ctx<span class="p">,</span> inst<span class="p">,</span> <a href="#kEndAudSmpIdxTlId">kEndAudSmpIdxTlId</a><span class="p">,</span>  op<span class="p">-</span><span class="p">&gt</span>begSmpIdx <span class="p">+</span> op<span class="p">-</span><span class="p">&gt</span>durSmpCnt <span class="p">)</span><span class="p">;</span>
          
          <span class="c">// locate the audio file assoc'd with the marker</span>
          <a href="cmTimeLine_h_0.html#cmTlAudioFile_t">cmTlAudioFile_t</a><span class="p">*</span> afp<span class="p">;</span>
          <span class="k">if</span><span class="p">(</span><span class="p">(</span>afp <span class="p">=</span> <a href="cmTimeLine_h_0.html#cmTimeLineAudioFileAtTime">cmTimeLineAudioFileAtTime</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>tlH<span class="p">,</span>op<span class="p">-</span><span class="p">&gt</span>seqId<span class="p">,</span>op<span class="p">-</span><span class="p">&gt</span>seqSmpIdx<span class="p">)</span><span class="p">)</span> <span class="p">!</span><span class="p">=</span> NULL<span class="p">)</span>
          <span class="p">{</span>
            <a href="cmDspClass_h_0.html#cmDspSetStrcz">cmDspSetStrcz</a><span class="p">(</span>ctx<span class="p">,</span> inst<span class="p">,</span> <a href="#kAudFnTlId">kAudFnTlId</a><span class="p">,</span> afp<span class="p">-</span><span class="p">&gt</span>fn <span class="p">)</span><span class="p">;</span>
            <a href="cmDspClass_h_0.html#cmDspSetStrcz">cmDspSetStrcz</a><span class="p">(</span>ctx<span class="p">,</span> inst<span class="p">,</span> <a href="#kAudLblTlId">kAudLblTlId</a><span class="p">,</span> afp<span class="p">-</span><span class="p">&gt</span>obj<span class="p">.</span>name <span class="p">)</span><span class="p">;</span>              
          <span class="p">}</span>
          
          <span class="c">// locate the midi file assoc'd with the marker</span>
          <a href="cmTimeLine_h_0.html#cmTlMidiFile_t">cmTlMidiFile_t</a><span class="p">*</span> mfp<span class="p">;</span>
          <span class="k">if</span><span class="p">(</span><span class="p">(</span>mfp <span class="p">=</span> <a href="cmTimeLine_h_0.html#cmTimeLineMidiFileAtTime">cmTimeLineMidiFileAtTime</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>tlH<span class="p">,</span>op<span class="p">-</span><span class="p">&gt</span>seqId<span class="p">,</span>op<span class="p">-</span><span class="p">&gt</span>seqSmpIdx<span class="p">)</span><span class="p">)</span> <span class="p">!</span><span class="p">=</span> NULL <span class="p">)</span>
          <span class="p">{</span>
            <a href="cmDspClass_h_0.html#cmDspSetInt">cmDspSetInt</a><span class="p">(</span>ctx<span class="p">,</span> inst<span class="p">,</span> <a href="#kBegMidiSmpIdxTlId">kBegMidiSmpIdxTlId</a><span class="p">,</span> op<span class="p">-</span><span class="p">&gt</span>seqSmpIdx <span class="p">-</span> mfp<span class="p">-</span><span class="p">&gt</span>obj<span class="p">.</span>seqSmpIdx <span class="p">)</span><span class="p">;</span>
            <a href="cmDspClass_h_0.html#cmDspSetInt">cmDspSetInt</a><span class="p">(</span>ctx<span class="p">,</span> inst<span class="p">,</span> <a href="#kEndMidiSmpIdxTlId">kEndMidiSmpIdxTlId</a><span class="p">,</span> op<span class="p">-</span><span class="p">&gt</span>seqSmpIdx <span class="p">+</span> op<span class="p">-</span><span class="p">&gt</span>durSmpCnt <span class="p">-</span> mfp<span class="p">-</span><span class="p">&gt</span>obj<span class="p">.</span>seqSmpIdx <span class="p">)</span><span class="p">;</span>
            
            <a href="cmDspClass_h_0.html#cmDspSetStrcz">cmDspSetStrcz</a><span class="p">(</span>ctx<span class="p">,</span> inst<span class="p">,</span> <a href="#kMidiFnTlId">kMidiFnTlId</a><span class="p">,</span> mfp<span class="p">-</span><span class="p">&gt</span>fn <span class="p">)</span><span class="p">;</span>
            <a href="cmDspClass_h_0.html#cmDspSetStrcz">cmDspSetStrcz</a><span class="p">(</span>ctx<span class="p">,</span> inst<span class="p">,</span> <a href="#kMidiLblTlId">kMidiLblTlId</a><span class="p">,</span>mfp<span class="p">-</span><span class="p">&gt</span>obj<span class="p">.</span>name <span class="p">)</span><span class="p">;</span>              
            
          <span class="p">}</span>
        <span class="p">}</span>
        
      <span class="p">}</span>
      
    <span class="p">}</span>
    
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kMeasTlId">kMeasTlId</a><span class="p">:</span>
    <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">default</span><span class="p">:</span>
    <span class="p">{</span>assert<span class="p">(</span><span class="l">0</span><span class="p">)</span><span class="p">;</span><span class="p">}</span>
  <span class="p">}</span>
  
  <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> <a name="cmTimeLineClassCons_defn"></a><span class="f"><a href="cmDspKr_h_0.html#cmTimeLineClassCons">cmTimeLineClassCons</a></span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspClassSetup">cmDspClassSetup</a><span class="p">(</span><span class="p">&amp</span>_cmTimeLineDC<span class="p">,</span>ctx<span class="p">,</span><span class="l">&quotTimeLine&quot</span><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspTimeLineAlloc">_cmDspTimeLineAlloc</a><span class="p">,</span>
  <a href="#_cmDspTimeLineFree">_cmDspTimeLineFree</a><span class="p">,</span>
  <a href="#_cmDspTimeLineReset">_cmDspTimeLineReset</a><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspTimeLineRecv">_cmDspTimeLineRecv</a><span class="p">,</span>
  NULL<span class="p">,</span>NULL<span class="p">,</span>
  <span class="l">&quotTime Line control.&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>_cmTimeLineDC<span class="p">;</span>
<span class="p">}</span>

<span class="c"><hr id="hr1"></span></pre>
</div>
<div class="cod"><div class="blk_title">cmDspScore : Musical score user interface unit.</div><pre><a name="cmDspScore"></a>
<span class="k">enum</span>
<span class="p">{</span>
  <a name="kFnScId"></a><span class="e">kFnScId</span><span class="p">,</span>
  <a name="kSelScId"></a><span class="e">kSelScId</span><span class="p">,</span>
  <a name="kSendScId"></a><span class="e">kSendScId</span><span class="p">,</span>
  <a name="kStatusScId"></a><span class="e">kStatusScId</span><span class="p">,</span>
  <a name="kD0ScId"></a><span class="e">kD0ScId</span><span class="p">,</span>
  <a name="kD1ScId"></a><span class="e">kD1ScId</span><span class="p">,</span>
  <a name="kSmpIdxScId"></a><span class="e">kSmpIdxScId</span><span class="p">,</span>
  <a name="kLocIdxScId"></a><span class="e">kLocIdxScId</span><span class="p">,</span>
  <a name="kCmdScId"></a><span class="e">kCmdScId</span><span class="p">,</span>
  <a name="kEvtIdxScId"></a><span class="e">kEvtIdxScId</span><span class="p">,</span>
  <a name="kDynScId"></a><span class="e">kDynScId</span><span class="p">,</span>
  <a name="kValTypeScId"></a><span class="e">kValTypeScId</span><span class="p">,</span>
  <a name="kValueScId"></a><span class="e">kValueScId</span><span class="p">,</span>
  <a name="kMeasScId"></a><span class="e">kMeasScId</span><span class="p">,</span>
<span class="p">}</span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a> _cmScoreDC<span class="p">;</span>

<a name="cmDspScore_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a> <a name="cmDspScore_t.inst"></a><span class="i">inst</span><span class="p">;</span>
  <a href="cmScore_h_0.html#cmScH_t">cmScH_t</a>     <a name="cmDspScore_t.scH"></a><span class="i">scH</span><span class="p">;</span>
  <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> <a name="cmDspScore_t.ctx"></a><span class="i">ctx</span><span class="p">;</span>   <span class="c"> // temporary ctx ptr used during cmScore callback in <a href="#_cmDspScoreRecv">_cmDspScoreRecv</a>()</span>
  <span class="k">unsigned</span> <a name="cmDspScore_t.printSymId"></a><span class="i">printSymId</span><span class="p">;</span>
<span class="p">}</span> <span class="t"><a href="#cmDspScore_t">cmDspScore_t</a></span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span>  <a name="_cmDspScoreAlloc_defn"></a><a name="_cmDspScoreAlloc"></a><span class="f">_cmDspScoreAlloc</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> classPtr<span class="p">,</span> <span class="k">unsigned</span> storeSymId<span class="p">,</span> <span class="k">unsigned</span> instSymId<span class="p">,</span> <span class="k">unsigned</span> id<span class="p">,</span> <span class="k">unsigned</span> va_cnt<span class="p">,</span> va_list vl <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspVarArg_t">cmDspVarArg_t</a> args<span class="p">[</span><span class="p">]</span> <span class="p">=</span>
  <span class="p">{</span>
    <span class="p">{</span> <span class="l">&quotfn&quot</span><span class="p">,</span>      <a href="#kFnScId">kFnScId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kStrzDsvFl">kStrzDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kReqArgDsvFl">kReqArgDsvFl</a><span class="p">,</span> <span class="l">&quotScore file.&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotsel&quot</span><span class="p">,</span>     <a href="#kSelScId">kSelScId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>   <span class="l">&quotSelected score element index input.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotsend&quot</span><span class="p">,</span>    <a href="#kSendScId">kSendScId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kTypeDsvMask">kTypeDsvMask</a><span class="p">,</span>              <span class="l">&quotResend last selected score element.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotstatus&quot</span><span class="p">,</span>  <a href="#kStatusScId">kStatusScId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kIntDsvFl">kIntDsvFl</a><span class="p">,</span>                 <span class="l">&quotPerformed MIDI status value output&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotd0&quot</span><span class="p">,</span>      <a href="#kD0ScId">kD0ScId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                <span class="l">&quotPerformed MIDI msg data byte 0&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotd1&quot</span><span class="p">,</span>      <a href="#kD1ScId">kD1ScId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                <span class="l">&quotPerformed MIDI msg data byte 1&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotsmpidx&quot</span><span class="p">,</span>  <a href="#kSmpIdxScId">kSmpIdxScId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                <span class="l">&quotPerformed MIDi msg time tag as a sample index.&quot</span> <span class="p">}</span><span class="p">,</span> 
    <span class="p">{</span> <span class="l">&quotloc&quot</span><span class="p">,</span>     <a href="#kLocIdxScId">kLocIdxScId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                <span class="l">&quotPerformance score location.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotcmd&quot</span><span class="p">,</span>     <a href="#kCmdScId">kCmdScId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kSymDsvFl">kSymDsvFl</a><span class="p">,</span>                 <span class="l">&quotcmd: dump &quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotevtidx&quot</span><span class="p">,</span>  <a href="#kEvtIdxScId">kEvtIdxScId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                <span class="l">&quotPerformed event index of following dynamcis level.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotdyn&quot</span><span class="p">,</span>     <a href="#kDynScId">kDynScId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                <span class="l">&quotDynamic level of previous event index.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quottype&quot</span><span class="p">,</span>    <a href="#kValTypeScId">kValTypeScId</a><span class="p">,</span><span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                <span class="l">&quotOutput variable type.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotvalue&quot</span><span class="p">,</span>   <a href="#kValueScId">kValueScId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a><span class="p">,</span>              <span class="l">&quotOutput variable value.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotmeas&quot</span><span class="p">,</span>    <a href="#kMeasScId">kMeasScId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                <span class="l">&quotTrigger this measures location to emit from 'sel'.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> NULL<span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span> <span class="p">}</span>
  <span class="p">}</span><span class="p">;</span>
  
  <a href="#cmDspScore_t">cmDspScore_t</a><span class="p">*</span> p <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstAlloc">cmDspInstAlloc</a><span class="p">(</span><a href="#cmDspScore_t">cmDspScore_t</a><span class="p">,</span>ctx<span class="p">,</span>classPtr<span class="p">,</span>args<span class="p">,</span>instSymId<span class="p">,</span>id<span class="p">,</span>storeSymId<span class="p">,</span>va_cnt<span class="p">,</span>vl<span class="p">)</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span> ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kSelScId">kSelScId</a><span class="p">,</span>           <span class="l">0</span><span class="p">,</span> <a href="cmGlobal_h_0.html#cmInvalidId">cmInvalidId</a><span class="p">)</span><span class="p">;</span>
  
  p<span class="p">-</span><span class="p">&gt</span>printSymId <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblRegisterStaticSymbol">cmSymTblRegisterStaticSymbol</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span><span class="l">&quotdump&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="c">// create the UI control</span>
  <a href="cmDspClass_h_0.html#cmDspUiScoreCreate">cmDspUiScoreCreate</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kFnScId">kFnScId</a><span class="p">,</span><a href="#kSelScId">kSelScId</a><span class="p">,</span><a href="#kSmpIdxScId">kSmpIdxScId</a><span class="p">,</span><a href="#kD0ScId">kD0ScId</a><span class="p">,</span><a href="#kD1ScId">kD1ScId</a><span class="p">,</span><a href="#kLocIdxScId">kLocIdxScId</a><span class="p">,</span><a href="#kEvtIdxScId">kEvtIdxScId</a><span class="p">,</span><a href="#kDynScId">kDynScId</a><span class="p">,</span><a href="#kValTypeScId">kValTypeScId</a><span class="p">,</span><a href="#kValueScId">kValueScId</a><span class="p">,</span><a href="#kMeasScId">kMeasScId</a><span class="p">)</span><span class="p">;</span>
  
  p<span class="p">-</span><span class="p">&gt</span>scH <span class="p">=</span> cmScNullHandle<span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspScoreFree_defn"></a><a name="_cmDspScoreFree"></a><span class="f">_cmDspScoreFree</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>        rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspScore_t">cmDspScore_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspScore_t">cmDspScore_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> <a href="cmScore_h_0.html#cmScoreFinalize">cmScoreFinalize</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>scH<span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmTimeLine_h_0.html#kOkTlRC">kOkTlRC</a> <span class="p">)</span>
    <span class="k">return</span> <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>inst<span class="p">-</span><span class="p">&gt</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span> <a href="cmDspClass_h_0.html#kInstFinalFailDspRC">kInstFinalFailDspRC</a><span class="p">,</span> <span class="l">&quotScore finalize failed.&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<span class="c">// Callback from cmScore triggered from <a href="#_cmDspScoreRecv">_cmDspScoreRecv</a>() during call to <a href="cmScore_h_0.html#cmScoreSetPerfEvent">cmScoreSetPerfEvent</a>().</span>
<span class="k">void</span> <a name="_cmDspScoreCb_defn"></a><a name="_cmDspScoreCb"></a><span class="f">_cmDspScoreCb</span><span class="p">(</span> <span class="k">void</span><span class="p">*</span> arg<span class="p">,</span> <span class="k">const</span> <span class="k">void</span><span class="p">*</span> data<span class="p">,</span> <span class="k">unsigned</span> byteCnt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span>  inst <span class="p">=</span> <span class="p">(</span><a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span><span class="p">)</span>arg<span class="p">;</span>
  <a href="#cmDspScore_t">cmDspScore_t</a><span class="p">*</span> p    <span class="p">=</span> <span class="p">(</span><a href="#cmDspScore_t">cmDspScore_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  <a href="cmScore_h_0.html#cmScMsg_t">cmScMsg_t</a> m<span class="p">;</span>
  <span class="k">if</span><span class="p">(</span> <a href="cmScore_h_0.html#cmScoreDecode">cmScoreDecode</a><span class="p">(</span>data<span class="p">,</span>byteCnt<span class="p">,</span><span class="p">&amp</span>m<span class="p">)</span> <span class="p">=</span><span class="p">=</span> <a href="cmScore_h_0.html#kOkScRC">kOkScRC</a> <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">switch</span><span class="p">(</span> m<span class="p">.</span>typeId <span class="p">)</span>
    <span class="p">{</span>
    <span class="k">case</span> <a href="cmScore_h_0.html#kDynMsgScId">kDynMsgScId</a><span class="p">:</span>
      <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>ctx<span class="p">,</span>inst<span class="p">,</span> <a href="#kEvtIdxScId">kEvtIdxScId</a><span class="p">,</span> m<span class="p">.</span>u<span class="p">.</span>dyn<span class="p">.</span>evtIdx <span class="p">)</span><span class="p">;</span>
      <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>ctx<span class="p">,</span>inst<span class="p">,</span> <a href="#kDynScId">kDynScId</a><span class="p">,</span>    m<span class="p">.</span>u<span class="p">.</span>dyn<span class="p">.</span>dynLvl <span class="p">)</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
      
    <span class="k">case</span> <a href="cmScore_h_0.html#kVarMsgScId">kVarMsgScId</a><span class="p">:</span>
      <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>  p<span class="p">-</span><span class="p">&gt</span>ctx<span class="p">,</span>inst<span class="p">,</span> <a href="#kValTypeScId">kValTypeScId</a><span class="p">,</span> m<span class="p">.</span>u<span class="p">.</span>meas<span class="p">.</span>varId<span class="p">)</span><span class="p">;</span>
      <a href="cmDspClass_h_0.html#cmDspSetDouble">cmDspSetDouble</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>ctx<span class="p">,</span>inst<span class="p">,</span> <a href="#kValueScId">kValueScId</a><span class="p">,</span>   m<span class="p">.</span>u<span class="p">.</span>meas<span class="p">.</span>value<span class="p">)</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
      
    <span class="k">default</span><span class="p">:</span>
      <span class="p">{</span> assert<span class="p">(</span><span class="l">0</span><span class="p">)</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspScoreReset_defn"></a><a name="_cmDspScoreReset"></a><span class="f">_cmDspScoreReset</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>       rc          <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspScore_t">cmDspScore_t</a><span class="p">*</span>   p           <span class="p">=</span> <span class="p">(</span><a href="#cmDspScore_t">cmDspScore_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> tlFn        <span class="p">=</span> NULL<span class="p">;</span>
  <span class="k">unsigned</span><span class="p">*</span>       dynRefArray <span class="p">=</span> NULL<span class="p">;</span>
  <span class="k">unsigned</span>        dynRefCnt   <span class="p">=</span> <span class="l">0</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspApplyAllDefaults">cmDspApplyAllDefaults</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">;</span>
  
  
  <span class="k">if</span><span class="p">(</span> <a href="cmDspSys_h_0.html#cmDspRsrcUIntArray">cmDspRsrcUIntArray</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>dspH<span class="p">,</span> <span class="p">&amp</span>dynRefCnt<span class="p">,</span> <span class="p">&amp</span>dynRefArray<span class="p">,</span> <span class="l">&quotdynRef&quot</span><span class="p">,</span> NULL <span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a> <span class="p">)</span>
  <span class="p">{</span>
    rc <span class="p">=</span> <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>inst<span class="p">-</span><span class="p">&gt</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span> <a href="cmDspClass_h_0.html#kRsrcNotFoundDspRC">kRsrcNotFoundDspRC</a><span class="p">,</span> <span class="l">&quotThe dynamics reference array resource was not found.&quot</span><span class="p">)</span><span class="p">;</span>
    goto errLabel<span class="p">;</span>
  <span class="p">}</span>
  
  <span class="k">if</span><span class="p">(</span><span class="p">(</span>tlFn <span class="p">=</span>  <a href="cmDspClass_h_0.html#cmDspStrcz">cmDspStrcz</a><span class="p">(</span>inst<span class="p">,</span> <a href="#kFnScId">kFnScId</a> <span class="p">)</span><span class="p">)</span> <span class="p">!</span><span class="p">=</span>  NULL <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span> <a href="cmScore_h_0.html#cmScoreInitialize">cmScoreInitialize</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span><a href="cmProcObj_h_0.html#cmCtx">cmCtx</a><span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>scH<span class="p">,</span> tlFn<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspSampleRate">cmDspSampleRate</a><span class="p">(</span>ctx<span class="p">)</span><span class="p">,</span> dynRefArray<span class="p">,</span> dynRefCnt<span class="p">,</span> <a href="#_cmDspScoreCb">_cmDspScoreCb</a><span class="p">,</span> p<span class="p">,</span> ctx<span class="p">-</span><span class="p">&gt</span>stH <span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmTimeLine_h_0.html#kOkTlRC">kOkTlRC</a> <span class="p">)</span>
      rc <span class="p">=</span> <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>inst<span class="p">-</span><span class="p">&gt</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span> <a href="cmDspClass_h_0.html#kInstResetFailDspRC">kInstResetFailDspRC</a><span class="p">,</span> <span class="l">&quotScore file open failed.&quot</span><span class="p">)</span><span class="p">;</span>
    <span class="c">//else
    //  <a href="cmScore_h_0.html#cmScorePrintLoc">cmScorePrintLoc</a>(p-&ampgtscH);</span>    
  <span class="p">}</span>
  errLabel<span class="p">:</span>
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspScoreRecv_defn"></a><a name="_cmDspScoreRecv"></a><span class="f">_cmDspScoreRecv</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspScore_t">cmDspScore_t</a><span class="p">*</span> p  <span class="p">=</span> <span class="p">(</span><a href="#cmDspScore_t">cmDspScore_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">=</span><span class="p">=</span> <a href="#kSendScId">kSendScId</a> <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">unsigned</span> selIdx<span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="p">(</span>selIdx <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kSelScId">kSelScId</a><span class="p">)</span><span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmGlobal_h_0.html#cmInvalidIdx">cmInvalidIdx</a> <span class="p">)</span>
    <span class="p">{</span>
      <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kSelScId">kSelScId</a><span class="p">,</span> selIdx <span class="p">)</span><span class="p">;</span>
      <a href="cmScore_h_0.html#cmScoreClearPerfInfo">cmScoreClearPerfInfo</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>scH<span class="p">)</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <span class="p">}</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
  
  <span class="k">switch</span><span class="p">(</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">)</span>
  <span class="p">{</span>
  <span class="k">case</span> <a href="#kSelScId">kSelScId</a><span class="p">:</span>
    <a href="cmScore_h_0.html#cmScoreClearPerfInfo">cmScoreClearPerfInfo</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>scH<span class="p">)</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kStatusScId">kStatusScId</a><span class="p">:</span>
    <span class="c">//printf(&ampquotst:%x\n&ampquot,<a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a>(inst,<a href="#kStatusScId">kStatusScId</a>));</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kLocIdxScId">kLocIdxScId</a><span class="p">:</span>
    <span class="p">{</span>
      assert<span class="p">(</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kStatusScId">kStatusScId</a> <span class="p">)</span> <span class="p">=</span><span class="p">=</span> <a href="cmMidi_h_0.html#kNoteOnMdId">kNoteOnMdId</a> <span class="p">)</span><span class="p">;</span>
      p<span class="p">-</span><span class="p">&gt</span>ctx <span class="p">=</span> ctx<span class="p">;</span> <span class="c"> // setup p-&ampgtctx for use in <a href="#_cmDspScoreCb">_cmDspScoreCb</a>()</span>
      
      <span class="c">// this call may result in callbacks to <a href="#_cmDspScoreCb">_cmDspScoreCb</a>()</span>
      <a href="cmScore_h_0.html#cmScoreExecPerfEvent">cmScoreExecPerfEvent</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>scH<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kLocIdxScId">kLocIdxScId</a><span class="p">)</span><span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kSmpIdxScId">kSmpIdxScId</a><span class="p">)</span><span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kD0ScId">kD0ScId</a><span class="p">)</span><span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kD1ScId">kD1ScId</a><span class="p">)</span> <span class="p">)</span><span class="p">;</span>      
    <span class="p">}</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kCmdScId">kCmdScId</a><span class="p">:</span>
    <span class="k">if</span><span class="p">(</span> <a href="cmDspClass_h_0.html#cmDspSymbol">cmDspSymbol</a><span class="p">(</span>inst<span class="p">,</span><a href="#kCmdScId">kCmdScId</a><span class="p">)</span> <span class="p">=</span><span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>printSymId <span class="p">)</span>
      <a href="cmScore_h_0.html#cmScorePrintLoc">cmScorePrintLoc</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>scH<span class="p">)</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kMeasScId">kMeasScId</a><span class="p">:</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="p">}</span>
  
  <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> <a name="cmScoreClassCons_defn"></a><span class="f"><a href="cmDspKr_h_0.html#cmScoreClassCons">cmScoreClassCons</a></span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspClassSetup">cmDspClassSetup</a><span class="p">(</span><span class="p">&amp</span>_cmScoreDC<span class="p">,</span>ctx<span class="p">,</span><span class="l">&quotScore&quot</span><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspScoreAlloc">_cmDspScoreAlloc</a><span class="p">,</span>
  <a href="#_cmDspScoreFree">_cmDspScoreFree</a><span class="p">,</span>
  <a href="#_cmDspScoreReset">_cmDspScoreReset</a><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspScoreRecv">_cmDspScoreRecv</a><span class="p">,</span>
  NULL<span class="p">,</span>NULL<span class="p">,</span>
  <span class="l">&quotScore control.&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>_cmScoreDC<span class="p">;</span>
<span class="p">}</span>

<span class="c"><hr id="hr1"></span></pre>
</div>
<div class="cod"><div class="blk_title">cmDspMidiFilePlay : MIDI file player.</div><pre><a name="cmDspMidiFilePlay"></a>
<span class="k">enum</span>
<span class="p">{</span>
  <a name="kFnMfId"></a><span class="e">kFnMfId</span><span class="p">,</span>
  <a name="kSelMfId"></a><span class="e">kSelMfId</span><span class="p">,</span>    
  <a name="kBsiMfId"></a><span class="e">kBsiMfId</span><span class="p">,</span>
  <a name="kEsiMfId"></a><span class="e">kEsiMfId</span><span class="p">,</span>
  <a name="kStatusMfId"></a><span class="e">kStatusMfId</span><span class="p">,</span>
  <a name="kD0MfId"></a><span class="e">kD0MfId</span><span class="p">,</span>
  <a name="kD1MfId"></a><span class="e">kD1MfId</span><span class="p">,</span>
  <a name="kSmpIdxMfId"></a><span class="e">kSmpIdxMfId</span><span class="p">,</span>
  <a name="kIdMfId"></a><span class="e">kIdMfId</span>
<span class="p">}</span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a> _cmMidiFilePlayDC<span class="p">;</span>

<a name="cmDspMidiFilePlay_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a>   <a name="cmDspMidiFilePlay_t.inst"></a><span class="i">inst</span><span class="p">;</span>
  <a href="cmMidiFile_h_0.html#cmMidiFileH_t">cmMidiFileH_t</a> <a name="cmDspMidiFilePlay_t.mfH"></a><span class="i">mfH</span><span class="p">;</span>  
  <span class="k">unsigned</span>      <a name="cmDspMidiFilePlay_t.curMsgIdx"></a><span class="i">curMsgIdx</span><span class="p">;</span>     <span class="c"> // current midi file msg index</span>
  <span class="k">int</span>           <a name="cmDspMidiFilePlay_t.csi"></a><span class="i">csi</span><span class="p">;</span>           <span class="c"> // current sample index</span>
  <span class="k">int</span>           <a name="cmDspMidiFilePlay_t.bsi"></a><span class="i">bsi</span><span class="p">;</span>           <span class="c"> // starting sample index</span>
  <span class="k">int</span>           <a name="cmDspMidiFilePlay_t.esi"></a><span class="i">esi</span><span class="p">;</span>           <span class="c"> // ending sample index</span>
  <span class="k">unsigned</span>      <a name="cmDspMidiFilePlay_t.startSymId"></a><span class="i">startSymId</span><span class="p">;</span>
  <span class="k">unsigned</span>      <a name="cmDspMidiFilePlay_t.stopSymId"></a><span class="i">stopSymId</span><span class="p">;</span>
  <span class="k">unsigned</span>      <a name="cmDspMidiFilePlay_t.contSymId"></a><span class="i">contSymId</span><span class="p">;</span>
  <span class="k">bool</span>          <a name="cmDspMidiFilePlay_t.errFl"></a><span class="i">errFl</span><span class="p">;</span>
<span class="p">}</span> <span class="t"><a href="#cmDspMidiFilePlay_t">cmDspMidiFilePlay_t</a></span><span class="p">;</span>

<span class="c">//  'bsi' and 'esi' give the starting and ending sample for MIDI file playback.
//  These indexes are relative to the start of the file.
//  When the player recieves a 'start' msg it sets the current sample index
//  'si' to 'bsi' and begins scanning for the next note to play.  
//  On each call to the <a href="#_cmDspMidiFilePlayExec">_cmDspMidiFilePlayExec</a>() msgs that fall in the interval
//  si:si+sPc-1 will be transmitted.  (where sPc are the number of samples per DSP cycle).</span>

<a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span>  <a name="_cmDspMidiFilePlayAlloc_defn"></a><a name="_cmDspMidiFilePlayAlloc"></a><span class="f">_cmDspMidiFilePlayAlloc</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> classPtr<span class="p">,</span> <span class="k">unsigned</span> storeSymId<span class="p">,</span> <span class="k">unsigned</span> instSymId<span class="p">,</span> <span class="k">unsigned</span> id<span class="p">,</span> <span class="k">unsigned</span> va_cnt<span class="p">,</span> va_list vl <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspVarArg_t">cmDspVarArg_t</a> args<span class="p">[</span><span class="p">]</span> <span class="p">=</span>
  <span class="p">{</span>
    <span class="p">{</span> <span class="l">&quotfn&quot</span><span class="p">,</span>     <a href="#kFnMfId">kFnMfId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kStrzDsvFl">kStrzDsvFl</a><span class="p">,</span> <span class="l">&quotFile name&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotsel&quot</span><span class="p">,</span>    <a href="#kSelMfId">kSelMfId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kSymDsvFl">kSymDsvFl</a><span class="p">,</span>  <span class="l">&quotstart | stop | continue&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotbsi&quot</span><span class="p">,</span>    <a href="#kBsiMfId">kBsiMfId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kIntDsvFl">kIntDsvFl</a><span class="p">,</span>  <span class="l">&quotStarting sample.&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotesi&quot</span><span class="p">,</span>    <a href="#kEsiMfId">kEsiMfId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kIntDsvFl">kIntDsvFl</a><span class="p">,</span>  <span class="l">&quotEnding sample.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotstatus&quot</span><span class="p">,</span> <a href="#kStatusMfId">kStatusMfId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kIntDsvFl">kIntDsvFl</a><span class="p">,</span>  <span class="l">&quotStatus value output&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotd0&quot</span><span class="p">,</span>     <a href="#kD0MfId">kD0MfId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span> <span class="l">&quotData byte 0&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotd1&quot</span><span class="p">,</span>     <a href="#kD1MfId">kD1MfId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span> <span class="l">&quotData byte 1&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotsmpidx&quot</span><span class="p">,</span> <a href="#kSmpIdxMfId">kSmpIdxMfId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span> <span class="l">&quotMsg time tag as a sample index.&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotid&quot</span><span class="p">,</span>     <a href="#kIdMfId">kIdMfId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span> <span class="l">&quotMIDI file msg unique id.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> NULL<span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span> <span class="p">}</span>
  <span class="p">}</span><span class="p">;</span>
  
  <a href="#cmDspMidiFilePlay_t">cmDspMidiFilePlay_t</a><span class="p">*</span> p <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstAlloc">cmDspInstAlloc</a><span class="p">(</span><a href="#cmDspMidiFilePlay_t">cmDspMidiFilePlay_t</a><span class="p">,</span>ctx<span class="p">,</span>classPtr<span class="p">,</span>args<span class="p">,</span>instSymId<span class="p">,</span>id<span class="p">,</span>storeSymId<span class="p">,</span>va_cnt<span class="p">,</span>vl<span class="p">)</span><span class="p">;</span>
  
  p<span class="p">-</span><span class="p">&gt</span>startSymId <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblRegisterStaticSymbol">cmSymTblRegisterStaticSymbol</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span><span class="l">&quotstart&quot</span><span class="p">)</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>stopSymId  <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblRegisterStaticSymbol">cmSymTblRegisterStaticSymbol</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span><span class="l">&quotstop&quot</span><span class="p">)</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>contSymId  <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblRegisterStaticSymbol">cmSymTblRegisterStaticSymbol</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span><span class="l">&quotcontinue&quot</span><span class="p">)</span><span class="p">;</span>
  
  p<span class="p">-</span><span class="p">&gt</span>mfH        <span class="p">=</span> cmMidiFileNullHandle<span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultStrcz">cmDspSetDefaultStrcz</a><span class="p">(</span> ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kFnMfId">kFnMfId</a><span class="p">,</span>   NULL<span class="p">,</span> <span class="l">&quot&quot</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultSymbol">cmDspSetDefaultSymbol</a><span class="p">(</span>ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kSelMfId">kSelMfId</a><span class="p">,</span>    p<span class="p">-</span><span class="p">&gt</span>stopSymId<span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultInt">cmDspSetDefaultInt</a><span class="p">(</span>   ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kBsiMfId">kBsiMfId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultInt">cmDspSetDefaultInt</a><span class="p">(</span>   ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kEsiMfId">kEsiMfId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>  ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kStatusMfId">kStatusMfId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>  ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kD0MfId">kD0MfId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>  ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kD1MfId">kD1MfId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspMidiFilePlayFree_defn"></a><a name="_cmDspMidiFilePlayFree"></a><span class="f">_cmDspMidiFilePlayFree</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspMidiFilePlay_t">cmDspMidiFilePlay_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspMidiFilePlay_t">cmDspMidiFilePlay_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  <span class="k">if</span><span class="p">(</span> <a href="cmMidiFile_h_0.html#cmMidiFileClose">cmMidiFileClose</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>mfH<span class="p">)</span> <span class="p">)</span>
    <span class="k">return</span> <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>inst<span class="p">-</span><span class="p">&gt</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span> <a href="cmDspClass_h_0.html#kInstFinalFailDspRC">kInstFinalFailDspRC</a><span class="p">,</span> <span class="l">&quotMIDI file close failed.&quot</span><span class="p">)</span><span class="p">;</span>
  <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
<span class="p">}</span>

<span class="c">// return the index of the msg following smpIdx</span>
<span class="k">unsigned</span> <a name="_cmDspMidiFilePlaySeekMsgIdx_defn"></a><a name="_cmDspMidiFilePlaySeekMsgIdx"></a><span class="f">_cmDspMidiFilePlaySeekMsgIdx</span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">unsigned</span> smpIdx <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspMidiFilePlay_t">cmDspMidiFilePlay_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspMidiFilePlay_t">cmDspMidiFilePlay_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> <a href="cmMidiFile_h_0.html#cmMidiFileIsValid">cmMidiFileIsValid</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>mfH<span class="p">)</span> <span class="p">=</span><span class="p">=</span> false <span class="p">)</span>
  <span class="p">{</span>
    <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>inst<span class="p">-</span><span class="p">&gt</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span> <a href="cmDspClass_h_0.html#kInvalidStateDspRC">kInvalidStateDspRC</a><span class="p">,</span><span class="l">&quotThe MIDI file player has not been given a valid MIDI file.&quot</span><span class="p">)</span><span class="p">;</span>
    <span class="k">return</span> <a href="cmGlobal_h_0.html#cmInvalidIdx">cmInvalidIdx</a><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="k">unsigned</span>                 i<span class="p">;</span>
  <span class="k">unsigned</span>                 n     <span class="p">=</span> <a href="cmMidiFile_h_0.html#cmMidiFileMsgCount">cmMidiFileMsgCount</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>mfH<span class="p">)</span><span class="p">;</span>
  <span class="k">const</span> <a href="cmMidiFile_h_0.html#cmMidiTrackMsg_t">cmMidiTrackMsg_t</a><span class="p">*</span><span class="p">*</span> a     <span class="p">=</span> <a href="cmMidiFile_h_0.html#cmMidiFileMsgArray">cmMidiFileMsgArray</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>mfH<span class="p">)</span><span class="p">;</span>
  
  <span class="k">for</span><span class="p">(</span>i<span class="p">=</span><span class="l">0</span><span class="p">;</span> i<span class="p">&lt</span>n<span class="p">;</span> <span class="p">+</span><span class="p">+</span>i<span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <span class="p">(</span>a<span class="p">[</span>i<span class="p">]</span><span class="p">-</span><span class="p">&gt</span>amicro <span class="p">*</span> <a href="cmDspClass_h_0.html#cmDspSampleRate">cmDspSampleRate</a><span class="p">(</span>ctx<span class="p">)</span> <span class="p">/</span> <span class="l">1000000.0</span><span class="p">)</span> <span class="p">&gt</span><span class="p">=</span> smpIdx <span class="p">)</span>
      <span class="k">break</span><span class="p">;</span>
  
  <span class="k">return</span> i<span class="p">=</span><span class="p">=</span>n <span class="p">?</span> <a href="cmGlobal_h_0.html#cmInvalidIdx">cmInvalidIdx</a> <span class="p">:</span> i<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspMidiFilePlayOpen_defn"></a><a name="_cmDspMidiFilePlayOpen"></a><span class="f">_cmDspMidiFilePlayOpen</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>            rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span>      fn <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspStrcz">cmDspStrcz</a><span class="p">(</span>inst<span class="p">,</span><a href="#kFnMfId">kFnMfId</a><span class="p">)</span><span class="p">;</span>
  <a href="#cmDspMidiFilePlay_t">cmDspMidiFilePlay_t</a><span class="p">*</span> p  <span class="p">=</span> <span class="p">(</span><a href="#cmDspMidiFilePlay_t">cmDspMidiFilePlay_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  p<span class="p">-</span><span class="p">&gt</span>errFl <span class="p">=</span> false<span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> fn<span class="p">=</span><span class="p">=</span>NULL <span class="p">|</span><span class="p">|</span> strlen<span class="p">(</span>fn<span class="p">)</span><span class="p">=</span><span class="p">=</span><span class="l">0</span> <span class="p">)</span>
    <span class="k">return</span> rc<span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> <a href="cmMidiFile_h_0.html#cmMidiFileOpen">cmMidiFileOpen</a><span class="p">(</span> ctx<span class="p">-</span><span class="p">&gt</span><a href="cmProcObj_h_0.html#cmCtx">cmCtx</a><span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>mfH<span class="p">,</span> fn <span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmFile_h_0.html#kOkFileRC">kOkFileRC</a> <span class="p">)</span>
    rc <span class="p">=</span> <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>inst<span class="p">-</span><span class="p">&gt</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span> <a href="cmDspClass_h_0.html#kInstResetFailDspRC">kInstResetFailDspRC</a><span class="p">,</span> <span class="l">&quotMIDI file open failed.&quot</span><span class="p">)</span><span class="p">;</span>
  <span class="k">else</span>
  <span class="p">{</span>
    p<span class="p">-</span><span class="p">&gt</span>curMsgIdx <span class="p">=</span> <span class="l">0</span><span class="p">;</span>
    p<span class="p">-</span><span class="p">&gt</span>bsi       <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInt">cmDspInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kBsiMfId">kBsiMfId</a><span class="p">)</span><span class="p">;</span>
    p<span class="p">-</span><span class="p">&gt</span>esi       <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInt">cmDspInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kEsiMfId">kEsiMfId</a><span class="p">)</span><span class="p">;</span>
    p<span class="p">-</span><span class="p">&gt</span>csi       <span class="p">=</span> <span class="l">0</span><span class="p">;</span>
    
    <span class="c">// force the first msg to occurr one quarter note into the file</span>
    <a href="cmMidiFile_h_0.html#cmMidiFileSetDelay">cmMidiFileSetDelay</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>mfH<span class="p">,</span> <a href="cmMidiFile_h_0.html#cmMidiFileTicksPerQN">cmMidiFileTicksPerQN</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>mfH<span class="p">)</span> <span class="p">)</span><span class="p">;</span>
    
    <span class="c">// convert midi msg times to absolute time in samples
    //cmMidiFileTickToSamples(p-&ampgtmfH,<a href="cmDspClass_h_0.html#cmDspSampleRate">cmDspSampleRate</a>(ctx),true);</span>    
    
  <span class="p">}</span>
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspMidiFilePlayReset_defn"></a><a name="_cmDspMidiFilePlayReset"></a><span class="f">_cmDspMidiFilePlayReset</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspApplyAllDefaults">cmDspApplyAllDefaults</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <a href="#_cmDspMidiFilePlayOpen">_cmDspMidiFilePlayOpen</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspMidiFilePlayExec_defn"></a><a name="_cmDspMidiFilePlayExec"></a><span class="f">_cmDspMidiFilePlayExec</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>            rc  <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspMidiFilePlay_t">cmDspMidiFilePlay_t</a><span class="p">*</span> p   <span class="p">=</span> <span class="p">(</span><a href="#cmDspMidiFilePlay_t">cmDspMidiFilePlay_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  <span class="k">unsigned</span>             sPc <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspSamplesPerCycle">cmDspSamplesPerCycle</a><span class="p">(</span>ctx<span class="p">)</span><span class="p">;</span>
  
  
  <span class="k">if</span><span class="p">(</span> <a href="cmDspClass_h_0.html#cmDspSymbol">cmDspSymbol</a><span class="p">(</span>inst<span class="p">,</span><a href="#kSelMfId">kSelMfId</a><span class="p">)</span> <span class="p">!</span><span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>stopSymId <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span> <a href="cmMidiFile_h_0.html#cmMidiFileIsValid">cmMidiFileIsValid</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>mfH<span class="p">)</span> <span class="p">=</span><span class="p">=</span> false <span class="p">)</span>
    <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>errFl<span class="p">=</span><span class="p">=</span>false <span class="p">)</span>
      <span class="p">{</span>
        rc <span class="p">=</span> <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>inst<span class="p">-</span><span class="p">&gt</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span> <a href="cmDspClass_h_0.html#kInvalidStateDspRC">kInvalidStateDspRC</a><span class="p">,</span><span class="l">&quotThe MIDI file player has not been given a valid MIDI file.&quot</span><span class="p">)</span><span class="p">;</span>
        p<span class="p">-</span><span class="p">&gt</span>errFl <span class="p">=</span> true<span class="p">;</span>
      <span class="p">}</span>
      <span class="k">return</span> rc<span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">const</span> <a href="cmMidiFile_h_0.html#cmMidiTrackMsg_t">cmMidiTrackMsg_t</a><span class="p">*</span><span class="p">*</span> mpp   <span class="p">=</span> <a href="cmMidiFile_h_0.html#cmMidiFileMsgArray">cmMidiFileMsgArray</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>mfH<span class="p">)</span><span class="p">;</span>
    <span class="k">unsigned</span>                 msgN  <span class="p">=</span> <a href="cmMidiFile_h_0.html#cmMidiFileMsgCount">cmMidiFileMsgCount</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>mfH<span class="p">)</span><span class="p">;</span>
    
    <span class="k">do</span>
    <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>curMsgIdx <span class="p">&gt</span><span class="p">=</span> msgN <span class="p">)</span>
        <span class="k">break</span><span class="p">;</span>
      
      <span class="k">const</span> <a href="cmMidiFile_h_0.html#cmMidiTrackMsg_t">cmMidiTrackMsg_t</a><span class="p">*</span> mp <span class="p">=</span> mpp<span class="p">[</span>p<span class="p">-</span><span class="p">&gt</span>curMsgIdx<span class="p">]</span><span class="p">;</span>
      
      <span class="c">// convert the absolute time in microseconds to samples</span>
      <span class="k">unsigned</span>  curMsgTimeSmp <span class="p">=</span> round<span class="p">(</span>mp<span class="p">-</span><span class="p">&gt</span>amicro <span class="p">*</span> <a href="cmDspClass_h_0.html#cmDspSampleRate">cmDspSampleRate</a><span class="p">(</span>ctx<span class="p">)</span> <span class="p">/</span> <span class="l">1000000.0</span><span class="p">)</span><span class="p">;</span>
      
      <span class="c">// if this midi event falls inside this execution window</span>
      <span class="k">if</span><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>csi <span class="p">&gt</span> curMsgTimeSmp  <span class="p">|</span><span class="p">|</span>  curMsgTimeSmp <span class="p">&gt</span><span class="p">=</span> <span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>csi <span class="p">+</span> sPc<span class="p">)</span><span class="p">)</span>
        <span class="k">break</span><span class="p">;</span>
      
      <span class="k">switch</span><span class="p">(</span> mp<span class="p">-</span><span class="p">&gt</span>status <span class="p">)</span>
      <span class="p">{</span>
      <span class="k">case</span> <a href="cmMidi_h_0.html#kNoteOffMdId">kNoteOffMdId</a><span class="p">:</span>
      <span class="k">case</span> <a href="cmMidi_h_0.html#kNoteOnMdId">kNoteOnMdId</a><span class="p">:</span>
      <span class="k">case</span> <a href="cmMidi_h_0.html#kCtlMdId">kCtlMdId</a><span class="p">:</span>
        <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span> <a href="#kSmpIdxMfId">kSmpIdxMfId</a><span class="p">,</span> curMsgTimeSmp<span class="p">)</span><span class="p">;</span>
        <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span> <a href="#kD1MfId">kD1MfId</a><span class="p">,</span>     mp<span class="p">-</span><span class="p">&gt</span>u<span class="p">.</span>chMsgPtr<span class="p">-</span><span class="p">&gt</span>d1<span class="p">)</span><span class="p">;</span>
        <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span> <a href="#kD0MfId">kD0MfId</a><span class="p">,</span>     mp<span class="p">-</span><span class="p">&gt</span>u<span class="p">.</span>chMsgPtr<span class="p">-</span><span class="p">&gt</span>d0<span class="p">)</span><span class="p">;</span>
        <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span> <a href="#kStatusMfId">kStatusMfId</a><span class="p">,</span> mp<span class="p">-</span><span class="p">&gt</span>status<span class="p">)</span><span class="p">;</span>
        <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span> <a href="#kIdMfId">kIdMfId</a><span class="p">,</span>     mp<span class="p">-</span><span class="p">&gt</span>uid<span class="p">)</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
      
      p<span class="p">-</span><span class="p">&gt</span>curMsgIdx <span class="p">+</span><span class="p">=</span> <span class="l">1</span><span class="p">;</span>
      
    <span class="p">}</span><span class="k">while</span><span class="p">(</span><span class="l">1</span><span class="p">)</span><span class="p">;</span>
    <span class="p">}</span>
  
  p<span class="p">-</span><span class="p">&gt</span>csi <span class="p">+</span><span class="p">=</span> sPc<span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspMidiFilePlayRecv_defn"></a><a name="_cmDspMidiFilePlayRecv"></a><span class="f">_cmDspMidiFilePlayRecv</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span> 
  <a href="#cmDspMidiFilePlay_t">cmDspMidiFilePlay_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspMidiFilePlay_t">cmDspMidiFilePlay_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
  
  <span class="k">switch</span><span class="p">(</span>evt<span class="p">-</span><span class="p">&gt</span>dstVarId<span class="p">)</span>
  <span class="p">{</span>
  <span class="k">case</span> <a href="#kFnMfId">kFnMfId</a><span class="p">:</span>
    <a href="#_cmDspMidiFilePlayOpen">_cmDspMidiFilePlayOpen</a><span class="p">(</span>ctx<span class="p">,</span> inst <span class="p">)</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kSelMfId">kSelMfId</a><span class="p">:</span>
    <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span> <a href="cmDspClass_h_0.html#cmDspSymbol">cmDspSymbol</a><span class="p">(</span>inst<span class="p">,</span><a href="#kSelMfId">kSelMfId</a><span class="p">)</span><span class="p">=</span><span class="p">=</span>p<span class="p">-</span><span class="p">&gt</span>startSymId <span class="p">)</span> 
      <span class="p">{</span>
        p<span class="p">-</span><span class="p">&gt</span>csi       <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInt">cmDspInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kBsiMfId">kBsiMfId</a><span class="p">)</span><span class="p">;</span>
        p<span class="p">-</span><span class="p">&gt</span>curMsgIdx <span class="p">=</span> <a href="#_cmDspMidiFilePlaySeekMsgIdx">_cmDspMidiFilePlaySeekMsgIdx</a><span class="p">(</span>ctx<span class="p">,</span> inst<span class="p">,</span> p<span class="p">-</span><span class="p">&gt</span>csi <span class="p">)</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    
  <span class="p">}</span>
  <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> <a name="cmMidiFilePlayClassCons_defn"></a><span class="f"><a href="cmDspKr_h_0.html#cmMidiFilePlayClassCons">cmMidiFilePlayClassCons</a></span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspClassSetup">cmDspClassSetup</a><span class="p">(</span><span class="p">&amp</span>_cmMidiFilePlayDC<span class="p">,</span>ctx<span class="p">,</span><span class="l">&quotMidiFilePlay&quot</span><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspMidiFilePlayAlloc">_cmDspMidiFilePlayAlloc</a><span class="p">,</span>
  <a href="#_cmDspMidiFilePlayFree">_cmDspMidiFilePlayFree</a><span class="p">,</span>
  <a href="#_cmDspMidiFilePlayReset">_cmDspMidiFilePlayReset</a><span class="p">,</span>
  <a href="#_cmDspMidiFilePlayExec">_cmDspMidiFilePlayExec</a><span class="p">,</span>
  <a href="#_cmDspMidiFilePlayRecv">_cmDspMidiFilePlayRecv</a><span class="p">,</span>
  NULL<span class="p">,</span>NULL<span class="p">,</span>
  <span class="l">&quotMIDI file player.&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>_cmMidiFilePlayDC<span class="p">;</span>
<span class="p">}</span>

<span class="c"><hr id="hr1"></span></pre>
</div>
<div class="cod"><div class="blk_title">cmDspScFol : MIDI performance score follower.</div><pre><a name="cmDspScFol"></a>
<span class="k">enum</span>
<span class="p">{</span>
  <a name="kFnSfId"></a><span class="e">kFnSfId</span><span class="p">,</span>
  <a name="kBufCntSfId"></a><span class="e">kBufCntSfId</span><span class="p">,</span>
  <a name="kMaxWndCntSfId"></a><span class="e">kMaxWndCntSfId</span><span class="p">,</span>
  <a name="kMinVelSfId"></a><span class="e">kMinVelSfId</span><span class="p">,</span>
  <a name="kMeasflSfId"></a><span class="e">kMeasflSfId</span><span class="p">,</span>
  <a name="kIndexSfId"></a><span class="e">kIndexSfId</span><span class="p">,</span>
  <a name="kMuidSfId"></a><span class="e">kMuidSfId</span><span class="p">,</span>
  <a name="kStatusSfId"></a><span class="e">kStatusSfId</span><span class="p">,</span>
  <a name="kD0SfId"></a><span class="e">kD0SfId</span><span class="p">,</span>
  <a name="kD1SfId"></a><span class="e">kD1SfId</span><span class="p">,</span>
  <a name="kSmpIdxSfId"></a><span class="e">kSmpIdxSfId</span><span class="p">,</span>
  <a name="kCmdSfId"></a><span class="e">kCmdSfId</span><span class="p">,</span>
  <a name="kOutSfId"></a><span class="e">kOutSfId</span><span class="p">,</span>
  <a name="kRecentSfId"></a><span class="e">kRecentSfId</span><span class="p">,</span>
  <a name="kVlocSfId"></a><span class="e">kVlocSfId</span><span class="p">,</span>
  <a name="kVtypSfId"></a><span class="e">kVtypSfId</span><span class="p">,</span>
  <a name="kVvalSfId"></a><span class="e">kVvalSfId</span><span class="p">,</span>
  <a name="kVcostSfId"></a><span class="e">kVcostSfId</span><span class="p">,</span>
  <a name="kSymSfId"></a><span class="e">kSymSfId</span>
<span class="p">}</span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a> _cmScFolDC<span class="p">;</span>
<span class="k">struct</span> <span class="i"><a href="#cmDspScFol_str">cmDspScFol_str</a></span><span class="p">;</span>

<a name="cmDspScFolCbArg_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span>            <a name="cmDspScFolCbArg_t.ctx"></a><span class="i">ctx</span><span class="p">;</span>
  <span class="k">struct</span> <a href="#cmDspScFol_str">cmDspScFol_str</a><span class="p">*</span> <a name="cmDspScFolCbArg_t.sfp"></a><span class="i">sfp</span><span class="p">;</span>
<span class="p">}</span> <span class="t"><a href="#cmDspScFolCbArg_t">cmDspScFolCbArg_t</a></span><span class="p">;</span>

<a name="cmDspScFol_t"></a><span class="k">typedef</span> <span class="k">struct</span> <a name="cmDspScFol_str"></a>cmDspScFol_str
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a>       <a name="cmDspScFol_t.inst"></a><span class="i">inst</span><span class="p">;</span>
  <a href="cmProc4_h_0.html#cmScMatcher">cmScMatcher</a><span class="p">*</span>      <a name="cmDspScFol_t.sfp"></a><span class="i">sfp</span><span class="p">;</span>
  <a href="cmProc4_h_0.html#cmScMeas">cmScMeas</a><span class="p">*</span>         <a name="cmDspScFol_t.smp"></a><span class="i">smp</span><span class="p">;</span>
  <a href="cmScore_h_0.html#cmScH_t">cmScH_t</a>           <a name="cmDspScFol_t.scH"></a><span class="i">scH</span><span class="p">;</span>
  <a href="#cmDspScFolCbArg_t">cmDspScFolCbArg_t</a> <a name="cmDspScFol_t.arg"></a><span class="i">arg</span><span class="p">;</span>
  <span class="k">unsigned</span>          <a name="cmDspScFol_t.printSymId"></a><span class="i">printSymId</span><span class="p">;</span>
  <span class="k">unsigned</span>          <a name="cmDspScFol_t.quietSymId"></a><span class="i">quietSymId</span><span class="p">;</span>
  <span class="k">unsigned</span>          <a name="cmDspScFol_t.maxScLocIdx"></a><span class="i">maxScLocIdx</span><span class="p">;</span>
  <span class="k">bool</span>              <a name="cmDspScFol_t.liveFl"></a><span class="i">liveFl</span><span class="p">;</span>
<span class="p">}</span> <span class="t"><a href="#cmDspScFol_t">cmDspScFol_t</a></span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span>  <a name="_cmDspScFolAlloc_defn"></a><a name="_cmDspScFolAlloc"></a><span class="f">_cmDspScFolAlloc</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> classPtr<span class="p">,</span> <span class="k">unsigned</span> storeSymId<span class="p">,</span> <span class="k">unsigned</span> instSymId<span class="p">,</span> <span class="k">unsigned</span> id<span class="p">,</span> <span class="k">unsigned</span> va_cnt<span class="p">,</span> va_list vl <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspVarArg_t">cmDspVarArg_t</a> args<span class="p">[</span><span class="p">]</span> <span class="p">=</span>
  <span class="p">{</span>
    <span class="p">{</span> <span class="l">&quotfn&quot</span><span class="p">,</span>    <a href="#kFnSfId">kFnSfId</a><span class="p">,</span>       <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kStrzDsvFl">kStrzDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kReqArgDsvFl">kReqArgDsvFl</a><span class="p">,</span>     <span class="l">&quotScore file.&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotbufcnt&quot</span><span class="p">,</span><a href="#kBufCntSfId">kBufCntSfId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span>     <span class="l">&quotEvent buffer element count.&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotwndcnt&quot</span><span class="p">,</span><a href="#kMaxWndCntSfId">kMaxWndCntSfId</a><span class="p">,</span><span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span>     <span class="l">&quotMaximum window length.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotminvel&quot</span><span class="p">,</span><a href="#kMinVelSfId">kMinVelSfId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span>     <span class="l">&quotMinimum velocity.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotmeasfl&quot</span><span class="p">,</span><a href="#kMeasflSfId">kMeasflSfId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kBoolDsvFl">kBoolDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span>     <span class="l">&quotEnable measurements&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotindex&quot</span><span class="p">,</span> <a href="#kIndexSfId">kIndexSfId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                    <span class="l">&quotTracking start location.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotmuid&quot</span><span class="p">,</span>  <a href="#kMuidSfId">kMuidSfId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                    <span class="l">&quotMIDI msg file unique id&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotstatus&quot</span><span class="p">,</span><a href="#kStatusSfId">kStatusSfId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                    <span class="l">&quotMIDI status byte&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotd0&quot</span><span class="p">,</span>    <a href="#kD0SfId">kD0SfId</a><span class="p">,</span>       <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                    <span class="l">&quotMIDI data byte 0&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotd1&quot</span><span class="p">,</span>    <a href="#kD1SfId">kD1SfId</a><span class="p">,</span>       <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                    <span class="l">&quotMIDI data byte 1&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotsmpidx&quot</span><span class="p">,</span><a href="#kSmpIdxSfId">kSmpIdxSfId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                    <span class="l">&quotMIDI time tag as a sample index&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotcmd&quot</span><span class="p">,</span>   <a href="#kCmdSfId">kCmdSfId</a><span class="p">,</span>      <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kSymDsvFl">kSymDsvFl</a><span class="p">,</span>                     <span class="l">&quotCommand input: print | quiet&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotout&quot</span><span class="p">,</span>   <a href="#kOutSfId">kOutSfId</a><span class="p">,</span>      <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a><span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                    <span class="l">&quotMaximum score location index.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotrecent&quot</span><span class="p">,</span><a href="#kRecentSfId">kRecentSfId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a><span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                    <span class="l">&quotMost recent score location index.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotvloc&quot</span><span class="p">,</span>  <a href="#kVlocSfId">kVlocSfId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a><span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                    <span class="l">&quotScore location at which the variable value becomes active.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotvtyp&quot</span><span class="p">,</span>  <a href="#kVtypSfId">kVtypSfId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a><span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                    <span class="l">&quotVariable type: 0=even=kEvenVarScId 1=dyn=kDynVarScId 2=tempo=kTempoVarScId.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotvval&quot</span><span class="p">,</span>  <a href="#kVvalSfId">kVvalSfId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a><span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a><span class="p">,</span>                  <span class="l">&quotVariable value.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotvcost&quot</span><span class="p">,</span> <a href="#kVcostSfId">kVcostSfId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a><span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a><span class="p">,</span>                  <span class="l">&quotVariable match cost value.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotsym&quot</span><span class="p">,</span>   <a href="#kSymSfId">kSymSfId</a><span class="p">,</span>      <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a><span class="p">|</span> <a href="cmDspValue_h_0.html#kSymDsvFl">kSymDsvFl</a><span class="p">,</span>                     <span class="l">&quotSymbol associated with a global variable which has changed value.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> NULL<span class="p">,</span>    <span class="l">0</span><span class="p">,</span>             <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> NULL <span class="p">}</span>
  <span class="p">}</span><span class="p">;</span>
  
  <a href="#cmDspScFol_t">cmDspScFol_t</a><span class="p">*</span> p<span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span><span class="p">(</span>p <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstAlloc">cmDspInstAlloc</a><span class="p">(</span><a href="#cmDspScFol_t">cmDspScFol_t</a><span class="p">,</span>ctx<span class="p">,</span>classPtr<span class="p">,</span>args<span class="p">,</span>instSymId<span class="p">,</span>id<span class="p">,</span>storeSymId<span class="p">,</span>va_cnt<span class="p">,</span>vl<span class="p">)</span><span class="p">)</span> <span class="p">=</span><span class="p">=</span> NULL <span class="p">)</span>
    <span class="k">return</span> NULL<span class="p">;</span>
  
  p<span class="p">-</span><span class="p">&gt</span>sfp        <span class="p">=</span> <a href="cmProc4_h_0.html#cmScMatcherAlloc">cmScMatcherAlloc</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>cmProcCtx<span class="p">,</span> NULL<span class="p">,</span> <span class="l">0</span><span class="p">,</span> cmScNullHandle<span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> NULL<span class="p">,</span> NULL <span class="p">)</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>smp        <span class="p">=</span> <a href="cmProc4_h_0.html#cmScMeasAlloc">cmScMeasAlloc</a><span class="p">(</span>   ctx<span class="p">-</span><span class="p">&gt</span>cmProcCtx<span class="p">,</span> NULL<span class="p">,</span> cmScNullHandle<span class="p">,</span> <span class="l">0</span><span class="p">,</span> NULL<span class="p">,</span> <span class="l">0</span> <span class="p">)</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>printSymId <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblRegisterStaticSymbol">cmSymTblRegisterStaticSymbol</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span><span class="l">&quotprint&quot</span><span class="p">)</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>quietSymId <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblRegisterStaticSymbol">cmSymTblRegisterStaticSymbol</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span><span class="l">&quotquiet&quot</span><span class="p">)</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>maxScLocIdx<span class="p">=</span> <a href="cmGlobal_h_0.html#cmInvalidIdx">cmInvalidIdx</a><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>   ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kBufCntSfId">kBufCntSfId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">7</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>   ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kMaxWndCntSfId">kMaxWndCntSfId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span>    <span class="l">10</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>   ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kMinVelSfId">kMinVelSfId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">5</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultBool">cmDspSetDefaultBool</a><span class="p">(</span>   ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kMeasflSfId">kMeasflSfId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>   ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kIndexSfId">kIndexSfId</a><span class="p">,</span>      <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">)</span><span class="p">;</span>  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>   ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kOutSfId">kOutSfId</a><span class="p">,</span>        <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>   ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kRecentSfId">kRecentSfId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">)</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultSymbol">cmDspSetDefaultSymbol</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kCmdSfId">kCmdSfId</a><span class="p">,</span> p<span class="p">-</span><span class="p">&gt</span>quietSymId <span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspScFolFree_defn"></a><a name="_cmDspScFolFree"></a><span class="f">_cmDspScFolFree</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspScFol_t">cmDspScFol_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspScFol_t">cmDspScFol_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  <a href="cmProc4_h_0.html#cmScMatcherFree">cmScMatcherFree</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>sfp<span class="p">)</span><span class="p">;</span>
  <a href="cmProc4_h_0.html#cmScMeasFree">cmScMeasFree</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>smp<span class="p">)</span><span class="p">;</span>
  <a href="cmScore_h_0.html#cmScoreFinalize">cmScoreFinalize</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>scH<span class="p">)</span><span class="p">;</span>
  <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
<span class="p">}</span>

<span class="c">// This is a callback function from <a href="cmProc4_h_0.html#cmScMatcherExec">cmScMatcherExec</a>() which is called when
// this cmDspFol object receives a new score location index.</span>
<span class="k">void</span> <a name="_cmScFolMatcherCb_defn"></a><a name="_cmScFolMatcherCb"></a><span class="f">_cmScFolMatcherCb</span><span class="p">(</span> <a href="cmProc4_h_0.html#cmScMatcher">cmScMatcher</a><span class="p">*</span> p<span class="p">,</span> <span class="k">void</span><span class="p">*</span> arg<span class="p">,</span> <a href="cmProc4_h_0.html#cmScMatcherResult_t">cmScMatcherResult_t</a><span class="p">*</span> rp <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspScFolCbArg_t">cmDspScFolCbArg_t</a><span class="p">*</span> ap <span class="p">=</span> <span class="p">(</span><a href="#cmDspScFolCbArg_t">cmDspScFolCbArg_t</a><span class="p">*</span><span class="p">)</span>arg<span class="p">;</span>
  
  
  <span class="k">if</span><span class="p">(</span> <a href="cmProc4_h_0.html#cmScMeasExec">cmScMeasExec</a><span class="p">(</span>ap<span class="p">-</span><span class="p">&gt</span>sfp<span class="p">-</span><span class="p">&gt</span>smp<span class="p">,</span> rp<span class="p">-</span><span class="p">&gt</span>mni<span class="p">,</span> rp<span class="p">-</span><span class="p">&gt</span>locIdx<span class="p">,</span> rp<span class="p">-</span><span class="p">&gt</span>scEvtIdx<span class="p">,</span> rp<span class="p">-</span><span class="p">&gt</span>flags<span class="p">,</span> rp<span class="p">-</span><span class="p">&gt</span>smpIdx<span class="p">,</span> rp<span class="p">-</span><span class="p">&gt</span>pitch<span class="p">,</span> rp<span class="p">-</span><span class="p">&gt</span>vel <span class="p">)</span> <span class="p">=</span><span class="p">=</span> <a href="cmGlobal_h_0.html#cmOkRC">cmOkRC</a> <span class="p">)</span>
  <span class="p">{</span>
    <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span>  inst <span class="p">=</span> <span class="p">&amp</span><span class="p">(</span>ap<span class="p">-</span><span class="p">&gt</span>sfp<span class="p">-</span><span class="p">&gt</span>inst<span class="p">)</span><span class="p">;</span>
    
    <span class="c">// send 'set' values that were calculated on the previous call to <a href="cmProc4_h_0.html#cmScMeasExec">cmScMeasExec</a>()</span>
    <span class="k">unsigned</span> i<span class="p">;</span>
    <span class="k">for</span><span class="p">(</span>i<span class="p">=</span>ap<span class="p">-</span><span class="p">&gt</span>sfp<span class="p">-</span><span class="p">&gt</span>smp<span class="p">-</span><span class="p">&gt</span>vsi<span class="p">;</span> i<span class="p">&lt</span>ap<span class="p">-</span><span class="p">&gt</span>sfp<span class="p">-</span><span class="p">&gt</span>smp<span class="p">-</span><span class="p">&gt</span>nsi<span class="p">;</span> <span class="p">+</span><span class="p">+</span>i<span class="p">)</span>
      <span class="k">if</span><span class="p">(</span>ap<span class="p">-</span><span class="p">&gt</span>sfp<span class="p">-</span><span class="p">&gt</span>smp<span class="p">-</span><span class="p">&gt</span>set<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>value <span class="p">!</span><span class="p">=</span> DBL_MAX <span class="p">)</span>
    <span class="p">{</span>
      
      <span class="c">//        switch( ap-&ampgtsfp-&ampgtsmp-&ampgtset[i].sp-&ampgtvarId )
      //        {
      //          case <a href="cmScore_h_0.html#kEvenVarScId">kEvenVarScId</a>:
      //            <a href="cmDspClass_h_0.html#cmDspSetDouble">cmDspSetDouble</a>(ap-&ampgtctx,inst,kEvenSfId,ap-&ampgtsfp-&ampgtsmp-&ampgtset[i].value);
      //            break;
      //
      //          case <a href="cmScore_h_0.html#kDynVarScId">kDynVarScId</a>:
      //            <a href="cmDspClass_h_0.html#cmDspSetDouble">cmDspSetDouble</a>(ap-&ampgtctx,inst,kDynSfId,ap-&ampgtsfp-&ampgtsmp-&ampgtset[i].value);
      //            break;
      //
      //          case <a href="cmScore_h_0.html#kTempoVarScId">kTempoVarScId</a>:
      //            <a href="cmDspClass_h_0.html#cmDspSetDouble">cmDspSetDouble</a>(ap-&ampgtctx,inst,kTempoSfId,ap-&ampgtsfp-&ampgtsmp-&ampgtset[i].value);
      //            break;
      //
      //          default:
      //            { assert(0); }
      //        }           
      //
      //        <a href="cmDspClass_h_0.html#cmDspSetDouble">cmDspSetDouble</a>(ap-&ampgtctx,inst,kCostSfId,ap-&ampgtsfp-&ampgtsmp-&ampgtset[i].match_cost);</span>      
      
      <span class="c">// Set the values in the global variable storage</span>
      <a href="cmDspValue_h_0.html#cmDspValue_t">cmDspValue_t</a> vv<span class="p">,</span>cv<span class="p">;</span>
      <span class="k">unsigned</span>     j<span class="p">;</span>
      <a href="cmDspValue_h_0.html#cmDsvSetDouble">cmDsvSetDouble</a><span class="p">(</span><span class="p">&amp</span>vv<span class="p">,</span>ap<span class="p">-</span><span class="p">&gt</span>sfp<span class="p">-</span><span class="p">&gt</span>smp<span class="p">-</span><span class="p">&gt</span>set<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>value<span class="p">)</span><span class="p">;</span>
      <a href="cmDspValue_h_0.html#cmDsvSetDouble">cmDsvSetDouble</a><span class="p">(</span><span class="p">&amp</span>cv<span class="p">,</span>ap<span class="p">-</span><span class="p">&gt</span>sfp<span class="p">-</span><span class="p">&gt</span>smp<span class="p">-</span><span class="p">&gt</span>set<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>match_cost<span class="p">)</span><span class="p">;</span>
      
      
      <span class="k">for</span><span class="p">(</span>j<span class="p">=</span><span class="l">0</span><span class="p">;</span> j<span class="p">&lt</span>ap<span class="p">-</span><span class="p">&gt</span>sfp<span class="p">-</span><span class="p">&gt</span>smp<span class="p">-</span><span class="p">&gt</span>set<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>sp<span class="p">-</span><span class="p">&gt</span>sectCnt<span class="p">;</span> <span class="p">+</span><span class="p">+</span>j<span class="p">)</span>
      <span class="p">{</span>
        <a href="cmDspStore_h_0.html#cmDspStoreSetValueViaSym">cmDspStoreSetValueViaSym</a><span class="p">(</span>ap<span class="p">-</span><span class="p">&gt</span>ctx<span class="p">-</span><span class="p">&gt</span>dsH<span class="p">,</span> ap<span class="p">-</span><span class="p">&gt</span>sfp<span class="p">-</span><span class="p">&gt</span>smp<span class="p">-</span><span class="p">&gt</span>set<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>sp<span class="p">-</span><span class="p">&gt</span>symArray<span class="p">[</span>j<span class="p">]</span><span class="p">,</span> <span class="p">&amp</span>vv <span class="p">)</span><span class="p">;</span>
        <a href="cmDspStore_h_0.html#cmDspStoreSetValueViaSym">cmDspStoreSetValueViaSym</a><span class="p">(</span>ap<span class="p">-</span><span class="p">&gt</span>ctx<span class="p">-</span><span class="p">&gt</span>dsH<span class="p">,</span> ap<span class="p">-</span><span class="p">&gt</span>sfp<span class="p">-</span><span class="p">&gt</span>smp<span class="p">-</span><span class="p">&gt</span>set<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>sp<span class="p">-</span><span class="p">&gt</span>costSymArray<span class="p">[</span>j<span class="p">]</span><span class="p">,</span> <span class="p">&amp</span>cv <span class="p">)</span><span class="p">;</span>
        
        <a href="cmDspClass_h_0.html#cmDspSetSymbol">cmDspSetSymbol</a><span class="p">(</span>ap<span class="p">-</span><span class="p">&gt</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kSymSfId">kSymSfId</a><span class="p">,</span>ap<span class="p">-</span><span class="p">&gt</span>sfp<span class="p">-</span><span class="p">&gt</span>smp<span class="p">-</span><span class="p">&gt</span>set<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>sp<span class="p">-</span><span class="p">&gt</span>symArray<span class="p">[</span>j<span class="p">]</span><span class="p">)</span><span class="p">;</span>
        <a href="cmDspClass_h_0.html#cmDspSetSymbol">cmDspSetSymbol</a><span class="p">(</span>ap<span class="p">-</span><span class="p">&gt</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kSymSfId">kSymSfId</a><span class="p">,</span>ap<span class="p">-</span><span class="p">&gt</span>sfp<span class="p">-</span><span class="p">&gt</span>smp<span class="p">-</span><span class="p">&gt</span>set<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>sp<span class="p">-</span><span class="p">&gt</span>costSymArray<span class="p">[</span>j<span class="p">]</span><span class="p">)</span><span class="p">;</span>
        
        <span class="k">if</span><span class="p">(</span> <a href="cmDspClass_h_0.html#cmDspBool">cmDspBool</a><span class="p">(</span>inst<span class="p">,</span><a href="#kMeasflSfId">kMeasflSfId</a><span class="p">)</span> <span class="p">)</span>
        <span class="p">{</span>
          <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>   ap<span class="p">-</span><span class="p">&gt</span>ctx<span class="p">,</span> inst<span class="p">,</span> <a href="#kVlocSfId">kVlocSfId</a><span class="p">,</span>  ap<span class="p">-</span><span class="p">&gt</span>sfp<span class="p">-</span><span class="p">&gt</span>smp<span class="p">-</span><span class="p">&gt</span>set<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>sp<span class="p">-</span><span class="p">&gt</span>sectArray<span class="p">[</span>j<span class="p">]</span><span class="p">-</span><span class="p">&gt</span>locPtr<span class="p">-</span><span class="p">&gt</span>index<span class="p">)</span><span class="p">;</span>
          <a href="cmDspClass_h_0.html#cmDspSetDouble">cmDspSetDouble</a><span class="p">(</span> ap<span class="p">-</span><span class="p">&gt</span>ctx<span class="p">,</span> inst<span class="p">,</span> <a href="#kVvalSfId">kVvalSfId</a><span class="p">,</span>  ap<span class="p">-</span><span class="p">&gt</span>sfp<span class="p">-</span><span class="p">&gt</span>smp<span class="p">-</span><span class="p">&gt</span>set<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>value<span class="p">)</span><span class="p">;</span>
          <a href="cmDspClass_h_0.html#cmDspSetDouble">cmDspSetDouble</a><span class="p">(</span> ap<span class="p">-</span><span class="p">&gt</span>ctx<span class="p">,</span> inst<span class="p">,</span> <a href="#kVcostSfId">kVcostSfId</a><span class="p">,</span> ap<span class="p">-</span><span class="p">&gt</span>sfp<span class="p">-</span><span class="p">&gt</span>smp<span class="p">-</span><span class="p">&gt</span>set<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>match_cost<span class="p">)</span><span class="p">;</span>
          <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>   ap<span class="p">-</span><span class="p">&gt</span>ctx<span class="p">,</span> inst<span class="p">,</span> <a href="#kVtypSfId">kVtypSfId</a><span class="p">,</span>  ap<span class="p">-</span><span class="p">&gt</span>sfp<span class="p">-</span><span class="p">&gt</span>smp<span class="p">-</span><span class="p">&gt</span>set<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>sp<span class="p">-</span><span class="p">&gt</span>varId<span class="p">)</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      
      
    <span class="p">}</span>
    
    <span class="c">//    // trigger 'section' starts 
    //    for(i=ap-&ampgtsfp-&ampgtsmp-&ampgtvsli; i&ampltap-&ampgtsfp-&ampgtsmp-&ampgtnsli; ++i)
    //    {
    //      const <a href="cmScore_h_0.html#cmScoreLoc_t">cmScoreLoc_t</a>* locPtr = <a href="cmScore_h_0.html#cmScoreLoc">cmScoreLoc</a>(ap-&ampgtsfp-&ampgtsmp-&ampgtmp-&ampgtscH,i);
    //      if( locPtr-&ampgtbegSectPtr != NULL )
    //        <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a>(ap-&ampgtctx,inst,kSectIndexSfId,locPtr-&ampgtbegSectPtr-&ampgtindex);
    //    }</span>    
  <span class="p">}</span>
<span class="p">}</span>


<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspScFolOpenScore_defn"></a><a name="_cmDspScFolOpenScore"></a><span class="f">_cmDspScFolOpenScore</span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>       rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspScFol_t">cmDspScFol_t</a><span class="p">*</span>   p  <span class="p">=</span> <span class="p">(</span><a href="#cmDspScFol_t">cmDspScFol_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> fn<span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span><span class="p">(</span>fn <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspStrcz">cmDspStrcz</a><span class="p">(</span>inst<span class="p">,</span><a href="#kFnSfId">kFnSfId</a><span class="p">)</span><span class="p">)</span> <span class="p">=</span><span class="p">=</span> NULL <span class="p">|</span><span class="p">|</span> strlen<span class="p">(</span>fn<span class="p">)</span><span class="p">=</span><span class="p">=</span><span class="l">0</span> <span class="p">)</span>
    <span class="k">return</span> <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>inst<span class="p">-</span><span class="p">&gt</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span> <a href="cmDspClass_h_0.html#kInvalidArgDspRC">kInvalidArgDspRC</a><span class="p">,</span> <span class="l">&quotNo score file name supplied.&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> <a href="cmScore_h_0.html#cmScoreInitialize">cmScoreInitialize</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span><a href="cmProcObj_h_0.html#cmCtx">cmCtx</a><span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>scH<span class="p">,</span> fn<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspSampleRate">cmDspSampleRate</a><span class="p">(</span>ctx<span class="p">)</span><span class="p">,</span> NULL<span class="p">,</span> <span class="l">0</span><span class="p">,</span> NULL<span class="p">,</span> NULL<span class="p">,</span> ctx<span class="p">-</span><span class="p">&gt</span>stH <span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmScore_h_0.html#kOkScRC">kOkScRC</a> <span class="p">)</span>
    <span class="k">return</span> <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>inst<span class="p">-</span><span class="p">&gt</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span> <a href="cmDspClass_h_0.html#kSubSysFailDspRC">kSubSysFailDspRC</a><span class="p">,</span> <span class="l">&quotUnable to open the score '%s'.&quot</span><span class="p">,</span>fn<span class="p">)</span><span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> <a href="cmScore_h_0.html#cmScoreIsValid">cmScoreIsValid</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>scH<span class="p">)</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">unsigned</span><span class="p">*</span>       dynRefArray <span class="p">=</span> NULL<span class="p">;</span>
    <span class="k">unsigned</span>        dynRefCnt   <span class="p">=</span> <span class="l">0</span><span class="p">;</span>
    
    <span class="c">// initialize the <a href="cmProc4_h_0.html#cmScMatcher">cmScMatcher</a></span>
    <span class="k">if</span><span class="p">(</span> <a href="cmProc4_h_0.html#cmScMatcherInit">cmScMatcherInit</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>sfp<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspSampleRate">cmDspSampleRate</a><span class="p">(</span>ctx<span class="p">)</span><span class="p">,</span>  p<span class="p">-</span><span class="p">&gt</span>scH<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kMaxWndCntSfId">kMaxWndCntSfId</a><span class="p">)</span><span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kBufCntSfId">kBufCntSfId</a><span class="p">)</span><span class="p">,</span> <a href="#_cmScFolMatcherCb">_cmScFolMatcherCb</a><span class="p">,</span> p<span class="p">-</span><span class="p">&gt</span>smp <span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmGlobal_h_0.html#cmOkRC">cmOkRC</a> <span class="p">)</span>
      rc <span class="p">=</span> <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>inst<span class="p">-</span><span class="p">&gt</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span> <a href="cmDspClass_h_0.html#kSubSysFailDspRC">kSubSysFailDspRC</a><span class="p">,</span> <span class="l">&quotInternal score follower allocation failed.&quot</span><span class="p">)</span><span class="p">;</span>
    
    <span class="c">// read the dynamics reference array</span>
    <span class="k">if</span><span class="p">(</span> <a href="cmDspSys_h_0.html#cmDspRsrcUIntArray">cmDspRsrcUIntArray</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>dspH<span class="p">,</span> <span class="p">&amp</span>dynRefCnt<span class="p">,</span> <span class="p">&amp</span>dynRefArray<span class="p">,</span> <span class="l">&quotdynRef&quot</span><span class="p">,</span> NULL <span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a> <span class="p">)</span>
    <span class="p">{</span>
      rc <span class="p">=</span> <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>inst<span class="p">-</span><span class="p">&gt</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span> <a href="cmDspClass_h_0.html#kRsrcNotFoundDspRC">kRsrcNotFoundDspRC</a><span class="p">,</span> <span class="l">&quotThe dynamics reference array resource was not found.&quot</span><span class="p">)</span><span class="p">;</span>
      goto errLabel<span class="p">;</span>
    <span class="p">}</span>
    
    <span class="c">// initialize the <a href="cmProc4_h_0.html#cmScMeas">cmScMeas</a> object.</span>
    <span class="k">if</span><span class="p">(</span> <a href="cmProc4_h_0.html#cmScMeasInit">cmScMeasInit</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>smp<span class="p">,</span> p<span class="p">-</span><span class="p">&gt</span>scH<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspSampleRate">cmDspSampleRate</a><span class="p">(</span>ctx<span class="p">)</span><span class="p">,</span> dynRefArray<span class="p">,</span> dynRefCnt <span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmGlobal_h_0.html#cmOkRC">cmOkRC</a> <span class="p">)</span>
      rc <span class="p">=</span> <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>inst<span class="p">-</span><span class="p">&gt</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span> <a href="cmDspClass_h_0.html#kSubSysFailDspRC">kSubSysFailDspRC</a><span class="p">,</span> <span class="l">&quotInternal scMeas object initialization failed.&quot</span><span class="p">)</span><span class="p">;</span>
    
  <span class="p">}</span>
  
  errLabel<span class="p">:</span>
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspScFolReset_defn"></a><a name="_cmDspScFolReset"></a><span class="f">_cmDspScFolReset</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>     rc<span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="p">(</span>rc <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspApplyAllDefaults">cmDspApplyAllDefaults</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a> <span class="p">)</span>
    <span class="k">return</span> rc<span class="p">;</span>
  
  <span class="k">return</span> <a href="#_cmDspScFolOpenScore">_cmDspScFolOpenScore</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">;</span>
<span class="p">}</span>


<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspScFolRecv_defn"></a><a name="_cmDspScFolRecv"></a><span class="f">_cmDspScFolRecv</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span> 
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>     rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspScFol_t">cmDspScFol_t</a><span class="p">*</span> p  <span class="p">=</span> <span class="p">(</span><a href="#cmDspScFol_t">cmDspScFol_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span><span class="p">(</span>rc <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">)</span> <span class="p">=</span><span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a> <span class="p">&amp</span><span class="p">&amp</span> p<span class="p">-</span><span class="p">&gt</span>sfp <span class="p">!</span><span class="p">=</span> NULL <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">switch</span><span class="p">(</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">)</span>
    <span class="p">{</span>
    <span class="k">case</span> <a href="#kIndexSfId">kIndexSfId</a><span class="p">:</span>
      <span class="k">if</span><span class="p">(</span> <a href="cmScore_h_0.html#cmScoreIsValid">cmScoreIsValid</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>scH<span class="p">)</span> <span class="p">)</span>
      <span class="p">{</span>
        p<span class="p">-</span><span class="p">&gt</span>maxScLocIdx <span class="p">=</span> <a href="cmGlobal_h_0.html#cmInvalidIdx">cmInvalidIdx</a><span class="p">;</span>
        
        <span class="k">if</span><span class="p">(</span> <a href="cmProc4_h_0.html#cmScMeasReset">cmScMeasReset</a><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>smp <span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmGlobal_h_0.html#cmOkRC">cmOkRC</a> <span class="p">)</span>
          <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>inst<span class="p">-</span><span class="p">&gt</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span> <a href="cmDspClass_h_0.html#kSubSysFailDspRC">kSubSysFailDspRC</a><span class="p">,</span> <span class="l">&quotScore measure unit reset to score index '%i' failed.&quot</span><span class="p">)</span><span class="p">;</span>
        
        <span class="k">if</span><span class="p">(</span> <a href="cmProc4_h_0.html#cmScMatcherReset">cmScMatcherReset</a><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>sfp<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kIndexSfId">kIndexSfId</a><span class="p">)</span> <span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmGlobal_h_0.html#cmOkRC">cmOkRC</a> <span class="p">)</span>
          <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>inst<span class="p">-</span><span class="p">&gt</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span> <a href="cmDspClass_h_0.html#kSubSysFailDspRC">kSubSysFailDspRC</a><span class="p">,</span> <span class="l">&quotScore follower reset to score index '%i' failed.&quot</span><span class="p">)</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">break</span><span class="p">;</span>
      
    <span class="k">case</span> <a href="#kStatusSfId">kStatusSfId</a><span class="p">:</span>
      <span class="k">if</span><span class="p">(</span> <a href="cmScore_h_0.html#cmScoreIsValid">cmScoreIsValid</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>scH<span class="p">)</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="k">unsigned</span> scLocIdx <span class="p">=</span> <a href="cmGlobal_h_0.html#cmInvalidIdx">cmInvalidIdx</a><span class="p">;</span>
        
        <span class="c">// setup the <a href="cmProc4_h_0.html#cmScMeas">cmScMeas</a>() callback arg.</span>
        p<span class="p">-</span><span class="p">&gt</span>arg<span class="p">.</span>ctx    <span class="p">=</span> ctx<span class="p">;</span>
        p<span class="p">-</span><span class="p">&gt</span>arg<span class="p">.</span>sfp    <span class="p">=</span> p<span class="p">;</span>
        p<span class="p">-</span><span class="p">&gt</span>sfp<span class="p">-</span><span class="p">&gt</span>cbArg <span class="p">=</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>arg<span class="p">;</span>
        
        <span class="c">// this call may result in a callback to <a href="#_cmScFolMatcherCb">_cmScFolMatcherCb</a>()</span>
        <span class="k">if</span><span class="p">(</span> <a href="cmProc4_h_0.html#cmScMatcherExec">cmScMatcherExec</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>sfp<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kSmpIdxSfId">kSmpIdxSfId</a><span class="p">)</span><span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kMuidSfId">kMuidSfId</a><span class="p">)</span><span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kStatusSfId">kStatusSfId</a><span class="p">)</span><span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kD0SfId">kD0SfId</a><span class="p">)</span><span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kD1SfId">kD1SfId</a><span class="p">)</span><span class="p">,</span> <span class="p">&amp</span>scLocIdx<span class="p">)</span> <span class="p">=</span><span class="p">=</span> <a href="cmGlobal_h_0.html#cmOkRC">cmOkRC</a> <span class="p">)</span>
          <span class="k">if</span><span class="p">(</span> scLocIdx <span class="p">!</span><span class="p">=</span> <a href="cmGlobal_h_0.html#cmInvalidIdx">cmInvalidIdx</a> <span class="p">)</span>
        <span class="p">{</span>
          <span class="c">// It is possible that the internal score follower may go backwards.  
          // In this case it will report a given score location multiple times or out of time order.
          // The 'out' port will only be updated under the circumstances that no later
          // score location has been seen - so the last output from 'out' always reports
          // the furthest possible progress in the score.  THe 'recent' output simply reports
          // the most recent output from the internal score follower which may include 
          // previously reported or out of order score locations.</span>          
          <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kRecentSfId">kRecentSfId</a><span class="p">,</span>scLocIdx<span class="p">)</span><span class="p">;</span>
          
          <span class="k">if</span><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>maxScLocIdx<span class="p">=</span><span class="p">=</span><a href="cmGlobal_h_0.html#cmInvalidIdx">cmInvalidIdx</a> <span class="p">|</span><span class="p">|</span> p<span class="p">-</span><span class="p">&gt</span>maxScLocIdx <span class="p">&lt</span> scLocIdx <span class="p">)</span>
          <span class="p">{</span>
            p<span class="p">-</span><span class="p">&gt</span>maxScLocIdx <span class="p">=</span> scLocIdx<span class="p">;</span>
            <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kOutSfId">kOutSfId</a><span class="p">,</span>scLocIdx<span class="p">)</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">break</span><span class="p">;</span>
      
    <span class="k">case</span> <a href="#kFnSfId">kFnSfId</a><span class="p">:</span>
      <a href="#_cmDspScFolOpenScore">_cmDspScFolOpenScore</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
      
    <span class="k">case</span> <a href="#kCmdSfId">kCmdSfId</a><span class="p">:</span>
      <span class="k">if</span><span class="p">(</span> <a href="cmDspClass_h_0.html#cmDspSymbol">cmDspSymbol</a><span class="p">(</span>inst<span class="p">,</span><a href="#kCmdSfId">kCmdSfId</a><span class="p">)</span> <span class="p">=</span><span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>printSymId <span class="p">)</span>
        p<span class="p">-</span><span class="p">&gt</span>sfp<span class="p">-</span><span class="p">&gt</span>printFl <span class="p">=</span> true<span class="p">;</span>
      <span class="k">else</span>
        <span class="k">if</span><span class="p">(</span> <a href="cmDspClass_h_0.html#cmDspSymbol">cmDspSymbol</a><span class="p">(</span>inst<span class="p">,</span><a href="#kCmdSfId">kCmdSfId</a><span class="p">)</span> <span class="p">=</span><span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>quietSymId <span class="p">)</span>
          p<span class="p">-</span><span class="p">&gt</span>sfp<span class="p">-</span><span class="p">&gt</span>printFl <span class="p">=</span> false<span class="p">;</span>
      
      <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> <a name="cmScFolClassCons_defn"></a><span class="f"><a href="cmDspKr_h_0.html#cmScFolClassCons">cmScFolClassCons</a></span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspClassSetup">cmDspClassSetup</a><span class="p">(</span><span class="p">&amp</span>_cmScFolDC<span class="p">,</span>ctx<span class="p">,</span><span class="l">&quotScFol&quot</span><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspScFolAlloc">_cmDspScFolAlloc</a><span class="p">,</span>
  <a href="#_cmDspScFolFree">_cmDspScFolFree</a><span class="p">,</span>
  <a href="#_cmDspScFolReset">_cmDspScFolReset</a><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspScFolRecv">_cmDspScFolRecv</a><span class="p">,</span>
  NULL<span class="p">,</span>NULL<span class="p">,</span>
  <span class="l">&quotScore Follower&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>_cmScFolDC<span class="p">;</span>
<span class="p">}</span>

<span class="c"><hr id="hr1"></span></pre>
</div>
<div class="cod"><div class="blk_title">cmDspScMod : Score driven parameter automation.</div><pre><a name="cmDspScMod"></a>
<span class="k">enum</span>
<span class="p">{</span>
  <a name="kScLocIdxMdId"></a><span class="e">kScLocIdxMdId</span><span class="p">,</span>
  <a name="kResetIdxMdId"></a><span class="e">kResetIdxMdId</span><span class="p">,</span>
  <a name="kCmdMdId"></a><span class="e">kCmdMdId</span><span class="p">,</span>
  <a name="kSelMdId"></a><span class="e">kSelMdId</span><span class="p">,</span>
  <a name="kPostMdId"></a><span class="e">kPostMdId</span>
<span class="p">}</span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a> _cmModulatorDC<span class="p">;</span>

<a name="cmDspScMod_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a>    <a name="cmDspScMod_t.inst"></a><span class="i">inst</span><span class="p">;</span>
  <a href="cmProc4_h_0.html#cmScModulator">cmScModulator</a><span class="p">*</span> <a name="cmDspScMod_t.mp"></a><span class="i">mp</span><span class="p">;</span>
  <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span>    <a name="cmDspScMod_t.tmp_ctx"></a><span class="i">tmp_ctx</span><span class="p">;</span>       <span class="c"> // used to temporarily hold the current cmDspCtx during callback</span>
  <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span>      <a name="cmDspScMod_t.fn"></a><span class="i">fn</span><span class="p">;</span>
  <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span>      <a name="cmDspScMod_t.modLabel"></a><span class="i">modLabel</span><span class="p">;</span>
  <span class="k">unsigned</span>       <a name="cmDspScMod_t.onSymId"></a><span class="i">onSymId</span><span class="p">;</span>
  <span class="k">unsigned</span>       <a name="cmDspScMod_t.offSymId"></a><span class="i">offSymId</span><span class="p">;</span>
  <span class="k">unsigned</span>       <a name="cmDspScMod_t.postSymId"></a><span class="i">postSymId</span><span class="p">;</span>
  <span class="k">unsigned</span>       <a name="cmDspScMod_t.dumpSymId"></a><span class="i">dumpSymId</span><span class="p">;</span>
  <span class="k">unsigned</span>       <a name="cmDspScMod_t.minInVarId"></a><span class="i">minInVarId</span><span class="p">;</span>
  <span class="k">unsigned</span>       <a name="cmDspScMod_t.maxInVarId"></a><span class="i">maxInVarId</span><span class="p">;</span>
  <span class="k">unsigned</span><span class="p">*</span>      <a name="cmDspScMod_t.inVarIdMap"></a><span class="i">inVarIdMap</span><span class="p">;</span>
  <span class="k">unsigned</span>       <a name="cmDspScMod_t.inVarIdOffs"></a><span class="i">inVarIdOffs</span><span class="p">;</span>
<span class="p">}</span> <span class="t"><a href="#cmDspScMod_t">cmDspScMod_t</a></span><span class="p">;</span>

<span class="k">void</span> <a name="_cmDspScModCb_defn"></a><a name="_cmDspScModCb"></a><span class="f">_cmDspScModCb</span><span class="p">(</span> <span class="k">void</span><span class="p">*</span> arg<span class="p">,</span> <span class="k">unsigned</span> varSymId<span class="p">,</span> <span class="k">double</span> value<span class="p">,</span> <span class="k">bool</span> postFl <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspScMod_t">cmDspScMod_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspScMod_t">cmDspScMod_t</a><span class="p">*</span><span class="p">)</span>arg<span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspVar_t">cmDspVar_t</a><span class="p">*</span> varPtr<span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="p">(</span>varPtr <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspVarSymbolToPtr">cmDspVarSymbolToPtr</a><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>tmp_ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> varSymId<span class="p">,</span> <span class="l">0</span> <span class="p">)</span><span class="p">)</span> <span class="p">=</span><span class="p">=</span> NULL <span class="p">)</span>
    <span class="k">return</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetDouble">cmDspSetDouble</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>tmp_ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>varPtr<span class="p">-</span><span class="p">&gt</span>constId<span class="p">,</span>value<span class="p">)</span><span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> postFl <span class="p">)</span>
    <a href="cmDspClass_h_0.html#cmDspSetSymbol">cmDspSetSymbol</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>tmp_ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kPostMdId">kPostMdId</a><span class="p">,</span>p<span class="p">-</span><span class="p">&gt</span>postSymId<span class="p">)</span><span class="p">;</span>
  
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span>  <a name="_cmDspScModAlloc_defn"></a><a name="_cmDspScModAlloc"></a><span class="f">_cmDspScModAlloc</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> classPtr<span class="p">,</span> <span class="k">unsigned</span> storeSymId<span class="p">,</span> <span class="k">unsigned</span> instSymId<span class="p">,</span> <span class="k">unsigned</span> id<span class="p">,</span> <span class="k">unsigned</span> va_cnt<span class="p">,</span> va_list vl <span class="p">)</span>
<span class="p">{</span>
  va_list vl1<span class="p">;</span>
  va_copy<span class="p">(</span>vl1<span class="p">,</span>vl<span class="p">)</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspVarArg_t">cmDspVarArg_t</a> args<span class="p">[</span><span class="p">]</span> <span class="p">=</span>
  <span class="p">{</span>
    <span class="p">{</span> <span class="l">&quotindex&quot</span><span class="p">,</span>   <a href="#kScLocIdxMdId">kScLocIdxMdId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>  <span class="l">&quotScore follower index input.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotreset&quot</span><span class="p">,</span>   <a href="#kResetIdxMdId">kResetIdxMdId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span> <span class="l">&quotReset the modulator and go to the score index.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotcmd&quot</span><span class="p">,</span>     <a href="#kCmdMdId">kCmdMdId</a><span class="p">,</span>      <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kSymDsvFl">kSymDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span> <span class="l">&quoton | off.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotsel&quot</span><span class="p">,</span>     <a href="#kSelMdId">kSelMdId</a><span class="p">,</span>      <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kSymDsvFl">kSymDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span> <span class="l">&quotSet the next active entry group name.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotpost&quot</span><span class="p">,</span>    <a href="#kPostMdId">kPostMdId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kSymDsvFl">kSymDsvFl</a><span class="p">,</span> <span class="l">&quotSends 'post' symbol after a message transmission if the 'post' flag is set in scMod.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> NULL<span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span> <span class="p">}</span>
  <span class="p">}</span><span class="p">;</span>
  
  <span class="c">// validate the argument count</span>
  <span class="k">if</span><span class="p">(</span> va_cnt <span class="p">!</span><span class="p">=</span> <span class="l">2</span> <span class="p">)</span>
  <span class="p">{</span>
    <a href="cmDspClass_h_0.html#cmDspClassErr">cmDspClassErr</a><span class="p">(</span>ctx<span class="p">,</span>classPtr<span class="p">,</span><a href="cmDspClass_h_0.html#kInvalidArgDspRC">kInvalidArgDspRC</a><span class="p">,</span><span class="l">&quotThe Modulator requires at least two arguments.&quot</span><span class="p">)</span><span class="p">;</span>
    <span class="k">return</span> NULL<span class="p">;</span>
  <span class="p">}</span>    
  
  <span class="c">// read the modulator file and label strings</span>
  <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> fn       <span class="p">=</span> va_arg<span class="p">(</span>vl1<span class="p">,</span><span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span><span class="p">)</span><span class="p">;</span>
  <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> modLabel <span class="p">=</span> va_arg<span class="p">(</span>vl1<span class="p">,</span><span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span><span class="p">)</span><span class="p">;</span>
  
  va_end<span class="p">(</span>vl1<span class="p">)</span><span class="p">;</span>
  
  <span class="c">// validate the file</span>
  <span class="k">if</span><span class="p">(</span> fn<span class="p">=</span><span class="p">=</span>NULL <span class="p">|</span><span class="p">|</span> <a href="cmFileSys_h_0.html#cmFsIsFile">cmFsIsFile</a><span class="p">(</span>fn<span class="p">)</span><span class="p">=</span><span class="p">=</span>false <span class="p">)</span>
  <span class="p">{</span>
    <a href="cmDspClass_h_0.html#cmDspClassErr">cmDspClassErr</a><span class="p">(</span>ctx<span class="p">,</span>classPtr<span class="p">,</span><a href="cmDspClass_h_0.html#kInvalidArgDspRC">kInvalidArgDspRC</a><span class="p">,</span><span class="l">&quotThe Modulator file '%s' is not valid.&quot</span><span class="p">,</span><a href="cmGlobal_h_0.html#cmStringNullGuard">cmStringNullGuard</a><span class="p">(</span>fn<span class="p">)</span><span class="p">)</span><span class="p">;</span>
    <span class="k">return</span> NULL<span class="p">;</span>
  <span class="p">}</span>
  
  <span class="c">// allocate the internal modulator object</span>
  <a href="cmProc4_h_0.html#cmScModulator">cmScModulator</a><span class="p">*</span> mp <span class="p">=</span> <a href="cmProc4_h_0.html#cmScModulatorAlloc">cmScModulatorAlloc</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>cmProcCtx<span class="p">,</span> NULL<span class="p">,</span> ctx<span class="p">-</span><span class="p">&gt</span><a href="cmProcObj_h_0.html#cmCtx">cmCtx</a><span class="p">,</span> ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspSampleRate">cmDspSampleRate</a><span class="p">(</span>ctx<span class="p">)</span><span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspSamplesPerCycle">cmDspSamplesPerCycle</a><span class="p">(</span>ctx<span class="p">)</span><span class="p">,</span> fn<span class="p">,</span> modLabel<span class="p">,</span> <a href="#_cmDspScModCb">_cmDspScModCb</a><span class="p">,</span> NULL <span class="p">)</span><span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span>mp <span class="p">=</span><span class="p">=</span> NULL <span class="p">)</span>
  <span class="p">{</span>
    <a href="cmDspClass_h_0.html#cmDspClassErr">cmDspClassErr</a><span class="p">(</span>ctx<span class="p">,</span>classPtr<span class="p">,</span><a href="cmDspClass_h_0.html#kInvalidArgDspRC">kInvalidArgDspRC</a><span class="p">,</span><span class="l">&quotThe internal modulator object initialization failed.&quot</span><span class="p">)</span><span class="p">;</span>
    <span class="k">return</span> NULL<span class="p">;</span>
  <span class="p">}</span>
  <span class="k">unsigned</span>      fixArgCnt <span class="p">=</span> <span class="k">sizeof</span><span class="p">(</span>args<span class="p">)</span><span class="p">/</span><span class="k">sizeof</span><span class="p">(</span>args<span class="p">[</span><span class="l">0</span><span class="p">]</span><span class="p">)</span> <span class="p">-</span> <span class="l">1</span><span class="p">;</span>
  <span class="k">unsigned</span>      outVarCnt <span class="p">=</span> <a href="cmProc4_h_0.html#cmScModulatorOutVarCount">cmScModulatorOutVarCount</a><span class="p">(</span>mp<span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>      inVarCnt  <span class="p">=</span> <a href="cmProc4_h_0.html#cmScModulatorInVarCount">cmScModulatorInVarCount</a><span class="p">(</span>mp<span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>      argCnt    <span class="p">=</span> fixArgCnt <span class="p">+</span> inVarCnt <span class="p">+</span> outVarCnt<span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspVarArg_t">cmDspVarArg_t</a> a<span class="p">[</span> argCnt<span class="p">+</span><span class="l">1</span> <span class="p">]</span><span class="p">;</span>
  <span class="k">unsigned</span>      i<span class="p">;</span>
  <span class="k">unsigned</span><span class="p">*</span>     inVarIdMap <span class="p">=</span> <a href="cmMallocDebug_h_0.html#cmMemAllocZ">cmMemAllocZ</a><span class="p">(</span> <span class="k">unsigned</span><span class="p">,</span> inVarCnt <span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspArgCopy">cmDspArgCopy</a><span class="p">(</span> a<span class="p">,</span> argCnt<span class="p">,</span> <span class="l">0</span><span class="p">,</span> args<span class="p">,</span> fixArgCnt <span class="p">)</span><span class="p">;</span>
  
  <span class="k">for</span><span class="p">(</span>i<span class="p">=</span>fixArgCnt<span class="p">;</span> i<span class="p">&lt</span>argCnt<span class="p">;</span> <span class="p">+</span><span class="p">+</span>i<span class="p">)</span>
  <span class="p">{</span>
    <span class="k">unsigned</span>            inVarIdx  <span class="p">=</span> i <span class="p">-</span> fixArgCnt<span class="p">;</span>
    <span class="k">unsigned</span>            outVarIdx <span class="p">=</span> inVarIdx <span class="p">-</span> inVarCnt<span class="p">;</span> 
    <span class="k">bool</span>                inputFl   <span class="p">=</span> inVarIdx <span class="p">&lt</span> inVarCnt<span class="p">;</span>
    <span class="k">const</span> <a href="cmProc4_h_0.html#cmScModVar_t">cmScModVar_t</a><span class="p">*</span> vp        <span class="p">=</span> inputFl <span class="p">?</span> <a href="cmProc4_h_0.html#cmScModulatorInVar">cmScModulatorInVar</a><span class="p">(</span>mp<span class="p">,</span>inVarIdx<span class="p">)</span> <span class="p">:</span> <a href="cmProc4_h_0.html#cmScModulatorOutVar">cmScModulatorOutVar</a><span class="p">(</span>mp<span class="p">,</span>outVarIdx<span class="p">)</span><span class="p">;</span>
    <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span>     label     <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblLabel">cmSymTblLabel</a><span class="p">(</span> ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span> vp<span class="p">-</span><span class="p">&gt</span>varSymId <span class="p">)</span><span class="p">;</span>
    <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span>     docStr    <span class="p">=</span> <a href="cmText_h_0.html#cmTsPrintfS">cmTsPrintfS</a><span class="p">(</span><span class="l">&quotVariable %s for %s&quot</span><span class="p">,</span>inputFl<span class="p">?</span><span class="l">&quotinput&quot</span><span class="p">:</span><span class="l">&quotoutput&quot</span><span class="p">,</span>label<span class="p">)</span><span class="p">;</span>
    <span class="k">unsigned</span>            flags     <span class="p">=</span> inputFl <span class="p">?</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">:</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a><span class="p">;</span>
    
    <span class="k">if</span><span class="p">(</span> inputFl <span class="p">)</span>
      inVarIdMap<span class="p">[</span> inVarIdx <span class="p">]</span> <span class="p">=</span> vp<span class="p">-</span><span class="p">&gt</span>varSymId<span class="p">;</span>
    
    <a href="cmDspClass_h_0.html#cmDspArgSetup">cmDspArgSetup</a><span class="p">(</span>ctx<span class="p">,</span> a <span class="p">+</span> i<span class="p">,</span> label<span class="p">,</span> <a href="cmGlobal_h_0.html#cmInvalidId">cmInvalidId</a><span class="p">,</span> i<span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> flags <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a><span class="p">,</span> docStr <span class="p">)</span><span class="p">;</span> 
  <span class="p">}</span>
  <a href="cmDspClass_h_0.html#cmDspArgSetupNull">cmDspArgSetupNull</a><span class="p">(</span>a<span class="p">+</span>argCnt<span class="p">)</span><span class="p">;</span> <span class="c"> // set terminating arg. flags</span>
  
  <a href="#cmDspScMod_t">cmDspScMod_t</a><span class="p">*</span> p <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstAlloc">cmDspInstAlloc</a><span class="p">(</span><a href="#cmDspScMod_t">cmDspScMod_t</a><span class="p">,</span>ctx<span class="p">,</span>classPtr<span class="p">,</span>a<span class="p">,</span>instSymId<span class="p">,</span>id<span class="p">,</span>storeSymId<span class="p">,</span>va_cnt<span class="p">,</span>vl<span class="p">)</span><span class="p">;</span>
  
  
  p<span class="p">-</span><span class="p">&gt</span>fn          <span class="p">=</span> <a href="cmMallocDebug_h_0.html#cmMemAllocStr">cmMemAllocStr</a><span class="p">(</span>fn<span class="p">)</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>modLabel    <span class="p">=</span> <a href="cmMallocDebug_h_0.html#cmMemAllocStr">cmMemAllocStr</a><span class="p">(</span>modLabel<span class="p">)</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>mp          <span class="p">=</span> mp<span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>onSymId     <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblId">cmSymTblId</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span><span class="l">&quoton&quot</span><span class="p">)</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>offSymId    <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblId">cmSymTblId</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span><span class="l">&quotoff&quot</span><span class="p">)</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>postSymId   <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblRegisterStaticSymbol">cmSymTblRegisterStaticSymbol</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span><span class="l">&quotpost&quot</span><span class="p">)</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>dumpSymId   <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblId">cmSymTblId</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span><span class="l">&quotdump&quot</span><span class="p">)</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>minInVarId  <span class="p">=</span> fixArgCnt<span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>maxInVarId  <span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>minInVarId <span class="p">+</span> inVarCnt <span class="p">-</span> <span class="l">1</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>inVarIdMap  <span class="p">=</span> inVarIdMap<span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>inVarIdOffs <span class="p">=</span> fixArgCnt<span class="p">;</span>
  
  mp<span class="p">-</span><span class="p">&gt</span>cbArg <span class="p">=</span> p<span class="p">;</span>  <span class="c"> // set the modulator callback arg</span>
  
  
  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kScLocIdxMdId">kScLocIdxMdId</a><span class="p">,</span><span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultSymbol">cmDspSetDefaultSymbol</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kCmdMdId">kCmdMdId</a><span class="p">,</span>p<span class="p">-</span><span class="p">&gt</span>offSymId<span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultSymbol">cmDspSetDefaultSymbol</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kSelMdId">kSelMdId</a><span class="p">,</span><a href="cmGlobal_h_0.html#cmInvalidId">cmInvalidId</a><span class="p">)</span><span class="p">;</span>
  <span class="k">return</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspScModFree_defn"></a><a name="_cmDspScModFree"></a><span class="f">_cmDspScModFree</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>        rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspScMod_t">cmDspScMod_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspScMod_t">cmDspScMod_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  
  <span class="k">if</span><span class="p">(</span> <a href="cmProc4_h_0.html#cmScModulatorFree">cmScModulatorFree</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>mp<span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmTimeLine_h_0.html#kOkTlRC">kOkTlRC</a> <span class="p">)</span>
    <span class="k">return</span> <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>inst<span class="p">-</span><span class="p">&gt</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span> <a href="cmDspClass_h_0.html#kInstFinalFailDspRC">kInstFinalFailDspRC</a><span class="p">,</span> <span class="l">&quotModulator release failed.&quot</span><span class="p">)</span><span class="p">;</span>
  
  <a href="cmMallocDebug_h_0.html#cmMemFree">cmMemFree</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>fn<span class="p">)</span><span class="p">;</span>
  <a href="cmMallocDebug_h_0.html#cmMemFree">cmMemFree</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>modLabel<span class="p">)</span><span class="p">;</span>
  <a href="cmMallocDebug_h_0.html#cmMemFree">cmMemFree</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>inVarIdMap<span class="p">)</span><span class="p">;</span>
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>


<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspScModReset_defn"></a><a name="_cmDspScModReset"></a><span class="f">_cmDspScModReset</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>       rc          <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspApplyAllDefaults">cmDspApplyAllDefaults</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspScModRecv_defn"></a><a name="_cmDspScModRecv"></a><span class="f">_cmDspScModRecv</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspScMod_t">cmDspScMod_t</a><span class="p">*</span> p  <span class="p">=</span> <span class="p">(</span><a href="#cmDspScMod_t">cmDspScMod_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>minInVarId <span class="p">&lt</span><span class="p">=</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">&amp</span><span class="p">&amp</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">&lt</span><span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>maxInVarId <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">double</span> v <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span>evt<span class="p">-</span><span class="p">&gt</span>dstVarId<span class="p">)</span><span class="p">;</span>
    <span class="c">//printf(&ampquot%s : %i %f\n&ampquot,__FUNCTION__,evt-&ampgtdstVarId,v);</span>
    <a href="cmProc4_h_0.html#cmScModulatorSetValue">cmScModulatorSetValue</a><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>mp<span class="p">,</span> p<span class="p">-</span><span class="p">&gt</span>inVarIdMap<span class="p">[</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">-</span> p<span class="p">-</span><span class="p">&gt</span>inVarIdOffs <span class="p">]</span><span class="p">,</span> v <span class="p">)</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="k">switch</span><span class="p">(</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">)</span>
  <span class="p">{</span>
  <span class="k">case</span> <a href="#kResetIdxMdId">kResetIdxMdId</a><span class="p">:</span>
    <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kScLocIdxMdId">kScLocIdxMdId</a><span class="p">,</span><a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kResetIdxMdId">kResetIdxMdId</a><span class="p">)</span><span class="p">)</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kCmdMdId">kCmdMdId</a><span class="p">:</span>
    <span class="p">{</span>
      <span class="k">unsigned</span> symId <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspSymbol">cmDspSymbol</a><span class="p">(</span>inst<span class="p">,</span><a href="#kCmdMdId">kCmdMdId</a><span class="p">)</span><span class="p">;</span>
      <span class="k">if</span><span class="p">(</span> symId <span class="p">=</span><span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>onSymId <span class="p">)</span>
        <a href="cmProc4_h_0.html#cmScModulatorReset">cmScModulatorReset</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>mp<span class="p">,</span> ctx<span class="p">-</span><span class="p">&gt</span><a href="cmProcObj_h_0.html#cmCtx">cmCtx</a><span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kScLocIdxMdId">kScLocIdxMdId</a><span class="p">)</span><span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspSymbol">cmDspSymbol</a><span class="p">(</span>inst<span class="p">,</span><a href="#kSelMdId">kSelMdId</a><span class="p">)</span><span class="p">)</span><span class="p">;</span>
      
      <span class="k">if</span><span class="p">(</span> symId <span class="p">=</span><span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>dumpSymId <span class="p">)</span>
        <a href="cmProc4_h_0.html#cmScModulatorDump">cmScModulatorDump</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>mp<span class="p">)</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="p">}</span>
  
  <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspScModExec_defn"></a><a name="_cmDspScModExec"></a><span class="f">_cmDspScModExec</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>         rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspScMod_t">cmDspScMod_t</a><span class="p">*</span> p  <span class="p">=</span> <span class="p">(</span><a href="#cmDspScMod_t">cmDspScMod_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> <a href="cmDspClass_h_0.html#cmDspSymbol">cmDspSymbol</a><span class="p">(</span>inst<span class="p">,</span><a href="#kCmdMdId">kCmdMdId</a><span class="p">)</span> <span class="p">!</span><span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>offSymId <span class="p">)</span>
  <span class="p">{</span>
    p<span class="p">-</span><span class="p">&gt</span>tmp_ctx <span class="p">=</span> ctx<span class="p">;</span>
    <a href="cmProc4_h_0.html#cmScModulatorExec">cmScModulatorExec</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>mp<span class="p">,</span><a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kScLocIdxMdId">kScLocIdxMdId</a><span class="p">)</span><span class="p">)</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> <a name="cmScModClassCons_defn"></a><span class="f"><a href="cmDspKr_h_0.html#cmScModClassCons">cmScModClassCons</a></span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspClassSetup">cmDspClassSetup</a><span class="p">(</span><span class="p">&amp</span>_cmModulatorDC<span class="p">,</span>ctx<span class="p">,</span><span class="l">&quotScMod&quot</span><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspScModAlloc">_cmDspScModAlloc</a><span class="p">,</span>
  <a href="#_cmDspScModFree">_cmDspScModFree</a><span class="p">,</span>
  <a href="#_cmDspScModReset">_cmDspScModReset</a><span class="p">,</span>
  <a href="#_cmDspScModExec">_cmDspScModExec</a><span class="p">,</span>
  <a href="#_cmDspScModRecv">_cmDspScModRecv</a><span class="p">,</span>
  NULL<span class="p">,</span>NULL<span class="p">,</span>
  <span class="l">&quotScore Driven Variable Modulator.&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>_cmModulatorDC<span class="p">;</span>
<span class="p">}</span>

<span class="c"><hr id="hr1"></span></pre>
</div>
<div class="cod"><div class="blk_title">cmDspGSwitch : Route all inputs to one of a group of outputs.</div><pre><a name="cmDspGSwitch"></a>
<span class="k">enum</span>
<span class="p">{</span>
  <a name="kInChCntGsId"></a><span class="e">kInChCntGsId</span><span class="p">,</span>
  <a name="kOutGroupCntGsId"></a><span class="e">kOutGroupCntGsId</span><span class="p">,</span>
  <a name="kGroupSelIdxGsId"></a><span class="e">kGroupSelIdxGsId</span><span class="p">,</span>
  <a name="kBaseInFloatGsId"></a><span class="e">kBaseInFloatGsId</span>
<span class="p">}</span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a> _cmGSwitchDC<span class="p">;</span>

<a name="cmDspGSwitch_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a>    <a name="cmDspGSwitch_t.inst"></a><span class="i">inst</span><span class="p">;</span>
  
  <span class="k">unsigned</span> <a name="cmDspGSwitch_t.iChCnt"></a><span class="i">iChCnt</span><span class="p">;</span>
  <span class="k">unsigned</span> <a name="cmDspGSwitch_t.oGroupCnt"></a><span class="i">oGroupCnt</span><span class="p">;</span>
  
  <span class="k">unsigned</span> <a name="cmDspGSwitch_t.baseInFloatGsId"></a><span class="i">baseInFloatGsId</span><span class="p">;</span>
  <span class="k">unsigned</span> <a name="cmDspGSwitch_t.baseInSymGsId"></a><span class="i">baseInSymGsId</span><span class="p">;</span>
  <span class="k">unsigned</span> <a name="cmDspGSwitch_t.baseInBoolGsId"></a><span class="i">baseInBoolGsId</span><span class="p">;</span>
  
  <span class="k">unsigned</span> <a name="cmDspGSwitch_t.baseOutFloatGsId"></a><span class="i">baseOutFloatGsId</span><span class="p">;</span>
  <span class="k">unsigned</span> <a name="cmDspGSwitch_t.baseOutSymGsId"></a><span class="i">baseOutSymGsId</span><span class="p">;</span>
  <span class="k">unsigned</span> <a name="cmDspGSwitch_t.baseOutBoolGsId"></a><span class="i">baseOutBoolGsId</span><span class="p">;</span>
  
<span class="p">}</span> <span class="t"><a href="#cmDspGSwitch_t">cmDspGSwitch_t</a></span><span class="p">;</span>


<a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span>  <a name="_cmDspGSwitchAlloc_defn"></a><a name="_cmDspGSwitchAlloc"></a><span class="f">_cmDspGSwitchAlloc</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> classPtr<span class="p">,</span> <span class="k">unsigned</span> storeSymId<span class="p">,</span> <span class="k">unsigned</span> instSymId<span class="p">,</span> <span class="k">unsigned</span> id<span class="p">,</span> <span class="k">unsigned</span> va_cnt<span class="p">,</span> va_list vl <span class="p">)</span>
<span class="p">{</span>
  va_list vl1<span class="p">;</span>
  va_copy<span class="p">(</span>vl1<span class="p">,</span>vl<span class="p">)</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspVarArg_t">cmDspVarArg_t</a> args<span class="p">[</span><span class="p">]</span> <span class="p">=</span>
  <span class="p">{</span>
    <span class="p">{</span> <span class="l">&quotichs&quot</span><span class="p">,</span>   <a href="#kInChCntGsId">kInChCntGsId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span>            <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kReqArgDsvFl">kReqArgDsvFl</a><span class="p">,</span> <span class="l">&quotInput channel count.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotochs&quot</span><span class="p">,</span>   <a href="#kOutGroupCntGsId">kOutGroupCntGsId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span>            <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kReqArgDsvFl">kReqArgDsvFl</a><span class="p">,</span> <span class="l">&quotOutput group count.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotsel&quot</span><span class="p">,</span>    <a href="#kGroupSelIdxGsId">kGroupSelIdxGsId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                <span class="l">&quotGroup select index.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> NULL<span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span> <span class="p">}</span>
  <span class="p">}</span><span class="p">;</span>
  
  <span class="c">// validate the argument count</span>
  <span class="k">if</span><span class="p">(</span> va_cnt <span class="p">!</span><span class="p">=</span> <span class="l">2</span> <span class="p">)</span>
  <span class="p">{</span>
    <a href="cmDspClass_h_0.html#cmDspClassErr">cmDspClassErr</a><span class="p">(</span>ctx<span class="p">,</span>classPtr<span class="p">,</span><a href="cmDspClass_h_0.html#kInvalidArgDspRC">kInvalidArgDspRC</a><span class="p">,</span><span class="l">&quotThe GSwitch requires at least two arguments.&quot</span><span class="p">)</span><span class="p">;</span>
    <span class="k">return</span> NULL<span class="p">;</span>
  <span class="p">}</span>    
  
  <span class="c">// read the input ch and output group count</span>
  <span class="k">unsigned</span> iChCnt     <span class="p">=</span> va_arg<span class="p">(</span>vl1<span class="p">,</span><span class="k">unsigned</span><span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span> oGroupCnt  <span class="p">=</span> va_arg<span class="p">(</span>vl1<span class="p">,</span><span class="k">unsigned</span><span class="p">)</span><span class="p">;</span>
  
  va_end<span class="p">(</span>vl1<span class="p">)</span><span class="p">;</span>
  
  <span class="c">// validate the channel counts</span>
  <span class="k">if</span><span class="p">(</span> iChCnt <span class="p">=</span><span class="p">=</span> <span class="l">0</span> <span class="p">|</span><span class="p">|</span> oGroupCnt<span class="p">=</span><span class="p">=</span><span class="l">0</span> <span class="p">)</span>
  <span class="p">{</span>
    <a href="cmDspClass_h_0.html#cmDspClassErr">cmDspClassErr</a><span class="p">(</span>ctx<span class="p">,</span>classPtr<span class="p">,</span><a href="cmDspClass_h_0.html#kInvalidArgDspRC">kInvalidArgDspRC</a><span class="p">,</span><span class="l">&quotThe GSwitch input channel count and group count must be greater than zero.&quot</span><span class="p">)</span><span class="p">;</span>
    <span class="k">return</span> NULL<span class="p">;</span>
  <span class="p">}</span>
  
  <span class="k">unsigned</span> typeCnt          <span class="p">=</span> <span class="l">3</span><span class="p">;</span> <span class="c"> // i.e. float,sym,bool</span>
  <span class="k">unsigned</span> baseInFloatGsId  <span class="p">=</span> <a href="#kBaseInFloatGsId">kBaseInFloatGsId</a><span class="p">;</span>
  <span class="k">unsigned</span> baseInSymGsId    <span class="p">=</span> baseInFloatGsId  <span class="p">+</span> iChCnt<span class="p">;</span>
  <span class="k">unsigned</span> baseInBoolGsId   <span class="p">=</span> baseInSymGsId    <span class="p">+</span> iChCnt<span class="p">;</span>
  <span class="k">unsigned</span> baseOutFloatGsId <span class="p">=</span> baseInBoolGsId   <span class="p">+</span> iChCnt<span class="p">;</span>
  <span class="k">unsigned</span> baseOutSymGsId   <span class="p">=</span> baseOutFloatGsId <span class="p">+</span> <span class="p">(</span>iChCnt <span class="p">*</span> oGroupCnt<span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span> baseOutBoolGsId  <span class="p">=</span> baseOutSymGsId   <span class="p">+</span> <span class="p">(</span>iChCnt <span class="p">*</span> oGroupCnt<span class="p">)</span><span class="p">;</span>
  
  <span class="k">unsigned</span>      fixArgCnt        <span class="p">=</span> <span class="l">3</span><span class="p">;</span>
  <span class="k">unsigned</span>      varArgCnt        <span class="p">=</span> <span class="p">(</span>iChCnt <span class="p">*</span> typeCnt<span class="p">)</span> <span class="p">+</span> <span class="p">(</span>iChCnt <span class="p">*</span> typeCnt <span class="p">*</span> oGroupCnt<span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>      argCnt           <span class="p">=</span> fixArgCnt <span class="p">+</span> varArgCnt<span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspVarArg_t">cmDspVarArg_t</a> a<span class="p">[</span> argCnt<span class="p">+</span><span class="l">1</span> <span class="p">]</span><span class="p">;</span>
  <span class="k">unsigned</span>      i<span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspArgCopy">cmDspArgCopy</a><span class="p">(</span> a<span class="p">,</span> argCnt<span class="p">,</span> <span class="l">0</span><span class="p">,</span> args<span class="p">,</span> fixArgCnt <span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspArgSetupN">cmDspArgSetupN</a><span class="p">(</span> ctx<span class="p">,</span> a<span class="p">,</span> argCnt<span class="p">,</span> baseInFloatGsId<span class="p">,</span> iChCnt<span class="p">,</span> <span class="l">&quotf-in&quot</span><span class="p">,</span> baseInFloatGsId<span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a><span class="p">,</span> <span class="l">&quotFloat input&quot</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspArgSetupN">cmDspArgSetupN</a><span class="p">(</span> ctx<span class="p">,</span> a<span class="p">,</span> argCnt<span class="p">,</span> baseInSymGsId<span class="p">,</span>   iChCnt<span class="p">,</span> <span class="l">&quots-in&quot</span><span class="p">,</span> baseInSymGsId<span class="p">,</span>   <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kSymDsvFl">kSymDsvFl</a><span class="p">,</span>    <span class="l">&quotSymbol input&quot</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspArgSetupN">cmDspArgSetupN</a><span class="p">(</span> ctx<span class="p">,</span> a<span class="p">,</span> argCnt<span class="p">,</span> baseInBoolGsId<span class="p">,</span>  iChCnt<span class="p">,</span> <span class="l">&quotb-in&quot</span><span class="p">,</span> baseInBoolGsId<span class="p">,</span>  <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kBoolDsvFl">kBoolDsvFl</a><span class="p">,</span>   <span class="l">&quotBool input&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">unsigned</span> labelCharCnt <span class="p">=</span> <span class="l">63</span><span class="p">;</span>
  <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a> label<span class="p">[</span>labelCharCnt<span class="p">+</span><span class="l">1</span><span class="p">]</span><span class="p">;</span>
  label<span class="p">[</span>labelCharCnt<span class="p">]</span> <span class="p">=</span> <span class="l">0</span><span class="p">;</span>
  
  <span class="k">unsigned</span> gsid <span class="p">=</span> baseOutFloatGsId<span class="p">;</span>
  <span class="k">for</span><span class="p">(</span>i<span class="p">=</span><span class="l">0</span><span class="p">;</span> i<span class="p">&lt</span>oGroupCnt<span class="p">;</span> <span class="p">+</span><span class="p">+</span>i<span class="p">,</span> gsid<span class="p">+</span><span class="p">=</span>iChCnt<span class="p">)</span>
  <span class="p">{</span>
    snprintf<span class="p">(</span>label<span class="p">,</span>labelCharCnt<span class="p">,</span><span class="l">&quotf-out-%i&quot</span><span class="p">,</span>i<span class="p">)</span><span class="p">;</span>
    <a href="cmDspClass_h_0.html#cmDspArgSetupN">cmDspArgSetupN</a><span class="p">(</span> ctx<span class="p">,</span> a<span class="p">,</span> argCnt<span class="p">,</span> gsid<span class="p">,</span> iChCnt<span class="p">,</span> label<span class="p">,</span> gsid<span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a><span class="p">,</span> <span class="l">&quotFloat output&quot</span><span class="p">)</span><span class="p">;</span>
  <span class="p">}</span>
  
  gsid <span class="p">=</span> baseOutSymGsId<span class="p">;</span>
  <span class="k">for</span><span class="p">(</span>i<span class="p">=</span><span class="l">0</span><span class="p">;</span> i<span class="p">&lt</span>oGroupCnt<span class="p">;</span> <span class="p">+</span><span class="p">+</span>i<span class="p">,</span> gsid<span class="p">+</span><span class="p">=</span>iChCnt<span class="p">)</span>
  <span class="p">{</span>
    snprintf<span class="p">(</span>label<span class="p">,</span>labelCharCnt<span class="p">,</span><span class="l">&quots-out-%i&quot</span><span class="p">,</span>i<span class="p">)</span><span class="p">;</span>
    <a href="cmDspClass_h_0.html#cmDspArgSetupN">cmDspArgSetupN</a><span class="p">(</span> ctx<span class="p">,</span> a<span class="p">,</span> argCnt<span class="p">,</span> gsid<span class="p">,</span> iChCnt<span class="p">,</span> label<span class="p">,</span> gsid<span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kSymDsvFl">kSymDsvFl</a><span class="p">,</span> <span class="l">&quotSymbol output&quot</span><span class="p">)</span><span class="p">;</span>
  <span class="p">}</span>
  
  gsid <span class="p">=</span> baseOutBoolGsId<span class="p">;</span>
  <span class="k">for</span><span class="p">(</span>i<span class="p">=</span><span class="l">0</span><span class="p">;</span> i<span class="p">&lt</span>oGroupCnt<span class="p">;</span> <span class="p">+</span><span class="p">+</span>i<span class="p">,</span> gsid<span class="p">+</span><span class="p">=</span>iChCnt<span class="p">)</span>
  <span class="p">{</span>
    snprintf<span class="p">(</span>label<span class="p">,</span>labelCharCnt<span class="p">,</span><span class="l">&quotb-out-%i&quot</span><span class="p">,</span>i<span class="p">)</span><span class="p">;</span>
    <a href="cmDspClass_h_0.html#cmDspArgSetupN">cmDspArgSetupN</a><span class="p">(</span> ctx<span class="p">,</span>a<span class="p">,</span> argCnt<span class="p">,</span> gsid<span class="p">,</span> iChCnt<span class="p">,</span> label<span class="p">,</span> gsid<span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kBoolDsvFl">kBoolDsvFl</a><span class="p">,</span> <span class="l">&quotBool output&quot</span><span class="p">)</span><span class="p">;</span>
  <span class="p">}</span>
  
  <a href="cmDspClass_h_0.html#cmDspArgSetupNull">cmDspArgSetupNull</a><span class="p">(</span>a<span class="p">+</span>argCnt<span class="p">)</span><span class="p">;</span> <span class="c"> // set terminating arg. flags </span>
  
  <a href="#cmDspGSwitch_t">cmDspGSwitch_t</a><span class="p">*</span> p <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstAlloc">cmDspInstAlloc</a><span class="p">(</span><a href="#cmDspGSwitch_t">cmDspGSwitch_t</a><span class="p">,</span>ctx<span class="p">,</span>classPtr<span class="p">,</span>a<span class="p">,</span>instSymId<span class="p">,</span>id<span class="p">,</span>storeSymId<span class="p">,</span>va_cnt<span class="p">,</span>vl<span class="p">)</span><span class="p">;</span>
  
  p<span class="p">-</span><span class="p">&gt</span>iChCnt           <span class="p">=</span> iChCnt<span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>oGroupCnt        <span class="p">=</span> oGroupCnt<span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>baseInFloatGsId  <span class="p">=</span> baseInFloatGsId<span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>baseInSymGsId    <span class="p">=</span> baseInSymGsId<span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>baseInBoolGsId   <span class="p">=</span> baseInBoolGsId<span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>baseOutFloatGsId <span class="p">=</span> baseOutFloatGsId<span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>baseOutSymGsId   <span class="p">=</span> baseOutSymGsId<span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>baseOutBoolGsId  <span class="p">=</span> baseOutBoolGsId<span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kGroupSelIdxGsId">kGroupSelIdxGsId</a><span class="p">,</span><span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspGSwitchReset_defn"></a><a name="_cmDspGSwitchReset"></a><span class="f">_cmDspGSwitchReset</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>       rc          <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspApplyAllDefaults">cmDspApplyAllDefaults</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspGSwitchRecv_defn"></a><a name="_cmDspGSwitchRecv"></a><span class="f">_cmDspGSwitchRecv</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>       rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspGSwitch_t">cmDspGSwitch_t</a><span class="p">*</span> p  <span class="p">=</span> <span class="p">(</span><a href="#cmDspGSwitch_t">cmDspGSwitch_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <span class="c">// if this is the group selector</span>
  <span class="k">if</span><span class="p">(</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">=</span><span class="p">=</span> <a href="#kGroupSelIdxGsId">kGroupSelIdxGsId</a> <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">unsigned</span> idx<span class="p">;</span>
    <span class="k">if</span><span class="p">(</span> <span class="p">(</span>idx <span class="p">=</span> <a href="cmDspValue_h_0.html#cmDsvGetUInt">cmDsvGetUInt</a><span class="p">(</span>evt<span class="p">-</span><span class="p">&gt</span>valuePtr<span class="p">)</span><span class="p">)</span> <span class="p">&gt</span> p<span class="p">-</span><span class="p">&gt</span>oGroupCnt <span class="p">)</span>
      <a href="cmDspClass_h_0.html#cmDspInstErr">cmDspInstErr</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="cmDspClass_h_0.html#kInvalidArgDspRC">kInvalidArgDspRC</a><span class="p">,</span><span class="l">&quotThe GSwitch group select index %i is out of range %i.&quot</span><span class="p">,</span>idx<span class="p">,</span>p<span class="p">-</span><span class="p">&gt</span>oGroupCnt<span class="p">)</span><span class="p">;</span>
    <span class="k">else</span>
      <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
    <span class="k">return</span> rc<span class="p">;</span>
  <span class="p">}</span>
  
  <span class="c">// get the group selector</span>
  <span class="k">unsigned</span> groupIdx <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kGroupSelIdxGsId">kGroupSelIdxGsId</a><span class="p">)</span><span class="p">;</span>
  assert<span class="p">(</span> groupIdx <span class="p">&lt</span> p<span class="p">-</span><span class="p">&gt</span>oGroupCnt<span class="p">)</span><span class="p">;</span>
  
  
  <span class="c">// if this is a float input</span>
  <span class="k">if</span><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>baseInFloatGsId <span class="p">&lt</span><span class="p">=</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">&amp</span><span class="p">&amp</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">&lt</span> p<span class="p">-</span><span class="p">&gt</span>baseInFloatGsId <span class="p">+</span> p<span class="p">-</span><span class="p">&gt</span>iChCnt <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">unsigned</span> outVarId <span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>baseOutFloatGsId <span class="p">+</span> <span class="p">(</span>groupIdx <span class="p">*</span> p<span class="p">-</span><span class="p">&gt</span>iChCnt<span class="p">)</span> <span class="p">+</span> <span class="p">(</span>evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">-</span> p<span class="p">-</span><span class="p">&gt</span>baseInFloatGsId<span class="p">)</span><span class="p">;</span>
    <a href="cmDspClass_h_0.html#cmDspValueSet">cmDspValueSet</a><span class="p">(</span>ctx<span class="p">,</span> inst<span class="p">,</span> outVarId<span class="p">,</span> evt<span class="p">-</span><span class="p">&gt</span>valuePtr<span class="p">,</span> <span class="l">0</span> <span class="p">)</span><span class="p">;</span>
    <span class="k">return</span> rc<span class="p">;</span>
  <span class="p">}</span>
  
  <span class="c">// if this is a symbol input</span>
  <span class="k">if</span><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>baseInSymGsId <span class="p">&lt</span><span class="p">=</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">&amp</span><span class="p">&amp</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">&lt</span> p<span class="p">-</span><span class="p">&gt</span>baseInSymGsId <span class="p">+</span> p<span class="p">-</span><span class="p">&gt</span>iChCnt <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">unsigned</span> outVarId <span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>baseOutSymGsId <span class="p">+</span> <span class="p">(</span>groupIdx <span class="p">*</span> p<span class="p">-</span><span class="p">&gt</span>iChCnt<span class="p">)</span> <span class="p">+</span> <span class="p">(</span>evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">-</span> p<span class="p">-</span><span class="p">&gt</span>baseInSymGsId<span class="p">)</span><span class="p">;</span>
    <a href="cmDspClass_h_0.html#cmDspValueSet">cmDspValueSet</a><span class="p">(</span>ctx<span class="p">,</span> inst<span class="p">,</span> outVarId<span class="p">,</span> evt<span class="p">-</span><span class="p">&gt</span>valuePtr<span class="p">,</span> <span class="l">0</span> <span class="p">)</span><span class="p">;</span>    
    <span class="k">return</span> rc<span class="p">;</span>
  <span class="p">}</span>
  
  <span class="c">// if this is a bool input</span>
  <span class="k">if</span><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>baseInBoolGsId <span class="p">&lt</span><span class="p">=</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">&amp</span><span class="p">&amp</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">&lt</span> p<span class="p">-</span><span class="p">&gt</span>baseInBoolGsId <span class="p">+</span> p<span class="p">-</span><span class="p">&gt</span>iChCnt <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">unsigned</span> outVarId <span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>baseOutBoolGsId <span class="p">+</span> <span class="p">(</span>groupIdx <span class="p">*</span> p<span class="p">-</span><span class="p">&gt</span>iChCnt<span class="p">)</span> <span class="p">+</span> <span class="p">(</span>evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">-</span> p<span class="p">-</span><span class="p">&gt</span>baseInBoolGsId<span class="p">)</span><span class="p">;</span>
    <a href="cmDspClass_h_0.html#cmDspValueSet">cmDspValueSet</a><span class="p">(</span>ctx<span class="p">,</span> inst<span class="p">,</span> outVarId<span class="p">,</span> evt<span class="p">-</span><span class="p">&gt</span>valuePtr<span class="p">,</span> <span class="l">0</span> <span class="p">)</span><span class="p">;</span>        
    <span class="k">return</span> rc<span class="p">;</span>
  <span class="p">}</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>


<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> <a name="cmGSwitchClassCons_defn"></a><span class="f"><a href="cmDspKr_h_0.html#cmGSwitchClassCons">cmGSwitchClassCons</a></span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspClassSetup">cmDspClassSetup</a><span class="p">(</span><span class="p">&amp</span>_cmGSwitchDC<span class="p">,</span>ctx<span class="p">,</span><span class="l">&quotGSwitch&quot</span><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspGSwitchAlloc">_cmDspGSwitchAlloc</a><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspGSwitchReset">_cmDspGSwitchReset</a><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspGSwitchRecv">_cmDspGSwitchRecv</a><span class="p">,</span>
  NULL<span class="p">,</span>NULL<span class="p">,</span>
  <span class="l">&quotGanged switch.&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>_cmGSwitchDC<span class="p">;</span>
<span class="p">}</span>


<span class="c"><hr id="hr1"></span></pre>
</div>
<div class="cod"><div class="blk_title">cmDspScaleRange : Offset and scale a scalar value.</div><pre><a name="cmDspScaleRange"></a>
<span class="k">enum</span>
<span class="p">{</span>
  <a name="kMinInSrId"></a><span class="e">kMinInSrId</span><span class="p">,</span>
  <a name="kMaxInSrId"></a><span class="e">kMaxInSrId</span><span class="p">,</span>
  <a name="kMinOutSrId"></a><span class="e">kMinOutSrId</span><span class="p">,</span>
  <a name="kMaxOutSrId"></a><span class="e">kMaxOutSrId</span><span class="p">,</span>
  <a name="kValInSrId"></a><span class="e">kValInSrId</span><span class="p">,</span>
  <a name="kValOutSrId"></a><span class="e">kValOutSrId</span><span class="p">,</span>
<span class="p">}</span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a> _cmScaleRangeDC<span class="p">;</span>

<a name="cmDspScaleRange_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a>    <a name="cmDspScaleRange_t.inst"></a><span class="i">inst</span><span class="p">;</span>
  
<span class="p">}</span> <span class="t"><a href="#cmDspScaleRange_t">cmDspScaleRange_t</a></span><span class="p">;</span>


<a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span>  <a name="_cmDspScaleRangeAlloc_defn"></a><a name="_cmDspScaleRangeAlloc"></a><span class="f">_cmDspScaleRangeAlloc</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> classPtr<span class="p">,</span> <span class="k">unsigned</span> storeSymId<span class="p">,</span> <span class="k">unsigned</span> instSymId<span class="p">,</span> <span class="k">unsigned</span> id<span class="p">,</span> <span class="k">unsigned</span> va_cnt<span class="p">,</span> va_list vl <span class="p">)</span>
<span class="p">{</span>
  va_list vl1<span class="p">;</span>
  va_copy<span class="p">(</span>vl1<span class="p">,</span>vl<span class="p">)</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspVarArg_t">cmDspVarArg_t</a> args<span class="p">[</span><span class="p">]</span> <span class="p">=</span>
  <span class="p">{</span>
    <span class="p">{</span> <span class="l">&quotmin_in&quot</span><span class="p">,</span>   <a href="#kMinInSrId">kMinInSrId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a> <span class="p">,</span> <span class="l">&quotMin Input value.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotmax_in&quot</span><span class="p">,</span>   <a href="#kMaxInSrId">kMaxInSrId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a> <span class="p">,</span> <span class="l">&quotMax Input value.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotmin_out&quot</span><span class="p">,</span>  <a href="#kMinOutSrId">kMinOutSrId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a> <span class="p">,</span> <span class="l">&quotMin Output value.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotmax_out&quot</span><span class="p">,</span>  <a href="#kMaxOutSrId">kMaxOutSrId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a> <span class="p">,</span> <span class="l">&quotMax Output value.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotval_in&quot</span><span class="p">,</span>   <a href="#kValInSrId">kValInSrId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a><span class="p">,</span>  <span class="l">&quotInput value.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotval_out&quot</span><span class="p">,</span>  <a href="#kValOutSrId">kValOutSrId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a><span class="p">,</span> <span class="l">&quotOutput value&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> NULL<span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span> <span class="p">}</span>
  <span class="p">}</span><span class="p">;</span>
  
  <a href="#cmDspScaleRange_t">cmDspScaleRange_t</a><span class="p">*</span> p <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstAlloc">cmDspInstAlloc</a><span class="p">(</span><a href="#cmDspScaleRange_t">cmDspScaleRange_t</a><span class="p">,</span>ctx<span class="p">,</span>classPtr<span class="p">,</span>args<span class="p">,</span>instSymId<span class="p">,</span>id<span class="p">,</span>storeSymId<span class="p">,</span>va_cnt<span class="p">,</span>vl<span class="p">)</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kMinInSrId">kMinInSrId</a><span class="p">,</span><span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kMaxInSrId">kMaxInSrId</a><span class="p">,</span><span class="l">0</span><span class="p">,</span><span class="l">1.0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kMinOutSrId">kMinOutSrId</a><span class="p">,</span><span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kMaxOutSrId">kMaxOutSrId</a><span class="p">,</span><span class="l">0</span><span class="p">,</span><span class="l">1.0</span><span class="p">)</span><span class="p">;</span>
  
  
  <span class="k">return</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspScaleRangeReset_defn"></a><a name="_cmDspScaleRangeReset"></a><span class="f">_cmDspScaleRangeReset</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>       rc          <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspApplyAllDefaults">cmDspApplyAllDefaults</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspScaleRangeRecv_defn"></a><a name="_cmDspScaleRangeRecv"></a><span class="f">_cmDspScaleRangeRecv</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>       rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <span class="c">//<a href="#cmDspScaleRange_t">cmDspScaleRange_t</a>* p  = (<a href="#cmDspScaleRange_t">cmDspScaleRange_t</a>*)inst;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">=</span><span class="p">=</span> <a href="#kValInSrId">kValInSrId</a> <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">double</span> val     <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kValInSrId">kValInSrId</a><span class="p">)</span><span class="p">;</span>
    <span class="k">double</span> min_in  <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kMinInSrId">kMinInSrId</a><span class="p">)</span><span class="p">;</span>
    <span class="k">double</span> max_in  <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kMaxInSrId">kMaxInSrId</a><span class="p">)</span><span class="p">;</span>    
    <span class="k">double</span> min_out <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kMinOutSrId">kMinOutSrId</a><span class="p">)</span><span class="p">;</span>    
    <span class="k">double</span> max_out <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kMaxOutSrId">kMaxOutSrId</a><span class="p">)</span><span class="p">;</span>    
    
    <span class="k">double</span> x <span class="p">=</span> <a href="cmGlobal_h_0.html#cmMax">cmMax</a><span class="p">(</span>min_in<span class="p">,</span><a href="cmGlobal_h_0.html#cmMin">cmMin</a><span class="p">(</span>max_in<span class="p">,</span>val<span class="p">)</span><span class="p">)</span><span class="p">;</span>
    
    x <span class="p">=</span> <span class="p">(</span>x <span class="p">-</span> min_in<span class="p">)</span><span class="p">/</span><span class="p">(</span>max_in <span class="p">-</span> min_in<span class="p">)</span><span class="p">;</span>
    
    x <span class="p">=</span> min_out <span class="p">+</span> x <span class="p">*</span> <span class="p">(</span>max_out <span class="p">-</span> min_out<span class="p">)</span><span class="p">;</span>
    
    <a href="cmDspClass_h_0.html#cmDspSetDouble">cmDspSetDouble</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kValOutSrId">kValOutSrId</a><span class="p">,</span> x <span class="p">)</span><span class="p">;</span>
    <span class="c">//printf(&ampquot%f (%f %f) : (%f %f) %f\n&ampquot,val,min_in,max_in,min_out,max_out,x);</span>
  <span class="p">}</span>
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>


<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> <a name="cmScaleRangeClassCons_defn"></a><span class="f"><a href="cmDspKr_h_0.html#cmScaleRangeClassCons">cmScaleRangeClassCons</a></span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspClassSetup">cmDspClassSetup</a><span class="p">(</span><span class="p">&amp</span>_cmScaleRangeDC<span class="p">,</span>ctx<span class="p">,</span><span class="l">&quotScaleRange&quot</span><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspScaleRangeAlloc">_cmDspScaleRangeAlloc</a><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspScaleRangeReset">_cmDspScaleRangeReset</a><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspScaleRangeRecv">_cmDspScaleRangeRecv</a><span class="p">,</span>
  NULL<span class="p">,</span>NULL<span class="p">,</span>
  <span class="l">&quotScale a value inside an input range to a value in the output range.&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>_cmScaleRangeDC<span class="p">;</span>
<span class="p">}</span>


<span class="c"><hr id="hr1"></span></pre>
</div>
<div class="cod"><div class="blk_title">cmDspActiveMeas : Issue stored parameter values at specified score locations.</div><pre><a name="cmDspActiveMeas"></a>
<span class="k">enum</span>
<span class="p">{</span>
  <a name="kCntAmId"></a><span class="e">kCntAmId</span><span class="p">,</span>
  <a name="kSflocAmId"></a><span class="e">kSflocAmId</span><span class="p">,</span>
  <a name="kLocAmId"></a><span class="e">kLocAmId</span><span class="p">,</span>
  <a name="kTypeAmId"></a><span class="e">kTypeAmId</span><span class="p">,</span>
  <a name="kValueAmId"></a><span class="e">kValueAmId</span><span class="p">,</span>
  <a name="kCstAmId"></a><span class="e">kCstAmId</span><span class="p">,</span>
  <a name="kCmdAmId"></a><span class="e">kCmdAmId</span><span class="p">,</span>
  <a name="kScLocAmId"></a><span class="e">kScLocAmId</span><span class="p">,</span>
  <a name="kEvenAmId"></a><span class="e">kEvenAmId</span><span class="p">,</span>
  <a name="kDynAmId"></a><span class="e">kDynAmId</span><span class="p">,</span>
  <a name="kTempoAmId"></a><span class="e">kTempoAmId</span><span class="p">,</span>
  <a name="kCostAmId"></a><span class="e">kCostAmId</span>
<span class="p">}</span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a> _cmActiveMeasDC<span class="p">;</span>

<a name="cmDspAmRecd_t"></a><span class="k">typedef</span> <span class="k">struct</span> <a name="cmDspAmRecd_str"></a>cmDspAmRecd_str
<span class="p">{</span>
  <span class="k">unsigned</span> <a name="cmDspAmRecd_t.loc"></a><span class="i">loc</span><span class="p">;</span>
  <span class="k">unsigned</span> <a name="cmDspAmRecd_t.type"></a><span class="i">type</span><span class="p">;</span>
  <span class="k">double</span>   <a name="cmDspAmRecd_t.value"></a><span class="i">value</span><span class="p">;</span>
  <span class="k">double</span>   <a name="cmDspAmRecd_t.cost"></a><span class="i">cost</span><span class="p">;</span>
  <span class="k">struct</span> <a href="#cmDspAmRecd_str">cmDspAmRecd_str</a><span class="p">*</span> <a name="cmDspAmRecd_t.link"></a><span class="i">link</span><span class="p">;</span>
<span class="p">}</span> <span class="t"><a href="#cmDspAmRecd_t">cmDspAmRecd_t</a></span><span class="p">;</span>


<span class="c">//int cmDspActiveMeasRecdCompare(const void * p0, const void * p1)
//{
//  return ((int)((cmDspActiveMeasRecd_t*)p0)-&ampgtloc) - (int)(((cmDspActiveMeasRecd_t*)p1)-&ampgtloc);
//}</span>

<a name="cmDspActiveMeas_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a>            <a name="cmDspActiveMeas_t.inst"></a><span class="i">inst</span><span class="p">;</span>
  <span class="k">unsigned</span>               <a name="cmDspActiveMeas_t.addSymId"></a><span class="i">addSymId</span><span class="p">;</span>
  <span class="k">unsigned</span>               <a name="cmDspActiveMeas_t.clearSymId"></a><span class="i">clearSymId</span><span class="p">;</span>
  <span class="k">unsigned</span>               <a name="cmDspActiveMeas_t.printSymId"></a><span class="i">printSymId</span><span class="p">;</span>
  <span class="k">unsigned</span>               <a name="cmDspActiveMeas_t.rewindSymId"></a><span class="i">rewindSymId</span><span class="p">;</span>
  <a href="#cmDspAmRecd_t">cmDspAmRecd_t</a><span class="p">*</span>         <a name="cmDspActiveMeas_t.array"></a><span class="i">array</span><span class="p">;</span>       <span class="c"> // array[cnt]</span>
  <span class="k">unsigned</span>               <a name="cmDspActiveMeas_t.cnt"></a><span class="i">cnt</span><span class="p">;</span>     
  <a href="#cmDspAmRecd_t">cmDspAmRecd_t</a><span class="p">*</span>         <a name="cmDspActiveMeas_t.list"></a><span class="i">list</span><span class="p">;</span>        <span class="c"> // first recd in list sorted on 'loc'.</span>
  <a href="#cmDspAmRecd_t">cmDspAmRecd_t</a><span class="p">*</span>         <a name="cmDspActiveMeas_t.avail"></a><span class="i">avail</span><span class="p">;</span>       <span class="c"> // next empty recd</span>
  <a href="#cmDspAmRecd_t">cmDspAmRecd_t</a><span class="p">*</span>         <a name="cmDspActiveMeas_t.sent"></a><span class="i">sent</span><span class="p">;</span>        <span class="c"> // last recd sent</span>
<span class="p">}</span> <span class="t"><a href="#cmDspActiveMeas_t">cmDspActiveMeas_t</a></span><span class="p">;</span>

<span class="k">void</span> <a name="_cmDspAmAllocList_defn"></a><a name="_cmDspAmAllocList"></a><span class="f">_cmDspAmAllocList</span><span class="p">(</span> <a href="#cmDspActiveMeas_t">cmDspActiveMeas_t</a><span class="p">*</span> p<span class="p">,</span> <span class="k">unsigned</span> cnt <span class="p">)</span>
<span class="p">{</span>
  assert<span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>array <span class="p">=</span><span class="p">=</span> NULL <span class="p">)</span><span class="p">;</span>
  
  <a href="#cmDspAmRecd_t">cmDspAmRecd_t</a><span class="p">*</span> r <span class="p">=</span> <a href="cmMallocDebug_h_0.html#cmMemAllocZ">cmMemAllocZ</a><span class="p">(</span><a href="#cmDspAmRecd_t">cmDspAmRecd_t</a><span class="p">,</span>cnt<span class="p">)</span><span class="p">;</span>
  
  p<span class="p">-</span><span class="p">&gt</span>cnt   <span class="p">=</span> cnt<span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>array <span class="p">=</span> r<span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>list  <span class="p">=</span> NULL<span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>avail <span class="p">=</span> r<span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>sent  <span class="p">=</span> NULL<span class="p">;</span>
<span class="p">}</span>


<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspActiveMeasAdd_defn"></a><a name="_cmDspActiveMeasAdd"></a><span class="f">_cmDspActiveMeasAdd</span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="#cmDspActiveMeas_t">cmDspActiveMeas_t</a><span class="p">*</span> p<span class="p">,</span> <span class="k">unsigned</span> loc<span class="p">,</span> <span class="k">unsigned</span> type<span class="p">,</span> <span class="k">double</span> value<span class="p">,</span> <span class="k">double</span> cost<span class="p">)</span>
<span class="p">{</span>
  assert<span class="p">(</span> type <span class="p">!</span><span class="p">=</span> <a href="cmScore_h_0.html#kInvalidVarScId">kInvalidVarScId</a> <span class="p">)</span><span class="p">;</span>
  
  <a href="#cmDspAmRecd_t">cmDspAmRecd_t</a><span class="p">*</span> rp <span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>list<span class="p">;</span>
  <a href="#cmDspAmRecd_t">cmDspAmRecd_t</a><span class="p">*</span> pp <span class="p">=</span> NULL<span class="p">;</span>
  
  
  <span class="c">// search for the location to add the new record</span>
  <span class="k">for</span><span class="p">(</span><span class="p">;</span> rp<span class="p">!</span><span class="p">=</span>NULL<span class="p">;</span> rp<span class="p">=</span>rp<span class="p">-</span><span class="p">&gt</span>link<span class="p">)</span>
  <span class="p">{</span>
    <span class="c">// if this loc and type already exists then replace the value and cost fields</span>
    <span class="k">if</span><span class="p">(</span> rp<span class="p">-</span><span class="p">&gt</span>loc<span class="p">=</span><span class="p">=</span>loc <span class="p">&amp</span><span class="p">&amp</span> rp<span class="p">-</span><span class="p">&gt</span>type<span class="p">=</span><span class="p">=</span>type <span class="p">)</span>
      goto foundLabel<span class="p">;</span>
    
    <span class="c">// if this loc should be inserted before rp</span>
    <span class="k">if</span><span class="p">(</span> loc <span class="p">&lt</span> rp<span class="p">-</span><span class="p">&gt</span>loc <span class="p">)</span>
      <span class="k">break</span><span class="p">;</span>
    
    pp <span class="p">=</span> rp<span class="p">;</span>
  <span class="p">}</span>
  
  <span class="c">// if the pre-allocated list is full</span>
  <span class="k">if</span><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>avail <span class="p">&gt</span><span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>array<span class="p">+</span>p<span class="p">-</span><span class="p">&gt</span>cnt <span class="p">)</span>
    <span class="k">return</span> <a href="cmDspClass_h_0.html#cmDspInstErr">cmDspInstErr</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="cmDspClass_h_0.html#kInvalidArgDspRC">kInvalidArgDspRC</a><span class="p">,</span><span class="l">&quotUnable to store new measurement record. All preallocated active measurement slots are in use.&quot</span><span class="p">)</span><span class="p">;</span>
  
  
  <span class="c">// if prepending to the list</span>
  <span class="k">if</span><span class="p">(</span> pp <span class="p">=</span><span class="p">=</span> NULL <span class="p">)</span>
  <span class="p">{</span>
    rp        <span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>avail<span class="p">;</span>
    rp<span class="p">-</span><span class="p">&gt</span>link  <span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>list<span class="p">;</span>
    p<span class="p">-</span><span class="p">&gt</span>list   <span class="p">=</span> rp<span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="c">// if appending to the list after pp</span>
    <span class="k">if</span><span class="p">(</span> rp <span class="p">=</span><span class="p">=</span> NULL <span class="p">)</span>
    <span class="p">{</span>
      <span class="c">// nothing to do</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="c"> // if inserting between pp and rp</span>
    <span class="p">{</span>
      p<span class="p">-</span><span class="p">&gt</span>avail<span class="p">-</span><span class="p">&gt</span>link <span class="p">=</span> rp<span class="p">;</span>
    <span class="p">}</span>
    
    rp       <span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>avail<span class="p">;</span>
    pp<span class="p">-</span><span class="p">&gt</span>link <span class="p">=</span> rp<span class="p">;</span>
    
  <span class="p">}</span>
  
  p<span class="p">-</span><span class="p">&gt</span>avail <span class="p">+</span><span class="p">=</span> <span class="l">1</span><span class="p">;</span>
  
  foundLabel<span class="p">:</span>
  rp<span class="p">-</span><span class="p">&gt</span>loc   <span class="p">=</span> loc<span class="p">;</span>
  rp<span class="p">-</span><span class="p">&gt</span>type  <span class="p">=</span> type<span class="p">;</span>
  rp<span class="p">-</span><span class="p">&gt</span>value <span class="p">=</span> value<span class="p">;</span>
  rp<span class="p">-</span><span class="p">&gt</span>cost  <span class="p">=</span> cost<span class="p">;</span>
  
  <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
<span class="p">}</span>


<a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span>  <a name="_cmDspActiveMeasAlloc_defn"></a><a name="_cmDspActiveMeasAlloc"></a><span class="f">_cmDspActiveMeasAlloc</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> classPtr<span class="p">,</span> <span class="k">unsigned</span> storeSymId<span class="p">,</span> <span class="k">unsigned</span> instSymId<span class="p">,</span> <span class="k">unsigned</span> id<span class="p">,</span> <span class="k">unsigned</span> va_cnt<span class="p">,</span> va_list vl <span class="p">)</span>
<span class="p">{</span>
  
  <a href="cmDspClass_h_0.html#cmDspVarArg_t">cmDspVarArg_t</a> args<span class="p">[</span><span class="p">]</span> <span class="p">=</span>
  <span class="p">{</span>
    <span class="p">{</span> <span class="l">&quotcnt&quot</span><span class="p">,</span>      <a href="#kCntAmId">kCntAmId</a><span class="p">,</span>      <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>    <span class="l">&quotMaximum count of active measurements.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotsfloc&quot</span><span class="p">,</span>    <a href="#kSflocAmId">kSflocAmId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>    <span class="l">&quotScore follower location input.&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotloc&quot</span><span class="p">,</span>      <a href="#kLocAmId">kLocAmId</a><span class="p">,</span>      <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>    <span class="l">&quotMeas. location.&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quottype&quot</span><span class="p">,</span>     <a href="#kTypeAmId">kTypeAmId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>    <span class="l">&quotMeas. Type. (even,dyn,...)&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotval&quot</span><span class="p">,</span>      <a href="#kValueAmId">kValueAmId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a><span class="p">,</span>  <span class="l">&quotMeas. Value.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotcst&quot</span><span class="p">,</span>      <a href="#kCstAmId">kCstAmId</a><span class="p">,</span>      <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a><span class="p">,</span>  <span class="l">&quotMeas. Cost.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotcmd&quot</span><span class="p">,</span>      <a href="#kCmdAmId">kCmdAmId</a><span class="p">,</span>      <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kSymDsvFl">kSymDsvFl</a><span class="p">,</span>     <span class="l">&quotCommands:add | clear | dump | rewind&quot</span><span class="p">}</span><span class="p">,</span> 
    <span class="p">{</span> <span class="l">&quotscloc&quot</span><span class="p">,</span>    <a href="#kScLocAmId">kScLocAmId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>    <span class="l">&quotScore location&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quoteven&quot</span><span class="p">,</span>     <a href="#kEvenAmId">kEvenAmId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a><span class="p">,</span>  <span class="l">&quotEven out&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotdyn&quot</span><span class="p">,</span>      <a href="#kDynAmId">kDynAmId</a><span class="p">,</span>      <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a><span class="p">,</span>  <span class="l">&quotDyn out&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quottempo&quot</span><span class="p">,</span>    <a href="#kTempoAmId">kTempoAmId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a><span class="p">,</span>  <span class="l">&quotTempo out&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotcost&quot</span><span class="p">,</span>     <a href="#kCostAmId">kCostAmId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a><span class="p">,</span>  <span class="l">&quotCost out&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> NULL<span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span> <span class="p">}</span>
  <span class="p">}</span><span class="p">;</span>
  
  
  
  <a href="#cmDspActiveMeas_t">cmDspActiveMeas_t</a><span class="p">*</span> p <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstAlloc">cmDspInstAlloc</a><span class="p">(</span><a href="#cmDspActiveMeas_t">cmDspActiveMeas_t</a><span class="p">,</span>ctx<span class="p">,</span>classPtr<span class="p">,</span>args<span class="p">,</span>instSymId<span class="p">,</span>id<span class="p">,</span>storeSymId<span class="p">,</span>va_cnt<span class="p">,</span>vl<span class="p">)</span><span class="p">;</span>
  
  p<span class="p">-</span><span class="p">&gt</span>addSymId   <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblRegisterStaticSymbol">cmSymTblRegisterStaticSymbol</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span><span class="l">&quotadd&quot</span><span class="p">)</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>clearSymId <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblRegisterStaticSymbol">cmSymTblRegisterStaticSymbol</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span><span class="l">&quotclear&quot</span><span class="p">)</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>printSymId <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblRegisterStaticSymbol">cmSymTblRegisterStaticSymbol</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span><span class="l">&quotdump&quot</span><span class="p">)</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>rewindSymId<span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblRegisterStaticSymbol">cmSymTblRegisterStaticSymbol</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span><span class="l">&quotrewind&quot</span><span class="p">)</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>  ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kCntAmId">kCntAmId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span><span class="l">256</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>  ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kScLocAmId">kScLocAmId</a><span class="p">,</span><span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kEvenAmId">kEvenAmId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kDynAmId">kDynAmId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kTempoAmId">kTempoAmId</a><span class="p">,</span><span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kTempoAmId">kTempoAmId</a><span class="p">,</span><span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspActiveMeasPrint_defn"></a><a name="_cmDspActiveMeasPrint"></a><span class="f">_cmDspActiveMeasPrint</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="#cmDspActiveMeas_t">cmDspActiveMeas_t</a><span class="p">*</span> p <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspAmRecd_t">cmDspAmRecd_t</a><span class="p">*</span> rp <span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>list<span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="p">;</span> rp<span class="p">!</span><span class="p">=</span>NULL<span class="p">;</span> rp<span class="p">=</span>rp<span class="p">-</span><span class="p">&gt</span>link<span class="p">)</span>
  <span class="p">{</span>
    <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> label <span class="p">=</span> <span class="l">&quot&ltnull&gt&quot</span><span class="p">;</span>
    <span class="k">switch</span><span class="p">(</span> rp<span class="p">-</span><span class="p">&gt</span>type <span class="p">)</span>
    <span class="p">{</span>
    <span class="k">case</span> <a href="cmScore_h_0.html#kEvenVarScId">kEvenVarScId</a><span class="p">:</span>    label<span class="p">=</span><span class="l">&quoteven &quot</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <a href="cmScore_h_0.html#kDynVarScId">kDynVarScId</a><span class="p">:</span>     label<span class="p">=</span><span class="l">&quotdyn  &quot</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <a href="cmScore_h_0.html#kTempoVarScId">kTempoVarScId</a><span class="p">:</span>   label<span class="p">=</span><span class="l">&quottempo&quot</span><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
    <span class="k">default</span><span class="p">:</span>
      <span class="p">{</span> assert<span class="p">(</span><span class="l">0</span><span class="p">)</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
    
    <a href="cmRpt_h_0.html#cmRptPrintf">cmRptPrintf</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>rpt<span class="p">,</span><span class="l">&quotloc:%i %s %f %f\n&quot</span><span class="p">,</span>rp<span class="p">-</span><span class="p">&gt</span>loc<span class="p">,</span>label<span class="p">,</span>rp<span class="p">-</span><span class="p">&gt</span>value<span class="p">,</span>rp<span class="p">-</span><span class="p">&gt</span>cost<span class="p">)</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspActiveMeasClear_defn"></a><a name="_cmDspActiveMeasClear"></a><span class="f">_cmDspActiveMeasClear</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="#cmDspActiveMeas_t">cmDspActiveMeas_t</a><span class="p">*</span> p <span class="p">)</span>
<span class="p">{</span>
  memset<span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>array<span class="p">,</span><span class="l">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>array<span class="p">[</span><span class="l">0</span><span class="p">]</span><span class="p">)</span><span class="p">*</span>p<span class="p">-</span><span class="p">&gt</span>cnt<span class="p">)</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>avail <span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>array<span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>list  <span class="p">=</span> NULL<span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>avail <span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>array<span class="p">;</span>
  
  <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspActiveMeasFree_defn"></a><a name="_cmDspActiveMeasFree"></a><span class="f">_cmDspActiveMeasFree</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspActiveMeas_t">cmDspActiveMeas_t</a><span class="p">*</span> p  <span class="p">=</span> <span class="p">(</span><a href="#cmDspActiveMeas_t">cmDspActiveMeas_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  <a href="cmMallocDebug_h_0.html#cmMemPtrFree">cmMemPtrFree</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>array<span class="p">)</span><span class="p">;</span>
  <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspActiveMeasReset_defn"></a><a name="_cmDspActiveMeasReset"></a><span class="f">_cmDspActiveMeasReset</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>          rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspActiveMeas_t">cmDspActiveMeas_t</a><span class="p">*</span> p  <span class="p">=</span> <span class="p">(</span><a href="#cmDspActiveMeas_t">cmDspActiveMeas_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspApplyAllDefaults">cmDspApplyAllDefaults</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">;</span>
  
  <span class="k">unsigned</span> cnt <span class="p">=</span> <a href="cmGlobal_h_0.html#cmMax">cmMax</a><span class="p">(</span><span class="l">100</span><span class="p">,</span><a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kCntAmId">kCntAmId</a><span class="p">)</span><span class="p">)</span><span class="p">;</span>
  <a href="#_cmDspActiveMeasFree">_cmDspActiveMeasFree</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
  <a href="#_cmDspAmAllocList">_cmDspAmAllocList</a><span class="p">(</span>p<span class="p">,</span>cnt<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspActiveMeasRecv_defn"></a><a name="_cmDspActiveMeasRecv"></a><span class="f">_cmDspActiveMeasRecv</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>          rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspActiveMeas_t">cmDspActiveMeas_t</a><span class="p">*</span> p  <span class="p">=</span> <span class="p">(</span><a href="#cmDspActiveMeas_t">cmDspActiveMeas_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
  
  <span class="k">switch</span><span class="p">(</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">)</span>
  <span class="p">{</span>
  <span class="k">case</span> <a href="#kSflocAmId">kSflocAmId</a><span class="p">:</span>
    <span class="p">{</span>
      
      <span class="k">unsigned</span>       sfloc  <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kSflocAmId">kSflocAmId</a><span class="p">)</span><span class="p">;</span>                  <span class="c"> // get the recv'd score location</span>
      <a href="#cmDspAmRecd_t">cmDspAmRecd_t</a><span class="p">*</span> rp     <span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>sent<span class="p">=</span><span class="p">=</span>NULL <span class="p">?</span> p<span class="p">-</span><span class="p">&gt</span>list <span class="p">:</span> p<span class="p">-</span><span class="p">&gt</span>sent<span class="p">-</span><span class="p">&gt</span>link<span class="p">;</span>     <span class="c"> // get the next recd to send</span>
      <span class="k">bool</span>           fl     <span class="p">=</span> false<span class="p">;</span>
      
      <span class="k">for</span><span class="p">(</span><span class="p">;</span> rp<span class="p">!</span><span class="p">=</span>NULL<span class="p">;</span> rp<span class="p">=</span>rp<span class="p">-</span><span class="p">&gt</span>link<span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> rp<span class="p">-</span><span class="p">&gt</span>loc <span class="p">&lt</span><span class="p">=</span> sfloc <span class="p">)</span>
      <span class="p">{</span>
        <span class="c">// deterimine the records type</span>
        <span class="k">unsigned</span> varId <span class="p">=</span> <a href="cmGlobal_h_0.html#cmInvalidId">cmInvalidId</a><span class="p">;</span>
        <span class="k">switch</span><span class="p">(</span> rp<span class="p">-</span><span class="p">&gt</span>type <span class="p">)</span>
        <span class="p">{</span>
        <span class="k">case</span> <a href="cmScore_h_0.html#kEvenVarScId">kEvenVarScId</a><span class="p">:</span>   varId <span class="p">=</span> <a href="#kEvenAmId">kEvenAmId</a><span class="p">;</span>  <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <a href="cmScore_h_0.html#kDynVarScId">kDynVarScId</a><span class="p">:</span>    varId <span class="p">=</span> <a href="#kDynAmId">kDynAmId</a><span class="p">;</span>   <span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <a href="cmScore_h_0.html#kTempoVarScId">kTempoVarScId</a><span class="p">:</span>  varId <span class="p">=</span> <a href="#kTempoAmId">kTempoAmId</a><span class="p">;</span> <span class="k">break</span><span class="p">;</span>
        <span class="k">default</span><span class="p">:</span>
          <span class="p">{</span> assert<span class="p">(</span><span class="l">0</span><span class="p">)</span><span class="p">;</span> <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="c">// Sending the location triggers the avail-ch to switch - so the location should only
        //  be sent once.</span>        
        <span class="k">if</span><span class="p">(</span> <span class="p">!</span>fl <span class="p">)</span>
        <span class="p">{</span>
          <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kScLocAmId">kScLocAmId</a><span class="p">,</span>rp<span class="p">-</span><span class="p">&gt</span>loc<span class="p">)</span><span class="p">;</span>
          fl <span class="p">=</span> true<span class="p">;</span>
        <span class="p">}</span>
        
        <span class="c">// transmit the records value and cost</span>
        <a href="cmDspClass_h_0.html#cmDspSetDouble">cmDspSetDouble</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>varId<span class="p">,</span>rp<span class="p">-</span><span class="p">&gt</span>value<span class="p">)</span><span class="p">;</span>
        <a href="cmDspClass_h_0.html#cmDspSetDouble">cmDspSetDouble</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kCostAmId">kCostAmId</a><span class="p">,</span>rp<span class="p">-</span><span class="p">&gt</span>cost<span class="p">)</span><span class="p">;</span>
        p<span class="p">-</span><span class="p">&gt</span>sent <span class="p">=</span> rp<span class="p">;</span>
      <span class="p">}</span>
      
    <span class="p">}</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kCmdAmId">kCmdAmId</a><span class="p">:</span>
    <span class="p">{</span>
      <span class="k">unsigned</span> cmdSymId <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspSymbol">cmDspSymbol</a><span class="p">(</span>inst<span class="p">,</span><a href="#kCmdAmId">kCmdAmId</a><span class="p">)</span><span class="p">;</span>
      
      <span class="k">if</span><span class="p">(</span> cmdSymId <span class="p">=</span><span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>addSymId <span class="p">)</span>
        rc <span class="p">=</span> <a href="#_cmDspActiveMeasAdd">_cmDspActiveMeasAdd</a><span class="p">(</span>ctx<span class="p">,</span>p<span class="p">,</span><a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kLocAmId">kLocAmId</a><span class="p">)</span><span class="p">,</span><a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kTypeAmId">kTypeAmId</a><span class="p">)</span><span class="p">,</span><a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kValueAmId">kValueAmId</a><span class="p">)</span><span class="p">,</span><a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kCstAmId">kCstAmId</a><span class="p">)</span><span class="p">)</span><span class="p">;</span>
      <span class="k">else</span>          
        <span class="k">if</span><span class="p">(</span> cmdSymId <span class="p">=</span><span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>clearSymId <span class="p">)</span>
          rc <span class="p">=</span> <a href="#_cmDspActiveMeasClear">_cmDspActiveMeasClear</a><span class="p">(</span>ctx<span class="p">,</span>p<span class="p">)</span><span class="p">;</span>
      <span class="k">else</span>
        <span class="k">if</span><span class="p">(</span> cmdSymId <span class="p">=</span><span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>printSymId <span class="p">)</span>
          rc <span class="p">=</span> <a href="#_cmDspActiveMeasPrint">_cmDspActiveMeasPrint</a><span class="p">(</span>ctx<span class="p">,</span>p<span class="p">)</span><span class="p">;</span>
      <span class="k">else</span>
        <span class="k">if</span><span class="p">(</span>cmdSymId <span class="p">=</span><span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>rewindSymId <span class="p">)</span>
          p<span class="p">-</span><span class="p">&gt</span>sent <span class="p">=</span> NULL<span class="p">;</span>
    <span class="p">}</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="p">}</span>
  
  <span class="c">//  switch( evt-&ampgtdstVarId )
  //  {
  //    case <a href="#kSflocAmId">kSflocAmId</a>:
  //      if( p-&ampgtnextFullIdx != <a href="cmGlobal_h_0.html#cmInvalidIdx">cmInvalidIdx</a> )
  //      {
  //        // get the recv'd score location
  //        unsigned sflocIdx = <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a>(inst,<a href="#kSflocAmId">kSflocAmId</a>);
  //
  //        unsigned prvLoc = <a href="cmGlobal_h_0.html#cmInvalidIdx">cmInvalidIdx</a>;
  //
  //        // for each remaining avail record
  //        for(; p-&ampgtnextFullIdx &amplt p-&ampgtnextEmptyIdx; p-&ampgtnextFullIdx++)
  //        {
  //          cmDspActiveMeasRecd_t* r = p-&ampgtarray + p-&ampgtnextFullIdx;
  //
  //          // if this records score location is after the recv'd score loc then we're done
  //          if( r-&ampgtloc &ampgt sflocIdx )
  //            break;
  //
  //          // deterimine the records type
  //          unsigned varId = <a href="cmGlobal_h_0.html#cmInvalidId">cmInvalidId</a>;
  //          switch( r-&ampgttype )
  //          {
  //            case <a href="cmScore_h_0.html#kEvenVarScId">kEvenVarScId</a>:   varId = <a href="#kEvenAmId">kEvenAmId</a>;  break;
  //            case <a href="cmScore_h_0.html#kDynVarScId">kDynVarScId</a>:    varId = <a href="#kDynAmId">kDynAmId</a>;   break;
  //            case <a href="cmScore_h_0.html#kTempoVarScId">kTempoVarScId</a>:  varId = <a href="#kTempoAmId">kTempoAmId</a>; break;
  //            default:
  //              { assert(0); }
  //          }
  //
  //          // if this score location has not yet been sent then send it now
  //          if( prvLoc != r-&ampgtloc )
  //            <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a>(ctx,inst,<a href="#kScLocAmId">kScLocAmId</a>,r-&ampgtloc);
  //
  //          // transmit the records value and cost
  //          <a href="cmDspClass_h_0.html#cmDspSetDouble">cmDspSetDouble</a>(ctx,inst,varId,r-&ampgtvalue);
  //          <a href="cmDspClass_h_0.html#cmDspSetDouble">cmDspSetDouble</a>(ctx,inst,<a href="#kCostAmId">kCostAmId</a>,r-&ampgtcost);
  //
  //          prvLoc = r-&ampgtloc;
  //        } 
  //        
  //
  //      }
  //      break;
  //
  //    case <a href="#kCmdAmId">kCmdAmId</a>:
  //      {
  //        unsigned cmdSymId = <a href="cmDspClass_h_0.html#cmDspSymbol">cmDspSymbol</a>(inst,<a href="#kCmdAmId">kCmdAmId</a>);
  //
  //        if( cmdSymId == p-&ampgtaddSymId )
  //        {
  //          if( p-&ampgtnextEmptyIdx &ampgt= p-&ampgtcnt )
  //            <a href="cmDspClass_h_0.html#cmDspInstErr">cmDspInstErr</a>(ctx,inst,<a href="cmDspClass_h_0.html#kProcFailDspRC">kProcFailDspRC</a>,&ampquotThe active measurement list is full cnt=%i.&ampquot,p-&ampgtcnt);
  //          else
  //          {
  //            cmDspActiveMeasRecd_t* r = p-&ampgtarray + p-&ampgtnextEmptyIdx;
  //            r-&ampgtloc   = <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a>(  inst,<a href="#kLocAmId">kLocAmId</a>);
  //            r-&ampgttype  = <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a>(  inst,<a href="#kTypeAmId">kTypeAmId</a>);
  //            r-&ampgtvalue = <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a>(inst,<a href="#kValueAmId">kValueAmId</a>);
  //            r-&ampgtcost  = <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a>(inst,<a href="#kCstAmId">kCstAmId</a>);
  //            p-&ampgtnextEmptyIdx += 1;
  //
  //            qsort(p-&ampgtarray,p-&ampgtnextEmptyIdx,sizeof(p-&ampgtarray[0]),cmDspActiveMeasRecdCompare);
  //
  //            if( p-&ampgtnextEmptyIdx == 1 &ampamp&ampamp p-&ampgtnextFullIdx == <a href="cmGlobal_h_0.html#cmInvalidIdx">cmInvalidIdx</a> )
  //              p-&ampgtnextFullIdx = 0;
  //
  //          }
  //        }
  //          
  //        if( cmdSymId == p-&ampgtclearSymId )
  //          rc = <a href="#_cmDspActiveMeasClear">_cmDspActiveMeasClear</a>(ctx,p);
  //        else
  //          if( cmdSymId == p-&ampgtprintSymId )
  //            rc = <a href="#_cmDspActiveMeasPrint">_cmDspActiveMeasPrint</a>(ctx,p);
  //          else
  //            if(cmdSymId == p-&ampgtrewindSymId )
  //              p-&ampgtnextFullIdx = 0;
  //      }
  //      break;
  //
  //  }</span>  
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>


<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> <a name="cmActiveMeasClassCons_defn"></a><span class="f"><a href="cmDspKr_h_0.html#cmActiveMeasClassCons">cmActiveMeasClassCons</a></span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspClassSetup">cmDspClassSetup</a><span class="p">(</span><span class="p">&amp</span>_cmActiveMeasDC<span class="p">,</span>ctx<span class="p">,</span><span class="l">&quotActiveMeas&quot</span><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspActiveMeasAlloc">_cmDspActiveMeasAlloc</a><span class="p">,</span>
  <a href="#_cmDspActiveMeasFree">_cmDspActiveMeasFree</a><span class="p">,</span>
  <a href="#_cmDspActiveMeasReset">_cmDspActiveMeasReset</a><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspActiveMeasRecv">_cmDspActiveMeasRecv</a><span class="p">,</span>
  NULL<span class="p">,</span>NULL<span class="p">,</span>
  <span class="l">&quotScale a value inside an input range to a value in the output range.&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>_cmActiveMeasDC<span class="p">;</span>
<span class="p">}</span>

<span class="c"><hr id="hr1"></span></pre>
</div>
<div class="cod"><div class="blk_title">cmDspAmSync : Calculate MIDI to Audio latency offsets.</div><pre><a name="cmDspAmSync"></a><span class="c">//
//
// Usage:
// 1)  In the program resource file setup a list of sync points.
// 'asmp' refers to a sample offset into the audio file 'af'
// which should match to the midi event index 'mid' in the
// midi file 'mf'.
//
//  amSync :
//  [
//   { af:&ampquotaf-16&ampquot asmp:34735276  mf:&ampquotmf-10&ampquot  mid:350 }
//   { af:&ampquotaf-16&ampquot asmp:71802194  mf:&ampquotmf-10&ampquot  mid:787 }
//  ]
//
// 2) Feed the 'fidx' output from a wave table loaded with 'af' into the 'asmp' input port of this amSync object.
//    Feed the 'id' output from the MIDI file player loaded with 'mf' into the 'mid' input port of this amSync object.
//
// 3) Run the players. 
// 4) When the run is complete send any message to the 'sel' port of this amSync object.
//    The 'frm:' field of the printed output gives the difference in samples between
//    MIDI and audio sync points.
//
//    If the value is positive then the MIDI point is after the Audio point.
//    If the value is negative then the MIDI point is before the audio point.
//</span>


<span class="k">enum</span>
<span class="p">{</span>
  <a name="kSelAmId"></a><span class="e">kSelAmId</span><span class="p">,</span>    
  <a name="kAFnAmId"></a><span class="e">kAFnAmId</span><span class="p">,</span>
  <a name="kASmpAmId"></a><span class="e">kASmpAmId</span><span class="p">,</span>
  <a name="kMFnAmId"></a><span class="e">kMFnAmId</span><span class="p">,</span>
  <a name="kMIdAmId"></a><span class="e">kMIdAmId</span><span class="p">,</span>
<span class="p">}</span><span class="p">;</span>

<span class="k">enum</span>
<span class="p">{</span>
  <a name="kAfnAmFl"></a><span class="e">kAfnAmFl</span> <span class="p">=</span> <span class="l">0x01</span><span class="p">,</span>
  <a name="kMfnAmFl"></a><span class="e">kMfnAmFl</span> <span class="p">=</span> <span class="l">0x02</span><span class="p">,</span>
  <a name="kAsmpAmFl"></a><span class="e">kAsmpAmFl</span> <span class="p">=</span> <span class="l">0x04</span><span class="p">,</span>
  <a name="kMidAmFl"></a><span class="e">kMidAmFl</span>  <span class="p">=</span> <span class="l">0x08</span><span class="p">,</span>
<span class="p">}</span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a> _cmAmSyncDC<span class="p">;</span>

<a name="cmDspAmSyncEntry_t"></a><span class="k">typedef</span> <span class="k">struct</span> <a name="cmDspAmSyncEntry_str"></a>cmDspAmSyncEntry_str
<span class="p">{</span>
  <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> <a name="cmDspAmSyncEntry_t.afn"></a><span class="i">afn</span><span class="p">;</span>  <span class="c"> // audio file name </span>
  <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> <a name="cmDspAmSyncEntry_t.mfn"></a><span class="i">mfn</span><span class="p">;</span>  <span class="c"> // midi file name </span>
  <span class="k">unsigned</span>        <a name="cmDspAmSyncEntry_t.asmp"></a><span class="i">asmp</span><span class="p">;</span> <span class="c"> // Audio sample index to sync to MIDI event</span>
  <span class="k">unsigned</span>        <a name="cmDspAmSyncEntry_t.mid"></a><span class="i">mid</span><span class="p">;</span>  <span class="c"> // MIDI event unique id (cmMidiTrackMsg_t.uid)</span>
  <span class="k">int</span>             <a name="cmDspAmSyncEntry_t.afi"></a><span class="i">afi</span><span class="p">;</span>  <span class="c"> // closest DSP system cycle index to the reference audio sample index (asmp).</span>
  <span class="k">int</span>             <a name="cmDspAmSyncEntry_t.mfi"></a><span class="i">mfi</span><span class="p">;</span>  <span class="c"> // DSP system cycle on which the reference MIDI event (mid) arrived.</span>
  <span class="k">unsigned</span>        <a name="cmDspAmSyncEntry_t.state"></a><span class="i">state</span><span class="p">;</span> <span class="c"> // as incoming msg match this record the state is updated with kXXXAmFl flags </span>
<span class="p">}</span> <span class="t"><a href="#cmDspAmSyncEntry_t">cmDspAmSyncEntry_t</a></span><span class="p">;</span>

<a name="cmDspAmSync_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a>         <a name="cmDspAmSync_t.inst"></a><span class="i">inst</span><span class="p">;</span>
  <a href="#cmDspAmSyncEntry_t">cmDspAmSyncEntry_t</a><span class="p">*</span> <a name="cmDspAmSync_t.array"></a><span class="i">array</span><span class="p">;</span>
  <span class="k">unsigned</span>            <a name="cmDspAmSync_t.arrayCnt"></a><span class="i">arrayCnt</span><span class="p">;</span>
  <a href="#cmDspAmSyncEntry_t">cmDspAmSyncEntry_t</a><span class="p">*</span> <a name="cmDspAmSync_t.acur"></a><span class="i">acur</span><span class="p">;</span>
  <a href="#cmDspAmSyncEntry_t">cmDspAmSyncEntry_t</a><span class="p">*</span> <a name="cmDspAmSync_t.mcur"></a><span class="i">mcur</span><span class="p">;</span>
<span class="p">}</span> <span class="t"><a href="#cmDspAmSync_t">cmDspAmSync_t</a></span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span>  <a name="_cmDspAmSyncAlloc_defn"></a><a name="_cmDspAmSyncAlloc"></a><span class="f">_cmDspAmSyncAlloc</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> classPtr<span class="p">,</span> <span class="k">unsigned</span> storeSymId<span class="p">,</span> <span class="k">unsigned</span> instSymId<span class="p">,</span> <span class="k">unsigned</span> id<span class="p">,</span> <span class="k">unsigned</span> va_cnt<span class="p">,</span> va_list vl <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspVarArg_t">cmDspVarArg_t</a> args<span class="p">[</span><span class="p">]</span> <span class="p">=</span>
  <span class="p">{</span>
    <span class="p">{</span> <span class="l">&quotsel&quot</span><span class="p">,</span>    <a href="#kSelAmId">kSelAmId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kTypeDsvMask">kTypeDsvMask</a><span class="p">,</span>  <span class="l">&quotPrint and reset&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotafn&quot</span><span class="p">,</span>    <a href="#kAFnAmId">kAFnAmId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kStrzDsvFl">kStrzDsvFl</a><span class="p">,</span> <span class="l">&quotAudio File name&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotasmp&quot</span><span class="p">,</span>   <a href="#kASmpAmId">kASmpAmId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kIntDsvFl">kIntDsvFl</a><span class="p">,</span>  <span class="l">&quotAudio sample index&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotmfn&quot</span><span class="p">,</span>    <a href="#kMFnAmId">kMFnAmId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kStrzDsvFl">kStrzDsvFl</a><span class="p">,</span> <span class="l">&quotMIDI File name&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotmid&quot</span><span class="p">,</span>    <a href="#kMIdAmId">kMIdAmId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kIntDsvFl">kIntDsvFl</a><span class="p">,</span>  <span class="l">&quotMIDI Event Unique Id&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> NULL<span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span> <span class="p">}</span>
  <span class="p">}</span><span class="p">;</span>
  
  <a href="#cmDspAmSync_t">cmDspAmSync_t</a><span class="p">*</span> p <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstAlloc">cmDspInstAlloc</a><span class="p">(</span><a href="#cmDspAmSync_t">cmDspAmSync_t</a><span class="p">,</span>ctx<span class="p">,</span>classPtr<span class="p">,</span>args<span class="p">,</span>instSymId<span class="p">,</span>id<span class="p">,</span>storeSymId<span class="p">,</span>va_cnt<span class="p">,</span>vl<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspAmSyncFree_defn"></a><a name="_cmDspAmSyncFree"></a><span class="f">_cmDspAmSyncFree</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspAmSync_t">cmDspAmSync_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspAmSync_t">cmDspAmSync_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <a href="cmMallocDebug_h_0.html#cmMemFree">cmMemFree</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>array<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
<span class="p">}</span>


<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspAmSyncReset_defn"></a><a name="_cmDspAmSyncReset"></a><span class="f">_cmDspAmSyncReset</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>      rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspAmSync_t">cmDspAmSync_t</a><span class="p">*</span> p  <span class="p">=</span> <span class="p">(</span><a href="#cmDspAmSync_t">cmDspAmSync_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspApplyAllDefaults">cmDspApplyAllDefaults</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">;</span>
  
  <a href="cmJson_h_0.html#cmJsonH_t">cmJsonH_t</a>       jsH <span class="p">=</span> <a href="cmDspSys_h_0.html#cmDspSysPgmRsrcHandle">cmDspSysPgmRsrcHandle</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>dspH<span class="p">)</span><span class="p">;</span>
  <a href="cmJson_h_0.html#cmJsonNode_t">cmJsonNode_t</a><span class="p">*</span>   np<span class="p">;</span>
  <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> errLabelPtr<span class="p">;</span>
  <span class="k">unsigned</span>        i<span class="p">;</span>
  <a href="cmJson_h_0.html#cmJsRC_t">cmJsRC_t</a>        jsRC<span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span><span class="p">(</span>np <span class="p">=</span> <a href="cmJson_h_0.html#cmJsonFindValue">cmJsonFindValue</a><span class="p">(</span>jsH<span class="p">,</span> <span class="l">&quotamSync&quot</span><span class="p">,</span> NULL<span class="p">,</span> <a href="cmJson_h_0.html#kArrayTId">kArrayTId</a><span class="p">)</span><span class="p">)</span> <span class="p">=</span><span class="p">=</span> NULL <span class="p">)</span>
  <span class="p">{</span>
    rc <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstErr">cmDspInstErr</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="cmDspClass_h_0.html#kRsrcNotFoundDspRC">kRsrcNotFoundDspRC</a><span class="p">,</span><span class="l">&quotThe AUDIO MIDI Sync cfg. record was not found.&quot</span><span class="p">)</span><span class="p">;</span>
    goto errLabel<span class="p">;</span> 
  <span class="p">}</span>
  
  p<span class="p">-</span><span class="p">&gt</span>arrayCnt <span class="p">=</span> <a href="cmJson_h_0.html#cmJsonChildCount">cmJsonChildCount</a><span class="p">(</span>np<span class="p">)</span><span class="p">;</span>
  
  p<span class="p">-</span><span class="p">&gt</span>array    <span class="p">=</span> <a href="cmMallocDebug_h_0.html#cmMemResizeZ">cmMemResizeZ</a><span class="p">(</span><a href="#cmDspAmSyncEntry_t">cmDspAmSyncEntry_t</a><span class="p">,</span>p<span class="p">-</span><span class="p">&gt</span>array<span class="p">,</span>p<span class="p">-</span><span class="p">&gt</span>arrayCnt<span class="p">)</span><span class="p">;</span>
  
  <span class="k">for</span><span class="p">(</span>i<span class="p">=</span><span class="l">0</span><span class="p">;</span> i<span class="p">&lt</span>p<span class="p">-</span><span class="p">&gt</span>arrayCnt<span class="p">;</span> <span class="p">+</span><span class="p">+</span>i<span class="p">)</span>
  <span class="p">{</span>
    <a href="cmJson_h_0.html#cmJsonNode_t">cmJsonNode_t</a><span class="p">*</span> anp <span class="p">=</span> <a href="cmJson_h_0.html#cmJsonArrayElement">cmJsonArrayElement</a><span class="p">(</span>np<span class="p">,</span>i<span class="p">)</span><span class="p">;</span>
    
    <a href="#cmDspAmSyncEntry_t">cmDspAmSyncEntry_t</a><span class="p">*</span> r <span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>array <span class="p">+</span> i<span class="p">;</span>
    <span class="k">if</span><span class="p">(</span> <span class="p">(</span>jsRC <span class="p">=</span> <a href="cmJson_h_0.html#cmJsonMemberValues">cmJsonMemberValues</a><span class="p">(</span>anp<span class="p">,</span><span class="p">&amp</span>errLabelPtr<span class="p">,</span>
    <span class="l">&quotaf&quot</span><span class="p">,</span>  <a href="cmJson_h_0.html#kStringTId">kStringTId</a><span class="p">,</span><span class="p">&amp</span>r<span class="p">-</span><span class="p">&gt</span>afn<span class="p">,</span>
    <span class="l">&quotasmp&quot</span><span class="p">,</span><a href="cmJson_h_0.html#kIntTId">kIntTId</a><span class="p">,</span>   <span class="p">&amp</span>r<span class="p">-</span><span class="p">&gt</span>asmp<span class="p">,</span>
    <span class="l">&quotmf&quot</span><span class="p">,</span>  <a href="cmJson_h_0.html#kStringTId">kStringTId</a><span class="p">,</span><span class="p">&amp</span>r<span class="p">-</span><span class="p">&gt</span>mfn<span class="p">,</span>
    <span class="l">&quotmid&quot</span><span class="p">,</span> <a href="cmJson_h_0.html#kIntTId">kIntTId</a><span class="p">,</span>   <span class="p">&amp</span>r<span class="p">-</span><span class="p">&gt</span>mid<span class="p">,</span> 
    NULL<span class="p">)</span><span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmJson_h_0.html#kOkJsRC">kOkJsRC</a> <span class="p">)</span>
    <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span> jsRC <span class="p">=</span><span class="p">=</span> <a href="cmJson_h_0.html#kNodeNotFoundJsRC">kNodeNotFoundJsRC</a> <span class="p">)</span>
        rc <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstErr">cmDspInstErr</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="cmDspClass_h_0.html#kRsrcNotFoundDspRC">kRsrcNotFoundDspRC</a><span class="p">,</span><span class="l">&quotThe Audio-MIDI Sync cfg. field '%s' was missing in the cfg. record at index %i.&quot</span><span class="p">,</span>errLabelPtr<span class="p">,</span>i<span class="p">)</span><span class="p">;</span>
      <span class="k">else</span>
        rc <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstErr">cmDspInstErr</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="cmDspClass_h_0.html#kInvalidArgDspRC">kInvalidArgDspRC</a><span class="p">,</span><span class="l">&quotThe AUDIO MIDI Sync cfg. parse failed on the record at index %i.&quot</span><span class="p">,</span>i<span class="p">)</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    r<span class="p">-</span><span class="p">&gt</span>afi <span class="p">=</span> <a href="cmGlobal_h_0.html#cmInvalidIdx">cmInvalidIdx</a><span class="p">;</span>
    r<span class="p">-</span><span class="p">&gt</span>mfi <span class="p">=</span> <a href="cmGlobal_h_0.html#cmInvalidIdx">cmInvalidIdx</a><span class="p">;</span>
    r<span class="p">-</span><span class="p">&gt</span>state <span class="p">=</span> <span class="l">0</span><span class="p">;</span>
  <span class="p">}</span>
  
  errLabel<span class="p">:</span>
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>


<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspAmSyncRecv_defn"></a><a name="_cmDspAmSyncRecv"></a><span class="f">_cmDspAmSyncRecv</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span> 
  <a href="#cmDspAmSync_t">cmDspAmSync_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspAmSync_t">cmDspAmSync_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  <span class="k">unsigned</span> i<span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">!</span><span class="p">=</span> <a href="#kSelAmId">kSelAmId</a> <span class="p">)</span>
    <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
  
  <span class="k">switch</span><span class="p">(</span>evt<span class="p">-</span><span class="p">&gt</span>dstVarId<span class="p">)</span>
  <span class="p">{</span>
  <span class="k">case</span> <a href="#kSelAmId">kSelAmId</a><span class="p">:</span>    
    <span class="p">{</span>
      <span class="k">double</span> srate <span class="p">=</span> <a href="cmDspSys_h_0.html#cmDspSysSampleRate">cmDspSysSampleRate</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>dspH<span class="p">)</span><span class="p">;</span>
      <span class="k">int</span>    fpc   <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspSamplesPerCycle">cmDspSamplesPerCycle</a><span class="p">(</span>ctx<span class="p">)</span><span class="p">;</span>
      
      <span class="k">for</span><span class="p">(</span>i<span class="p">=</span><span class="l">0</span><span class="p">;</span> i<span class="p">&lt</span>p<span class="p">-</span><span class="p">&gt</span>arrayCnt<span class="p">;</span> <span class="p">+</span><span class="p">+</span>i<span class="p">)</span>
      <span class="p">{</span>
        <a href="#cmDspAmSyncEntry_t">cmDspAmSyncEntry_t</a><span class="p">*</span> r <span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>array <span class="p">+</span> i<span class="p">;</span>
        
        <span class="k">int</span> dframes <span class="p">=</span> r<span class="p">-</span><span class="p">&gt</span>mfi<span class="p">-</span>r<span class="p">-</span><span class="p">&gt</span>afi<span class="p">;</span> 
        <a href="cmRpt_h_0.html#cmRptPrintf">cmRptPrintf</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>rpt<span class="p">,</span><span class="l">&quot0x%x : %s %i %i - %s %i  %i : frm:%i smp:%i sec:%f\n&quot</span><span class="p">,</span>
        r<span class="p">-</span><span class="p">&gt</span>state<span class="p">,</span>
        r<span class="p">-</span><span class="p">&gt</span>afn<span class="p">,</span>
        r<span class="p">-</span><span class="p">&gt</span>asmp<span class="p">,</span>
        r<span class="p">-</span><span class="p">&gt</span>afi<span class="p">,</span>
        r<span class="p">-</span><span class="p">&gt</span>mfn<span class="p">,</span>
        r<span class="p">-</span><span class="p">&gt</span>mid<span class="p">,</span>
        r<span class="p">-</span><span class="p">&gt</span>mfi<span class="p">,</span>
        dframes<span class="p">,</span>
        dframes<span class="p">*</span>fpc<span class="p">,</span>dframes<span class="p">*</span>fpc<span class="p">/</span>srate<span class="p">)</span><span class="p">;</span>
        
        r<span class="p">-</span><span class="p">&gt</span>afi <span class="p">=</span> <a href="cmGlobal_h_0.html#cmInvalidIdx">cmInvalidIdx</a><span class="p">;</span>
        r<span class="p">-</span><span class="p">&gt</span>mfi <span class="p">=</span> <a href="cmGlobal_h_0.html#cmInvalidIdx">cmInvalidIdx</a><span class="p">;</span>
        r<span class="p">-</span><span class="p">&gt</span>state <span class="p">=</span> <span class="l">0</span><span class="p">;</span>
        
      <span class="p">}</span>   
      p<span class="p">-</span><span class="p">&gt</span>acur <span class="p">=</span> NULL<span class="p">;</span>
      p<span class="p">-</span><span class="p">&gt</span>mcur <span class="p">=</span> NULL<span class="p">;</span>
    <span class="p">}</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kAFnAmId">kAFnAmId</a><span class="p">:</span>
    <span class="p">{</span>
      <span class="c">// an audio file name just arrived - set p-&ampgtacur to point to it</span>
      <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> fn <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspStrcz">cmDspStrcz</a><span class="p">(</span>inst<span class="p">,</span> <a href="#kAFnAmId">kAFnAmId</a> <span class="p">)</span><span class="p">;</span>
      
      <span class="k">for</span><span class="p">(</span>i<span class="p">=</span><span class="l">0</span><span class="p">;</span> i<span class="p">&lt</span>p<span class="p">-</span><span class="p">&gt</span>arrayCnt<span class="p">;</span> <span class="p">+</span><span class="p">+</span>i<span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> strcmp<span class="p">(</span>fn<span class="p">,</span>p<span class="p">-</span><span class="p">&gt</span>array<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>afn<span class="p">)</span> <span class="p">=</span><span class="p">=</span> <span class="l">0</span> <span class="p">)</span>
      <span class="p">{</span>
        p<span class="p">-</span><span class="p">&gt</span>array<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>state <span class="p">=</span> <a href="cmGlobal_h_0.html#cmSetFlag">cmSetFlag</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>array<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>state<span class="p">,</span><a href="#kAfnAmFl">kAfnAmFl</a><span class="p">)</span><span class="p">;</span>
        p<span class="p">-</span><span class="p">&gt</span>acur <span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>array <span class="p">+</span> i<span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kMFnAmId">kMFnAmId</a><span class="p">:</span>
    <span class="p">{</span>
      <span class="c">// a midi file name just arrived - set p-&ampgtmcur to point to it</span>
      <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> fn <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspStrcz">cmDspStrcz</a><span class="p">(</span>inst<span class="p">,</span> <a href="#kMFnAmId">kMFnAmId</a> <span class="p">)</span><span class="p">;</span>
      <span class="k">for</span><span class="p">(</span>i<span class="p">=</span><span class="l">0</span><span class="p">;</span> i<span class="p">&lt</span>p<span class="p">-</span><span class="p">&gt</span>arrayCnt<span class="p">;</span> <span class="p">+</span><span class="p">+</span>i<span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> strcmp<span class="p">(</span>fn<span class="p">,</span>p<span class="p">-</span><span class="p">&gt</span>array<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>mfn<span class="p">)</span> <span class="p">=</span><span class="p">=</span> <span class="l">0</span> <span class="p">)</span>
      <span class="p">{</span>
        p<span class="p">-</span><span class="p">&gt</span>array<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>state <span class="p">=</span> <a href="cmGlobal_h_0.html#cmSetFlag">cmSetFlag</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>array<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>state<span class="p">,</span><a href="#kMfnAmFl">kMfnAmFl</a><span class="p">)</span><span class="p">;</span>
        p<span class="p">-</span><span class="p">&gt</span>mcur <span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>array <span class="p">+</span> i<span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kASmpAmId">kASmpAmId</a><span class="p">:</span>
    <span class="p">{</span>
      <span class="c">// a audio file sample index has just arrived</span>
      <span class="k">int</span> v <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInt">cmDspInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kASmpAmId">kASmpAmId</a><span class="p">)</span><span class="p">;</span> 
      
      <span class="c">// if a valid audio file has been set</span>
      <span class="k">if</span><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>acur <span class="p">!</span><span class="p">=</span> NULL <span class="p">)</span>
        <span class="k">for</span><span class="p">(</span>i<span class="p">=</span><span class="l">0</span><span class="p">;</span> i<span class="p">&lt</span>p<span class="p">-</span><span class="p">&gt</span>arrayCnt<span class="p">;</span> <span class="p">+</span><span class="p">+</span>i<span class="p">)</span>
      <span class="p">{</span>
        <span class="c">// if the audio sync point is before or on the new audio file sample index then 
        // this is the closest audio file index to the audio sync point - record the 
        // associated cycleCnt</span>        
        <a href="#cmDspAmSyncEntry_t">cmDspAmSyncEntry_t</a><span class="p">*</span> r <span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>array <span class="p">+</span> i<span class="p">;</span>
        <span class="k">if</span><span class="p">(</span> <a href="cmGlobal_h_0.html#cmIsNotFlag">cmIsNotFlag</a><span class="p">(</span>r<span class="p">-</span><span class="p">&gt</span>state<span class="p">,</span><a href="#kAsmpAmFl">kAsmpAmFl</a><span class="p">)</span>  <span class="p">&amp</span><span class="p">&amp</span> r<span class="p">-</span><span class="p">&gt</span>asmp <span class="p">&lt</span><span class="p">=</span> v <span class="p">&amp</span><span class="p">&amp</span> strcmp<span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>acur<span class="p">-</span><span class="p">&gt</span>afn<span class="p">,</span>r<span class="p">-</span><span class="p">&gt</span>afn<span class="p">)</span><span class="p">=</span><span class="p">=</span><span class="l">0</span>  <span class="p">)</span>
        <span class="p">{</span>
          r<span class="p">-</span><span class="p">&gt</span>afi <span class="p">=</span> ctx<span class="p">-</span><span class="p">&gt</span>cycleCnt<span class="p">;</span>
          r<span class="p">-</span><span class="p">&gt</span>state <span class="p">=</span> <a href="cmGlobal_h_0.html#cmSetFlag">cmSetFlag</a><span class="p">(</span>r<span class="p">-</span><span class="p">&gt</span>state<span class="p">,</span><a href="#kAsmpAmFl">kAsmpAmFl</a><span class="p">)</span><span class="p">;</span>
          <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kMIdAmId">kMIdAmId</a><span class="p">:</span>
    <span class="p">{</span>
      <span class="c">// a new MIDI event was received </span>
      <span class="k">int</span> v <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInt">cmDspInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kMIdAmId">kMIdAmId</a><span class="p">)</span><span class="p">;</span>
      <span class="k">if</span><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>mcur <span class="p">!</span><span class="p">=</span> NULL <span class="p">)</span>
        <span class="k">for</span><span class="p">(</span>i<span class="p">=</span><span class="l">0</span><span class="p">;</span> i<span class="p">&lt</span>p<span class="p">-</span><span class="p">&gt</span>arrayCnt<span class="p">;</span> <span class="p">+</span><span class="p">+</span>i<span class="p">)</span>
      <span class="p">{</span>
        <span class="c">// if the new MIDI event matched the MIDI sync point then record the 
        // current cycleCnt.</span>        
        <a href="#cmDspAmSyncEntry_t">cmDspAmSyncEntry_t</a><span class="p">*</span> r <span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>array <span class="p">+</span> i<span class="p">;</span>
        <span class="k">if</span><span class="p">(</span> <a href="cmGlobal_h_0.html#cmIsNotFlag">cmIsNotFlag</a><span class="p">(</span>r<span class="p">-</span><span class="p">&gt</span>state<span class="p">,</span><a href="#kMidAmFl">kMidAmFl</a><span class="p">)</span>  <span class="p">&amp</span><span class="p">&amp</span> r<span class="p">-</span><span class="p">&gt</span>mid <span class="p">=</span><span class="p">=</span> v <span class="p">&amp</span><span class="p">&amp</span> strcmp<span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>mcur<span class="p">-</span><span class="p">&gt</span>mfn<span class="p">,</span>r<span class="p">-</span><span class="p">&gt</span>mfn<span class="p">)</span><span class="p">=</span><span class="p">=</span><span class="l">0</span>  <span class="p">)</span>
        <span class="p">{</span>
          r<span class="p">-</span><span class="p">&gt</span>mfi <span class="p">=</span> ctx<span class="p">-</span><span class="p">&gt</span>cycleCnt<span class="p">;</span>
          r<span class="p">-</span><span class="p">&gt</span>state <span class="p">=</span> <a href="cmGlobal_h_0.html#cmSetFlag">cmSetFlag</a><span class="p">(</span>r<span class="p">-</span><span class="p">&gt</span>state<span class="p">,</span><a href="#kMidAmFl">kMidAmFl</a><span class="p">)</span><span class="p">;</span>          
          <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      
    <span class="p">}</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="p">}</span>
  <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> <a name="cmAmSyncClassCons_defn"></a><span class="f"><a href="cmDspKr_h_0.html#cmAmSyncClassCons">cmAmSyncClassCons</a></span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspClassSetup">cmDspClassSetup</a><span class="p">(</span><span class="p">&amp</span>_cmAmSyncDC<span class="p">,</span>ctx<span class="p">,</span><span class="l">&quotAmSync&quot</span><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspAmSyncAlloc">_cmDspAmSyncAlloc</a><span class="p">,</span>
  <a href="#_cmDspAmSyncFree">_cmDspAmSyncFree</a><span class="p">,</span>
  <a href="#_cmDspAmSyncReset">_cmDspAmSyncReset</a><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspAmSyncRecv">_cmDspAmSyncRecv</a><span class="p">,</span>
  NULL<span class="p">,</span>NULL<span class="p">,</span>
  <span class="l">&quotAudio - MIDI Sync Object.&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>_cmAmSyncDC<span class="p">;</span>
<span class="p">}</span>

<span class="c"><hr id="hr1"></span></pre>
</div>
<div class="cod"><div class="blk_title">cmDspNanoMap : Control a MIDI synth.</div><pre><a name="cmDspNanoMap"></a>
<span class="k">enum</span>
<span class="p">{</span>
  <a name="kPgmNmId"></a><span class="e">kPgmNmId</span><span class="p">,</span>
  <a name="kStatusNmId"></a><span class="e">kStatusNmId</span><span class="p">,</span>
  <a name="kD0NmId"></a><span class="e">kD0NmId</span><span class="p">,</span>
  <a name="kD1NmId"></a><span class="e">kD1NmId</span><span class="p">,</span>
  <a name="kThruNmId"></a><span class="e">kThruNmId</span>
<span class="p">}</span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a> _cmNanoMapDC<span class="p">;</span>

<a name="cmDspNanoMap_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a> <a name="cmDspNanoMap_t.inst"></a><span class="i">inst</span><span class="p">;</span>
  
<span class="p">}</span> <span class="t"><a href="#cmDspNanoMap_t">cmDspNanoMap_t</a></span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspNanoMapSend_defn"></a><a name="_cmDspNanoMapSend"></a><span class="f">_cmDspNanoMapSend</span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">unsigned</span> st<span class="p">,</span> <span class="k">unsigned</span> d0<span class="p">,</span> <span class="k">unsigned</span> d1 <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kD1NmId">kD1NmId</a><span class="p">,</span>d1<span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kD0NmId">kD0NmId</a><span class="p">,</span>d0<span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kStatusNmId">kStatusNmId</a><span class="p">,</span>st<span class="p">)</span><span class="p">;</span>
  <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
<span class="p">}</span>

<span class="k">void</span> <a name="_cmDspNanoMapPgm_defn"></a><a name="_cmDspNanoMapPgm"></a><span class="f">_cmDspNanoMapPgm</span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">unsigned</span> pgm <span class="p">)</span>
<span class="p">{</span>
  <span class="c">//<a href="#cmDspNanoMap_t">cmDspNanoMap_t</a>* p = (<a href="#cmDspNanoMap_t">cmDspNanoMap_t</a>*)inst;</span>
  
  <span class="k">unsigned</span> i<span class="p">;</span>
  
  <span class="k">for</span><span class="p">(</span>i<span class="p">=</span><span class="l">0</span><span class="p">;</span> i<span class="p">&lt</span><a href="cmMidi_h_0.html#kMidiChCnt">kMidiChCnt</a><span class="p">;</span> <span class="p">+</span><span class="p">+</span>i<span class="p">)</span>
  <span class="p">{</span>
    <a href="#_cmDspNanoMapSend">_cmDspNanoMapSend</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="cmMidi_h_0.html#kCtlMdId">kCtlMdId</a><span class="p">+</span>i<span class="p">,</span><span class="l">121</span><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span> <span class="c"> // reset all controllers</span>
    <a href="#_cmDspNanoMapSend">_cmDspNanoMapSend</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="cmMidi_h_0.html#kCtlMdId">kCtlMdId</a><span class="p">+</span>i<span class="p">,</span><span class="l">123</span><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span> <span class="c"> // turn all notes off</span>
    <a href="#_cmDspNanoMapSend">_cmDspNanoMapSend</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="cmMidi_h_0.html#kCtlMdId">kCtlMdId</a><span class="p">+</span>i<span class="p">,</span><span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>   <span class="c"> // switch to bank 0</span>
    <a href="#_cmDspNanoMapSend">_cmDspNanoMapSend</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="cmMidi_h_0.html#kPgmMdId">kPgmMdId</a><span class="p">+</span>i<span class="p">,</span>pgm<span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span> <span class="c"> // send pgm change</span>
    <a href="cmThread_h_0.html#cmSleepMs">cmSleepMs</a><span class="p">(</span><span class="l">15</span><span class="p">)</span><span class="p">;</span>
  <span class="p">}</span>
  
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span>  <a name="_cmDspNanoMapAlloc_defn"></a><a name="_cmDspNanoMapAlloc"></a><span class="f">_cmDspNanoMapAlloc</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> classPtr<span class="p">,</span> <span class="k">unsigned</span> storeSymId<span class="p">,</span> <span class="k">unsigned</span> instSymId<span class="p">,</span> <span class="k">unsigned</span> id<span class="p">,</span> <span class="k">unsigned</span> va_cnt<span class="p">,</span> va_list vl <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspVarArg_t">cmDspVarArg_t</a> args<span class="p">[</span><span class="p">]</span> <span class="p">=</span>
  <span class="p">{</span>
    <span class="p">{</span> <span class="l">&quotpgm&quot</span><span class="p">,</span>    <a href="#kPgmNmId">kPgmNmId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span>  <span class="l">0</span><span class="p">,</span>              <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span> <span class="l">&quotReprogram all channels to this pgm.&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotstatus&quot</span><span class="p">,</span> <a href="#kStatusNmId">kStatusNmId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span>  <span class="l">0</span><span class="p">,</span>  <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span> <span class="l">&quotMIDI status&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotd0&quot</span><span class="p">,</span>     <a href="#kD0NmId">kD0NmId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>  <span class="l">0</span><span class="p">,</span>  <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span> <span class="l">&quotMIDI channel message d0&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotd1&quot</span><span class="p">,</span>     <a href="#kD1NmId">kD1NmId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>  <span class="l">0</span><span class="p">,</span>  <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span> <span class="l">&quotMIDI channel message d1&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotthru&quot</span><span class="p">,</span>   <a href="#kThruNmId">kThruNmId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span>  <span class="l">0</span><span class="p">,</span>              <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kBoolDsvFl">kBoolDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span> <span class="l">&quotEnable pass through.&quot</span><span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> NULL<span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span> <span class="p">}</span>
  <span class="p">}</span><span class="p">;</span>
  
  <a href="#cmDspNanoMap_t">cmDspNanoMap_t</a><span class="p">*</span> p <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstAlloc">cmDspInstAlloc</a><span class="p">(</span><a href="#cmDspNanoMap_t">cmDspNanoMap_t</a><span class="p">,</span>ctx<span class="p">,</span>classPtr<span class="p">,</span>args<span class="p">,</span>instSymId<span class="p">,</span>id<span class="p">,</span>storeSymId<span class="p">,</span>va_cnt<span class="p">,</span>vl<span class="p">)</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kPgmNmId">kPgmNmId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span> <span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspNanoMapReset_defn"></a><a name="_cmDspNanoMapReset"></a><span class="f">_cmDspNanoMapReset</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>      rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspApplyAllDefaults">cmDspApplyAllDefaults</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">;</span>
  
  <a href="#_cmDspNanoMapPgm">_cmDspNanoMapPgm</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kPgmNmId">kPgmNmId</a><span class="p">)</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span> 

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspNanoMapRecv_defn"></a><a name="_cmDspNanoMapRecv"></a><span class="f">_cmDspNanoMapRecv</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <span class="c">//<a href="#cmDspNanoMap_t">cmDspNanoMap_t</a>* p = (<a href="#cmDspNanoMap_t">cmDspNanoMap_t</a>*)inst;</span>
  
  <span class="k">switch</span><span class="p">(</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">)</span>
  <span class="p">{</span>
  <span class="k">case</span> <a href="#kPgmNmId">kPgmNmId</a><span class="p">:</span>
    <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
    <a href="#_cmDspNanoMapPgm">_cmDspNanoMapPgm</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kPgmNmId">kPgmNmId</a><span class="p">)</span><span class="p">)</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kStatusNmId">kStatusNmId</a><span class="p">:</span>
    <span class="p">{</span>
      <span class="k">unsigned</span> status <span class="p">=</span> <a href="cmDspValue_h_0.html#cmDsvGetUInt">cmDsvGetUInt</a><span class="p">(</span>evt<span class="p">-</span><span class="p">&gt</span>valuePtr<span class="p">)</span><span class="p">;</span>        
      <span class="k">unsigned</span> stat_no_ch <span class="p">=</span> status <span class="p">&amp</span> <span class="l">0xf0</span><span class="p">;</span>
      <span class="k">if</span><span class="p">(</span> stat_no_ch <span class="p">=</span><span class="p">=</span> <a href="cmMidi_h_0.html#kNoteOnMdId">kNoteOnMdId</a> <span class="p">|</span><span class="p">|</span> stat_no_ch <span class="p">=</span><span class="p">=</span> <a href="cmMidi_h_0.html#kNoteOffMdId">kNoteOffMdId</a> <span class="p">|</span><span class="p">|</span> stat_no_ch <span class="p">=</span><span class="p">=</span> <a href="cmMidi_h_0.html#kCtlMdId">kCtlMdId</a>  <span class="p">)</span>
      <span class="p">{</span>
        <span class="c">//unsigned d0 = <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a>(inst,<a href="#kD0NmId">kD0NmId</a>);</span>
        <span class="k">unsigned</span> ch <span class="p">=</span> <span class="l">0</span><span class="p">;</span> <span class="c"> // d0 % 8;</span>
        status <span class="p">=</span> <span class="p">(</span>status <span class="p">&amp</span> <span class="l">0xf0</span><span class="p">)</span> <span class="p">+</span> ch<span class="p">;</span>
        <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kStatusNmId">kStatusNmId</a><span class="p">,</span>status<span class="p">)</span><span class="p">;</span>
      <span class="p">}</span>
      
    <span class="p">}</span>
    <span class="k">break</span><span class="p">;</span>
    
    
  <span class="k">default</span><span class="p">:</span>
    <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="p">}</span>
  
  
  <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> <a name="cmNanoMapClassCons_defn"></a><span class="f"><a href="cmDspKr_h_0.html#cmNanoMapClassCons">cmNanoMapClassCons</a></span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspClassSetup">cmDspClassSetup</a><span class="p">(</span><span class="p">&amp</span>_cmNanoMapDC<span class="p">,</span>ctx<span class="p">,</span><span class="l">&quotNanoMap&quot</span><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspNanoMapAlloc">_cmDspNanoMapAlloc</a><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspNanoMapReset">_cmDspNanoMapReset</a><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspNanoMapRecv">_cmDspNanoMapRecv</a><span class="p">,</span>
  NULL<span class="p">,</span>
  NULL<span class="p">,</span>
  <span class="l">&quotNanosynth Mapper&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>_cmNanoMapDC<span class="p">;</span>
<span class="p">}</span>

<span class="c"><hr id="hr1"></span></pre>
</div>
<div class="cod"><div class="blk_title">cmDspPicadae : Control the Picadae piano mechanism.</div><pre><a name="cmDspPicadae"></a>
<span class="k">enum</span>
<span class="p">{</span>
  <a name="kStatusPcId"></a><span class="e">kStatusPcId</span><span class="p">,</span>
  <a name="kD0PcId"></a><span class="e">kD0PcId</span><span class="p">,</span>
  <a name="kD1PcId"></a><span class="e">kD1PcId</span><span class="p">,</span>
  <a name="kAllOffPcId"></a><span class="e">kAllOffPcId</span>
<span class="p">}</span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a> _cmPicadaeDC<span class="p">;</span>

<a name="cmDspPicadaeVelMap_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <span class="k">unsigned</span> <a name="cmDspPicadaeVelMap_t.pitch"></a><span class="i">pitch</span><span class="p">;</span>
  <span class="k">unsigned</span> <a name="cmDspPicadaeVelMap_t.velMapA"></a><span class="i">velMapA</span><span class="p">[</span><span class="l">10</span><span class="p">]</span><span class="p">;</span>
<span class="p">}</span> <span class="t"><a href="#cmDspPicadaeVelMap_t">cmDspPicadaeVelMap_t</a></span><span class="p">;</span>

<span class="c">// This table is generated from picadae_ac_3/velTableToDataStruct.py </span>

<a href="#cmDspPicadaeVelMap_t">cmDspPicadaeVelMap_t</a> cmDspPicadaeVelMap<span class="p">[</span><span class="p">]</span> <span class="p">=</span>
<span class="p">{</span>
  <span class="p">{</span> <span class="l">21</span><span class="p">,</span><span class="p">{</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">22</span><span class="p">,</span><span class="p">{</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">23</span><span class="p">,</span> <span class="p">{</span> <span class="l">12800</span><span class="p">,</span> <span class="l">12950</span><span class="p">,</span> <span class="l">13175</span><span class="p">,</span> <span class="l">13500</span><span class="p">,</span> <span class="l">13750</span><span class="p">,</span> <span class="l">14750</span><span class="p">,</span> <span class="l">15375</span><span class="p">,</span> <span class="l">17500</span><span class="p">,</span> <span class="l">23000</span><span class="p">,</span> <span class="l">37000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">24</span><span class="p">,</span> <span class="p">{</span> <span class="l">12425</span><span class="p">,</span> <span class="l">12800</span><span class="p">,</span> <span class="l">13175</span><span class="p">,</span> <span class="l">14225</span><span class="p">,</span> <span class="l">14750</span><span class="p">,</span> <span class="l">15500</span><span class="p">,</span> <span class="l">17500</span><span class="p">,</span> <span class="l">22500</span><span class="p">,</span> <span class="l">32000</span><span class="p">,</span> <span class="l">39000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">25</span><span class="p">,</span> <span class="p">{</span> <span class="l">14150</span><span class="p">,</span> <span class="l">14375</span><span class="p">,</span> <span class="l">14975</span><span class="p">,</span> <span class="l">14625</span><span class="p">,</span> <span class="l">15500</span><span class="p">,</span> <span class="l">16500</span><span class="p">,</span> <span class="l">20000</span><span class="p">,</span> <span class="l">28500</span><span class="p">,</span> <span class="l">40000</span><span class="p">,</span> <span class="l">40000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">26</span><span class="p">,</span> <span class="p">{</span> <span class="l">13000</span><span class="p">,</span> <span class="l">13175</span><span class="p">,</span> <span class="l">13500</span><span class="p">,</span> <span class="l">13700</span><span class="p">,</span> <span class="l">13925</span><span class="p">,</span> <span class="l">14250</span><span class="p">,</span> <span class="l">15000</span><span class="p">,</span> <span class="l">16250</span><span class="p">,</span> <span class="l">19000</span><span class="p">,</span> <span class="l">26500</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">27</span><span class="p">,</span> <span class="p">{</span> <span class="l">13625</span><span class="p">,</span> <span class="l">13925</span><span class="p">,</span> <span class="l">14075</span><span class="p">,</span> <span class="l">14250</span><span class="p">,</span> <span class="l">14500</span><span class="p">,</span> <span class="l">14875</span><span class="p">,</span> <span class="l">15375</span><span class="p">,</span> <span class="l">16500</span><span class="p">,</span> <span class="l">18750</span><span class="p">,</span> <span class="l">25000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">28</span><span class="p">,</span> <span class="p">{</span> <span class="l">12625</span><span class="p">,</span> <span class="l">13750</span><span class="p">,</span> <span class="l">13775</span><span class="p">,</span> <span class="l">14225</span><span class="p">,</span> <span class="l">14500</span><span class="p">,</span> <span class="l">16500</span><span class="p">,</span> <span class="l">18000</span><span class="p">,</span> <span class="l">20000</span><span class="p">,</span> <span class="l">25500</span><span class="p">,</span> <span class="l">34000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">29</span><span class="p">,</span> <span class="p">{</span> <span class="l">12125</span><span class="p">,</span> <span class="l">12725</span><span class="p">,</span> <span class="l">13000</span><span class="p">,</span> <span class="l">12950</span><span class="p">,</span> <span class="l">14150</span><span class="p">,</span> <span class="l">15500</span><span class="p">,</span> <span class="l">16250</span><span class="p">,</span> <span class="l">17750</span><span class="p">,</span> <span class="l">21500</span><span class="p">,</span> <span class="l">28000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">30</span><span class="p">,</span> <span class="p">{</span> <span class="l">13175</span><span class="p">,</span> <span class="l">13325</span><span class="p">,</span> <span class="l">13550</span><span class="p">,</span> <span class="l">14450</span><span class="p">,</span> <span class="l">14875</span><span class="p">,</span> <span class="l">15500</span><span class="p">,</span> <span class="l">16250</span><span class="p">,</span> <span class="l">17750</span><span class="p">,</span> <span class="l">21500</span><span class="p">,</span> <span class="l">27000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">31</span><span class="p">,</span> <span class="p">{</span> <span class="l">13925</span><span class="p">,</span> <span class="l">14075</span><span class="p">,</span> <span class="l">14450</span><span class="p">,</span> <span class="l">14625</span><span class="p">,</span> <span class="l">15500</span><span class="p">,</span> <span class="l">16250</span><span class="p">,</span> <span class="l">16750</span><span class="p">,</span> <span class="l">17750</span><span class="p">,</span> <span class="l">19500</span><span class="p">,</span> <span class="l">23500</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">32</span><span class="p">,</span> <span class="p">{</span> <span class="l">13250</span><span class="p">,</span> <span class="l">14150</span><span class="p">,</span> <span class="l">14975</span><span class="p">,</span> <span class="l">14750</span><span class="p">,</span> <span class="l">15250</span><span class="p">,</span> <span class="l">16000</span><span class="p">,</span> <span class="l">17500</span><span class="p">,</span> <span class="l">21000</span><span class="p">,</span> <span class="l">27000</span><span class="p">,</span> <span class="l">38000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">33</span><span class="p">,</span> <span class="p">{</span> <span class="l">11825</span><span class="p">,</span> <span class="l">13025</span><span class="p">,</span> <span class="l">14075</span><span class="p">,</span> <span class="l">14825</span><span class="p">,</span> <span class="l">14375</span><span class="p">,</span> <span class="l">14875</span><span class="p">,</span> <span class="l">16250</span><span class="p">,</span> <span class="l">17500</span><span class="p">,</span> <span class="l">22000</span><span class="p">,</span> <span class="l">28000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">34</span><span class="p">,</span> <span class="p">{</span> <span class="l">13025</span><span class="p">,</span> <span class="l">13375</span><span class="p">,</span> <span class="l">13325</span><span class="p">,</span> <span class="l">13775</span><span class="p">,</span> <span class="l">14375</span><span class="p">,</span> <span class="l">14500</span><span class="p">,</span> <span class="l">15250</span><span class="p">,</span> <span class="l">18000</span><span class="p">,</span> <span class="l">22000</span><span class="p">,</span> <span class="l">27000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">35</span><span class="p">,</span> <span class="p">{</span> <span class="l">11375</span><span class="p">,</span> <span class="l">12250</span><span class="p">,</span> <span class="l">12350</span><span class="p">,</span> <span class="l">12725</span><span class="p">,</span> <span class="l">14225</span><span class="p">,</span> <span class="l">13750</span><span class="p">,</span> <span class="l">15375</span><span class="p">,</span> <span class="l">17000</span><span class="p">,</span> <span class="l">20500</span><span class="p">,</span> <span class="l">25000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">36</span><span class="p">,</span> <span class="p">{</span> <span class="l">11750</span><span class="p">,</span> <span class="l">13875</span><span class="p">,</span> <span class="l">14125</span><span class="p">,</span> <span class="l">14225</span><span class="p">,</span> <span class="l">14675</span><span class="p">,</span> <span class="l">14750</span><span class="p">,</span> <span class="l">16500</span><span class="p">,</span> <span class="l">18500</span><span class="p">,</span> <span class="l">22500</span><span class="p">,</span> <span class="l">32000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">37</span><span class="p">,</span> <span class="p">{</span> <span class="l">12425</span><span class="p">,</span> <span class="l">12575</span><span class="p">,</span> <span class="l">13000</span><span class="p">,</span> <span class="l">13025</span><span class="p">,</span> <span class="l">13375</span><span class="p">,</span> <span class="l">15000</span><span class="p">,</span> <span class="l">16000</span><span class="p">,</span> <span class="l">18750</span><span class="p">,</span> <span class="l">25500</span><span class="p">,</span> <span class="l">35000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">38</span><span class="p">,</span> <span class="p">{</span> <span class="l">13750</span><span class="p">,</span> <span class="l">13875</span><span class="p">,</span> <span class="l">14075</span><span class="p">,</span> <span class="l">14600</span><span class="p">,</span> <span class="l">14750</span><span class="p">,</span> <span class="l">15500</span><span class="p">,</span> <span class="l">17750</span><span class="p">,</span> <span class="l">21500</span><span class="p">,</span> <span class="l">27500</span><span class="p">,</span> <span class="l">37000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">39</span><span class="p">,</span> <span class="p">{</span> <span class="l">11000</span><span class="p">,</span> <span class="l">12500</span><span class="p">,</span> <span class="l">12950</span><span class="p">,</span> <span class="l">13700</span><span class="p">,</span> <span class="l">14875</span><span class="p">,</span> <span class="l">15500</span><span class="p">,</span> <span class="l">16250</span><span class="p">,</span> <span class="l">20000</span><span class="p">,</span> <span class="l">26500</span><span class="p">,</span> <span class="l">37000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">40</span><span class="p">,</span> <span class="p">{</span> <span class="l">11525</span><span class="p">,</span> <span class="l">11750</span><span class="p">,</span> <span class="l">12125</span><span class="p">,</span> <span class="l">12500</span><span class="p">,</span> <span class="l">12875</span><span class="p">,</span> <span class="l">13500</span><span class="p">,</span> <span class="l">14625</span><span class="p">,</span> <span class="l">18250</span><span class="p">,</span> <span class="l">23500</span><span class="p">,</span> <span class="l">29000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">41</span><span class="p">,</span> <span class="p">{</span> <span class="l">11675</span><span class="p">,</span> <span class="l">11750</span><span class="p">,</span> <span class="l">12500</span><span class="p">,</span> <span class="l">13000</span><span class="p">,</span> <span class="l">13925</span><span class="p">,</span> <span class="l">15250</span><span class="p">,</span> <span class="l">17000</span><span class="p">,</span> <span class="l">20000</span><span class="p">,</span> <span class="l">26500</span><span class="p">,</span> <span class="l">36000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">42</span><span class="p">,</span> <span class="p">{</span> <span class="l">11875</span><span class="p">,</span> <span class="l">12000</span><span class="p">,</span> <span class="l">11975</span><span class="p">,</span> <span class="l">12050</span><span class="p">,</span> <span class="l">12275</span><span class="p">,</span> <span class="l">13375</span><span class="p">,</span> <span class="l">15000</span><span class="p">,</span> <span class="l">17250</span><span class="p">,</span> <span class="l">22000</span><span class="p">,</span> <span class="l">29000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">43</span><span class="p">,</span> <span class="p">{</span> <span class="l">11500</span><span class="p">,</span> <span class="l">11625</span><span class="p">,</span> <span class="l">11750</span><span class="p">,</span> <span class="l">11750</span><span class="p">,</span> <span class="l">12625</span><span class="p">,</span> <span class="l">12250</span><span class="p">,</span> <span class="l">13625</span><span class="p">,</span> <span class="l">16750</span><span class="p">,</span> <span class="l">19500</span><span class="p">,</span> <span class="l">25500</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">44</span><span class="p">,</span> <span class="p">{</span> <span class="l">12425</span><span class="p">,</span> <span class="l">12500</span><span class="p">,</span> <span class="l">12750</span><span class="p">,</span> <span class="l">12650</span><span class="p">,</span> <span class="l">13000</span><span class="p">,</span> <span class="l">14000</span><span class="p">,</span> <span class="l">15250</span><span class="p">,</span> <span class="l">16500</span><span class="p">,</span> <span class="l">20000</span><span class="p">,</span> <span class="l">27000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">45</span><span class="p">,</span> <span class="p">{</span> <span class="l">11250</span><span class="p">,</span> <span class="l">11600</span><span class="p">,</span> <span class="l">11875</span><span class="p">,</span> <span class="l">12000</span><span class="p">,</span> <span class="l">12250</span><span class="p">,</span> <span class="l">13100</span><span class="p">,</span> <span class="l">14750</span><span class="p">,</span> <span class="l">15500</span><span class="p">,</span> <span class="l">18250</span><span class="p">,</span> <span class="l">25500</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">46</span><span class="p">,</span> <span class="p">{</span> <span class="l">11450</span><span class="p">,</span> <span class="l">11525</span><span class="p">,</span> <span class="l">11600</span><span class="p">,</span> <span class="l">11625</span><span class="p">,</span> <span class="l">11875</span><span class="p">,</span> <span class="l">12250</span><span class="p">,</span> <span class="l">14000</span><span class="p">,</span> <span class="l">15750</span><span class="p">,</span> <span class="l">17750</span><span class="p">,</span> <span class="l">21500</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">47</span><span class="p">,</span> <span class="p">{</span> <span class="l">11900</span><span class="p">,</span> <span class="l">11975</span><span class="p">,</span> <span class="l">12125</span><span class="p">,</span> <span class="l">12375</span><span class="p">,</span> <span class="l">13125</span><span class="p">,</span> <span class="l">14375</span><span class="p">,</span> <span class="l">15750</span><span class="p">,</span> <span class="l">18750</span><span class="p">,</span> <span class="l">22500</span><span class="p">,</span> <span class="l">28500</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">48</span><span class="p">,</span> <span class="p">{</span> <span class="l">11750</span><span class="p">,</span> <span class="l">13100</span><span class="p">,</span> <span class="l">13325</span><span class="p">,</span> <span class="l">13625</span><span class="p">,</span> <span class="l">14300</span><span class="p">,</span> <span class="l">14975</span><span class="p">,</span> <span class="l">15750</span><span class="p">,</span> <span class="l">19000</span><span class="p">,</span> <span class="l">24000</span><span class="p">,</span> <span class="l">30000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">49</span><span class="p">,</span> <span class="p">{</span> <span class="l">11975</span><span class="p">,</span> <span class="l">12050</span><span class="p">,</span> <span class="l">12500</span><span class="p">,</span> <span class="l">12750</span><span class="p">,</span> <span class="l">13125</span><span class="p">,</span> <span class="l">14000</span><span class="p">,</span> <span class="l">17000</span><span class="p">,</span> <span class="l">20000</span><span class="p">,</span> <span class="l">25500</span><span class="p">,</span> <span class="l">40000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">50</span><span class="p">,</span> <span class="p">{</span> <span class="l">11625</span><span class="p">,</span> <span class="l">11525</span><span class="p">,</span> <span class="l">11750</span><span class="p">,</span> <span class="l">11825</span><span class="p">,</span> <span class="l">12125</span><span class="p">,</span> <span class="l">12375</span><span class="p">,</span> <span class="l">14750</span><span class="p">,</span> <span class="l">16250</span><span class="p">,</span> <span class="l">19000</span><span class="p">,</span> <span class="l">25500</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">51</span><span class="p">,</span> <span class="p">{</span> <span class="l">12050</span><span class="p">,</span> <span class="l">12125</span><span class="p">,</span> <span class="l">12125</span><span class="p">,</span> <span class="l">12275</span><span class="p">,</span> <span class="l">12350</span><span class="p">,</span> <span class="l">12500</span><span class="p">,</span> <span class="l">12875</span><span class="p">,</span> <span class="l">16250</span><span class="p">,</span> <span class="l">18500</span><span class="p">,</span> <span class="l">22500</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">52</span><span class="p">,</span> <span class="p">{</span> <span class="l">12950</span><span class="p">,</span> <span class="l">13025</span><span class="p">,</span> <span class="l">13125</span><span class="p">,</span> <span class="l">13175</span><span class="p">,</span> <span class="l">13250</span><span class="p">,</span> <span class="l">13500</span><span class="p">,</span> <span class="l">13875</span><span class="p">,</span> <span class="l">15750</span><span class="p">,</span> <span class="l">18000</span><span class="p">,</span> <span class="l">22000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">53</span><span class="p">,</span> <span class="p">{</span> <span class="l">10600</span><span class="p">,</span> <span class="l">10250</span><span class="p">,</span> <span class="l">10350</span><span class="p">,</span> <span class="l">10450</span><span class="p">,</span> <span class="l">10900</span><span class="p">,</span> <span class="l">11375</span><span class="p">,</span> <span class="l">13025</span><span class="p">,</span> <span class="l">14750</span><span class="p">,</span> <span class="l">18250</span><span class="p">,</span> <span class="l">26500</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">54</span><span class="p">,</span> <span class="p">{</span> <span class="l">12650</span><span class="p">,</span> <span class="l">12625</span><span class="p">,</span> <span class="l">12725</span><span class="p">,</span> <span class="l">12800</span><span class="p">,</span> <span class="l">13000</span><span class="p">,</span> <span class="l">13625</span><span class="p">,</span> <span class="l">16250</span><span class="p">,</span> <span class="l">18500</span><span class="p">,</span> <span class="l">23000</span><span class="p">,</span> <span class="l">32000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">55</span><span class="p">,</span> <span class="p">{</span> <span class="l">11875</span><span class="p">,</span> <span class="l">12125</span><span class="p">,</span> <span class="l">12250</span><span class="p">,</span> <span class="l">12425</span><span class="p">,</span> <span class="l">12875</span><span class="p">,</span> <span class="l">13175</span><span class="p">,</span> <span class="l">13750</span><span class="p">,</span> <span class="l">17250</span><span class="p">,</span> <span class="l">20000</span><span class="p">,</span> <span class="l">26000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">56</span><span class="p">,</span> <span class="p">{</span> <span class="l">11625</span><span class="p">,</span> <span class="l">11750</span><span class="p">,</span> <span class="l">12000</span><span class="p">,</span> <span class="l">12200</span><span class="p">,</span> <span class="l">12500</span><span class="p">,</span> <span class="l">13125</span><span class="p">,</span> <span class="l">14375</span><span class="p">,</span> <span class="l">17000</span><span class="p">,</span> <span class="l">20500</span><span class="p">,</span> <span class="l">26500</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">57</span><span class="p">,</span> <span class="p">{</span> <span class="l">11625</span><span class="p">,</span> <span class="l">11750</span><span class="p">,</span> <span class="l">12125</span><span class="p">,</span> <span class="l">12275</span><span class="p">,</span> <span class="l">12750</span><span class="p">,</span> <span class="l">14625</span><span class="p">,</span> <span class="l">16750</span><span class="p">,</span> <span class="l">20000</span><span class="p">,</span> <span class="l">25500</span><span class="p">,</span> <span class="l">39000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">58</span><span class="p">,</span> <span class="p">{</span> <span class="l">12000</span><span class="p">,</span> <span class="l">12500</span><span class="p">,</span> <span class="l">12750</span><span class="p">,</span> <span class="l">12875</span><span class="p">,</span> <span class="l">13100</span><span class="p">,</span> <span class="l">13375</span><span class="p">,</span> <span class="l">15000</span><span class="p">,</span> <span class="l">17750</span><span class="p">,</span> <span class="l">21000</span><span class="p">,</span> <span class="l">28000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">59</span><span class="p">,</span> <span class="p">{</span> <span class="l">11625</span><span class="p">,</span> <span class="l">11525</span><span class="p">,</span> <span class="l">12050</span><span class="p">,</span> <span class="l">13375</span><span class="p">,</span> <span class="l">13625</span><span class="p">,</span> <span class="l">14150</span><span class="p">,</span> <span class="l">16500</span><span class="p">,</span> <span class="l">21000</span><span class="p">,</span> <span class="l">24500</span><span class="p">,</span> <span class="l">30000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">60</span><span class="p">,</span> <span class="p">{</span> <span class="l">12250</span><span class="p">,</span> <span class="l">12250</span><span class="p">,</span> <span class="l">12375</span><span class="p">,</span> <span class="l">12350</span><span class="p">,</span> <span class="l">13000</span><span class="p">,</span> <span class="l">13500</span><span class="p">,</span> <span class="l">16000</span><span class="p">,</span> <span class="l">17750</span><span class="p">,</span> <span class="l">22000</span><span class="p">,</span> <span class="l">29000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">61</span><span class="p">,</span> <span class="p">{</span> <span class="l">11375</span><span class="p">,</span> <span class="l">11500</span><span class="p">,</span> <span class="l">11625</span><span class="p">,</span> <span class="l">11750</span><span class="p">,</span> <span class="l">12000</span><span class="p">,</span> <span class="l">12200</span><span class="p">,</span> <span class="l">12725</span><span class="p">,</span> <span class="l">13625</span><span class="p">,</span> <span class="l">17500</span><span class="p">,</span> <span class="l">21000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">62</span><span class="p">,</span> <span class="p">{</span> <span class="l">11600</span><span class="p">,</span> <span class="l">11675</span><span class="p">,</span> <span class="l">11825</span><span class="p">,</span> <span class="l">12125</span><span class="p">,</span> <span class="l">12650</span><span class="p">,</span> <span class="l">13375</span><span class="p">,</span> <span class="l">14375</span><span class="p">,</span> <span class="l">18500</span><span class="p">,</span> <span class="l">24500</span><span class="p">,</span> <span class="l">32000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">63</span><span class="p">,</span> <span class="p">{</span> <span class="l">12125</span><span class="p">,</span> <span class="l">12200</span><span class="p">,</span> <span class="l">12350</span><span class="p">,</span> <span class="l">12500</span><span class="p">,</span> <span class="l">13025</span><span class="p">,</span> <span class="l">13625</span><span class="p">,</span> <span class="l">16250</span><span class="p">,</span> <span class="l">18750</span><span class="p">,</span> <span class="l">24500</span><span class="p">,</span> <span class="l">36000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">64</span><span class="p">,</span> <span class="p">{</span> <span class="l">10550</span><span class="p">,</span> <span class="l">10650</span><span class="p">,</span> <span class="l">10850</span><span class="p">,</span> <span class="l">11250</span><span class="p">,</span> <span class="l">11875</span><span class="p">,</span> <span class="l">12250</span><span class="p">,</span> <span class="l">14000</span><span class="p">,</span> <span class="l">16250</span><span class="p">,</span> <span class="l">19500</span><span class="p">,</span> <span class="l">26500</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">65</span><span class="p">,</span> <span class="p">{</span> <span class="l">12750</span><span class="p">,</span> <span class="l">12800</span><span class="p">,</span> <span class="l">12875</span><span class="p">,</span> <span class="l">13175</span><span class="p">,</span> <span class="l">13250</span><span class="p">,</span> <span class="l">14625</span><span class="p">,</span> <span class="l">14975</span><span class="p">,</span> <span class="l">17500</span><span class="p">,</span> <span class="l">20500</span><span class="p">,</span> <span class="l">26000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">66</span><span class="p">,</span> <span class="p">{</span> <span class="l">10750</span><span class="p">,</span> <span class="l">11000</span><span class="p">,</span> <span class="l">11250</span><span class="p">,</span> <span class="l">11500</span><span class="p">,</span> <span class="l">12000</span><span class="p">,</span> <span class="l">12875</span><span class="p">,</span> <span class="l">15375</span><span class="p">,</span> <span class="l">17000</span><span class="p">,</span> <span class="l">20500</span><span class="p">,</span> <span class="l">28500</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">67</span><span class="p">,</span> <span class="p">{</span> <span class="l">10950</span><span class="p">,</span> <span class="l">11125</span><span class="p">,</span> <span class="l">11250</span><span class="p">,</span> <span class="l">11500</span><span class="p">,</span> <span class="l">11875</span><span class="p">,</span> <span class="l">13875</span><span class="p">,</span> <span class="l">15750</span><span class="p">,</span> <span class="l">17750</span><span class="p">,</span> <span class="l">23000</span><span class="p">,</span> <span class="l">37000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">68</span><span class="p">,</span> <span class="p">{</span> <span class="l">10150</span><span class="p">,</span> <span class="l">10300</span><span class="p">,</span> <span class="l">10550</span><span class="p">,</span> <span class="l">10800</span><span class="p">,</span> <span class="l">11125</span><span class="p">,</span> <span class="l">11875</span><span class="p">,</span> <span class="l">13000</span><span class="p">,</span> <span class="l">16000</span><span class="p">,</span> <span class="l">19000</span><span class="p">,</span> <span class="l">25000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">69</span><span class="p">,</span> <span class="p">{</span> <span class="l">11750</span><span class="p">,</span> <span class="l">11875</span><span class="p">,</span> <span class="l">12375</span><span class="p">,</span> <span class="l">12500</span><span class="p">,</span> <span class="l">12750</span><span class="p">,</span> <span class="l">13500</span><span class="p">,</span> <span class="l">16250</span><span class="p">,</span> <span class="l">18250</span><span class="p">,</span> <span class="l">23500</span><span class="p">,</span> <span class="l">31000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">70</span><span class="p">,</span> <span class="p">{</span> <span class="l">10700</span><span class="p">,</span> <span class="l">10850</span><span class="p">,</span> <span class="l">10950</span><span class="p">,</span> <span class="l">11125</span><span class="p">,</span> <span class="l">11625</span><span class="p">,</span> <span class="l">13875</span><span class="p">,</span> <span class="l">14500</span><span class="p">,</span> <span class="l">15750</span><span class="p">,</span> <span class="l">18750</span><span class="p">,</span> <span class="l">24500</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">71</span><span class="p">,</span> <span class="p">{</span> <span class="l">10200</span><span class="p">,</span> <span class="l">10700</span><span class="p">,</span> <span class="l">11000</span><span class="p">,</span> <span class="l">11250</span><span class="p">,</span> <span class="l">11625</span><span class="p">,</span> <span class="l">14000</span><span class="p">,</span> <span class="l">14875</span><span class="p">,</span> <span class="l">16250</span><span class="p">,</span> <span class="l">22000</span><span class="p">,</span> <span class="l">27000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">72</span><span class="p">,</span> <span class="p">{</span>  <span class="l">9800</span><span class="p">,</span> <span class="l">10100</span><span class="p">,</span> <span class="l">10400</span><span class="p">,</span> <span class="l">10550</span><span class="p">,</span> <span class="l">11000</span><span class="p">,</span> <span class="l">11625</span><span class="p">,</span> <span class="l">13000</span><span class="p">,</span> <span class="l">15500</span><span class="p">,</span> <span class="l">17750</span><span class="p">,</span> <span class="l">23000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">73</span><span class="p">,</span> <span class="p">{</span> <span class="l">10750</span><span class="p">,</span> <span class="l">10900</span><span class="p">,</span> <span class="l">11125</span><span class="p">,</span> <span class="l">11375</span><span class="p">,</span> <span class="l">11625</span><span class="p">,</span> <span class="l">12750</span><span class="p">,</span> <span class="l">14750</span><span class="p">,</span> <span class="l">15500</span><span class="p">,</span> <span class="l">18500</span><span class="p">,</span> <span class="l">23000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">74</span><span class="p">,</span> <span class="p">{</span> <span class="l">10300</span><span class="p">,</span> <span class="l">10450</span><span class="p">,</span> <span class="l">10600</span><span class="p">,</span> <span class="l">10850</span><span class="p">,</span> <span class="l">11250</span><span class="p">,</span> <span class="l">12000</span><span class="p">,</span> <span class="l">14250</span><span class="p">,</span> <span class="l">15000</span><span class="p">,</span> <span class="l">17500</span><span class="p">,</span> <span class="l">21000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">75</span><span class="p">,</span> <span class="p">{</span> <span class="l">10600</span><span class="p">,</span> <span class="l">10750</span><span class="p">,</span> <span class="l">10900</span><span class="p">,</span> <span class="l">11125</span><span class="p">,</span> <span class="l">12500</span><span class="p">,</span> <span class="l">14500</span><span class="p">,</span> <span class="l">14750</span><span class="p">,</span> <span class="l">15000</span><span class="p">,</span> <span class="l">21000</span><span class="p">,</span> <span class="l">31000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">76</span><span class="p">,</span> <span class="p">{</span> <span class="l">10200</span><span class="p">,</span> <span class="l">11625</span><span class="p">,</span> <span class="l">12375</span><span class="p">,</span> <span class="l">12875</span><span class="p">,</span> <span class="l">13500</span><span class="p">,</span> <span class="l">15750</span><span class="p">,</span> <span class="l">19000</span><span class="p">,</span> <span class="l">22500</span><span class="p">,</span> <span class="l">27500</span><span class="p">,</span> <span class="l">39000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">77</span><span class="p">,</span> <span class="p">{</span> <span class="l">10500</span><span class="p">,</span> <span class="l">10700</span><span class="p">,</span> <span class="l">11125</span><span class="p">,</span> <span class="l">11375</span><span class="p">,</span> <span class="l">11750</span><span class="p">,</span> <span class="l">14000</span><span class="p">,</span> <span class="l">14875</span><span class="p">,</span> <span class="l">16500</span><span class="p">,</span> <span class="l">20500</span><span class="p">,</span> <span class="l">27000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">78</span><span class="p">,</span> <span class="p">{</span> <span class="l">10450</span><span class="p">,</span> <span class="l">10800</span><span class="p">,</span> <span class="l">11000</span><span class="p">,</span> <span class="l">11625</span><span class="p">,</span> <span class="l">12000</span><span class="p">,</span> <span class="l">13125</span><span class="p">,</span> <span class="l">15500</span><span class="p">,</span> <span class="l">18250</span><span class="p">,</span> <span class="l">22000</span><span class="p">,</span> <span class="l">34000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">79</span><span class="p">,</span> <span class="p">{</span> <span class="l">12250</span><span class="p">,</span> <span class="l">13500</span><span class="p">,</span> <span class="l">14125</span><span class="p">,</span> <span class="l">14750</span><span class="p">,</span> <span class="l">16250</span><span class="p">,</span> <span class="l">17500</span><span class="p">,</span> <span class="l">19000</span><span class="p">,</span> <span class="l">24500</span><span class="p">,</span> <span class="l">31000</span><span class="p">,</span> <span class="l">40000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">80</span><span class="p">,</span> <span class="p">{</span> <span class="l">10400</span><span class="p">,</span> <span class="l">10450</span><span class="p">,</span> <span class="l">10750</span><span class="p">,</span> <span class="l">11125</span><span class="p">,</span> <span class="l">12125</span><span class="p">,</span> <span class="l">13375</span><span class="p">,</span> <span class="l">14750</span><span class="p">,</span> <span class="l">17750</span><span class="p">,</span> <span class="l">23000</span><span class="p">,</span> <span class="l">39000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">81</span><span class="p">,</span> <span class="p">{</span> <span class="l">10800</span><span class="p">,</span> <span class="l">10950</span><span class="p">,</span> <span class="l">11125</span><span class="p">,</span> <span class="l">11375</span><span class="p">,</span> <span class="l">12625</span><span class="p">,</span> <span class="l">13875</span><span class="p">,</span> <span class="l">14875</span><span class="p">,</span> <span class="l">16000</span><span class="p">,</span> <span class="l">19000</span><span class="p">,</span> <span class="l">23500</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">82</span><span class="p">,</span> <span class="p">{</span> <span class="l">12000</span><span class="p">,</span> <span class="l">12375</span><span class="p">,</span> <span class="l">13750</span><span class="p">,</span> <span class="l">13750</span><span class="p">,</span> <span class="l">12625</span><span class="p">,</span> <span class="l">14000</span><span class="p">,</span> <span class="l">17000</span><span class="p">,</span> <span class="l">19000</span><span class="p">,</span> <span class="l">21000</span><span class="p">,</span> <span class="l">24500</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">83</span><span class="p">,</span> <span class="p">{</span> <span class="l">12250</span><span class="p">,</span> <span class="l">12500</span><span class="p">,</span> <span class="l">13625</span><span class="p">,</span> <span class="l">13875</span><span class="p">,</span> <span class="l">14375</span><span class="p">,</span> <span class="l">16500</span><span class="p">,</span> <span class="l">17750</span><span class="p">,</span> <span class="l">20500</span><span class="p">,</span> <span class="l">25000</span><span class="p">,</span> <span class="l">35000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">84</span><span class="p">,</span> <span class="p">{</span> <span class="l">11500</span><span class="p">,</span> <span class="l">12000</span><span class="p">,</span> <span class="l">12250</span><span class="p">,</span> <span class="l">12500</span><span class="p">,</span> <span class="l">13125</span><span class="p">,</span> <span class="l">14250</span><span class="p">,</span> <span class="l">15375</span><span class="p">,</span> <span class="l">16750</span><span class="p">,</span> <span class="l">19500</span><span class="p">,</span> <span class="l">25500</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">85</span><span class="p">,</span> <span class="p">{</span> <span class="l">10400</span><span class="p">,</span> <span class="l">10500</span><span class="p">,</span> <span class="l">10600</span><span class="p">,</span> <span class="l">11250</span><span class="p">,</span> <span class="l">12250</span><span class="p">,</span> <span class="l">13375</span><span class="p">,</span> <span class="l">15000</span><span class="p">,</span> <span class="l">16750</span><span class="p">,</span> <span class="l">20000</span><span class="p">,</span> <span class="l">26000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">86</span><span class="p">,</span> <span class="p">{</span> <span class="l">11500</span><span class="p">,</span> <span class="l">11750</span><span class="p">,</span> <span class="l">11875</span><span class="p">,</span> <span class="l">12000</span><span class="p">,</span> <span class="l">12250</span><span class="p">,</span> <span class="l">12500</span><span class="p">,</span> <span class="l">13500</span><span class="p">,</span> <span class="l">15000</span><span class="p">,</span> <span class="l">20500</span><span class="p">,</span> <span class="l">21000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">87</span><span class="p">,</span> <span class="p">{</span> <span class="l">10650</span><span class="p">,</span> <span class="l">11500</span><span class="p">,</span> <span class="l">13125</span><span class="p">,</span> <span class="l">13375</span><span class="p">,</span> <span class="l">13750</span><span class="p">,</span> <span class="l">14500</span><span class="p">,</span> <span class="l">16500</span><span class="p">,</span> <span class="l">18000</span><span class="p">,</span> <span class="l">20000</span><span class="p">,</span> <span class="l">24000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">88</span><span class="p">,</span> <span class="p">{</span> <span class="l">11375</span><span class="p">,</span> <span class="l">11375</span><span class="p">,</span> <span class="l">11500</span><span class="p">,</span> <span class="l">12375</span><span class="p">,</span> <span class="l">12000</span><span class="p">,</span> <span class="l">13375</span><span class="p">,</span> <span class="l">14500</span><span class="p">,</span> <span class="l">16500</span><span class="p">,</span> <span class="l">19000</span><span class="p">,</span> <span class="l">23000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">89</span><span class="p">,</span> <span class="p">{</span>  <span class="l">9200</span><span class="p">,</span> <span class="l">10900</span><span class="p">,</span> <span class="l">11500</span><span class="p">,</span> <span class="l">12125</span><span class="p">,</span> <span class="l">22000</span><span class="p">,</span> <span class="l">12875</span><span class="p">,</span> <span class="l">14125</span><span class="p">,</span> <span class="l">16000</span><span class="p">,</span> <span class="l">19000</span><span class="p">,</span> <span class="l">26500</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">90</span><span class="p">,</span> <span class="p">{</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">91</span><span class="p">,</span> <span class="p">{</span>  <span class="l">9450</span><span class="p">,</span>  <span class="l">9950</span><span class="p">,</span> <span class="l">10000</span><span class="p">,</span> <span class="l">10150</span><span class="p">,</span> <span class="l">10600</span><span class="p">,</span> <span class="l">11250</span><span class="p">,</span> <span class="l">12125</span><span class="p">,</span> <span class="l">13875</span><span class="p">,</span> <span class="l">15250</span><span class="p">,</span> <span class="l">19000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">92</span><span class="p">,</span> <span class="p">{</span>  <span class="l">9050</span><span class="p">,</span>  <span class="l">9500</span><span class="p">,</span>  <span class="l">9600</span><span class="p">,</span> <span class="l">10100</span><span class="p">,</span> <span class="l">10900</span><span class="p">,</span> <span class="l">11875</span><span class="p">,</span> <span class="l">13000</span><span class="p">,</span> <span class="l">16000</span><span class="p">,</span> <span class="l">20500</span><span class="p">,</span> <span class="l">31000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">93</span><span class="p">,</span> <span class="p">{</span> <span class="l">11250</span><span class="p">,</span> <span class="l">11375</span><span class="p">,</span> <span class="l">12000</span><span class="p">,</span> <span class="l">12375</span><span class="p">,</span> <span class="l">12875</span><span class="p">,</span> <span class="l">13625</span><span class="p">,</span> <span class="l">14250</span><span class="p">,</span> <span class="l">17500</span><span class="p">,</span> <span class="l">21500</span><span class="p">,</span> <span class="l">39000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">94</span><span class="p">,</span> <span class="p">{</span> <span class="l">11125</span><span class="p">,</span> <span class="l">11375</span><span class="p">,</span> <span class="l">11750</span><span class="p">,</span> <span class="l">13500</span><span class="p">,</span> <span class="l">14000</span><span class="p">,</span> <span class="l">14875</span><span class="p">,</span> <span class="l">15750</span><span class="p">,</span> <span class="l">17750</span><span class="p">,</span> <span class="l">22000</span><span class="p">,</span> <span class="l">25500</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">95</span><span class="p">,</span> <span class="p">{</span> <span class="l">10200</span><span class="p">,</span> <span class="l">10350</span><span class="p">,</span> <span class="l">11500</span><span class="p">,</span> <span class="l">12250</span><span class="p">,</span> <span class="l">12500</span><span class="p">,</span> <span class="l">13125</span><span class="p">,</span> <span class="l">13875</span><span class="p">,</span> <span class="l">15250</span><span class="p">,</span> <span class="l">19000</span><span class="p">,</span> <span class="l">21000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">96</span><span class="p">,</span> <span class="p">{</span>  <span class="l">9050</span><span class="p">,</span>  <span class="l">9550</span><span class="p">,</span> <span class="l">10100</span><span class="p">,</span> <span class="l">13875</span><span class="p">,</span> <span class="l">13000</span><span class="p">,</span> <span class="l">14000</span><span class="p">,</span> <span class="l">18500</span><span class="p">,</span> <span class="l">22000</span><span class="p">,</span> <span class="l">27000</span><span class="p">,</span> <span class="l">39000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">97</span><span class="p">,</span> <span class="p">{</span> <span class="l">11000</span><span class="p">,</span> <span class="l">12500</span><span class="p">,</span> <span class="l">13250</span><span class="p">,</span> <span class="l">13000</span><span class="p">,</span> <span class="l">13750</span><span class="p">,</span> <span class="l">15750</span><span class="p">,</span> <span class="l">15000</span><span class="p">,</span> <span class="l">18000</span><span class="p">,</span> <span class="l">19000</span><span class="p">,</span> <span class="l">22500</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">98</span><span class="p">,</span> <span class="p">{</span> <span class="l">10400</span><span class="p">,</span> <span class="l">10850</span><span class="p">,</span> <span class="l">12125</span><span class="p">,</span> <span class="l">12125</span><span class="p">,</span> <span class="l">13250</span><span class="p">,</span> <span class="l">13875</span><span class="p">,</span> <span class="l">16000</span><span class="p">,</span> <span class="l">18750</span><span class="p">,</span> <span class="l">26500</span><span class="p">,</span> <span class="l">37000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">99</span><span class="p">,</span> <span class="p">{</span> <span class="l">11000</span><span class="p">,</span> <span class="l">12625</span><span class="p">,</span> <span class="l">13125</span><span class="p">,</span> <span class="l">14000</span><span class="p">,</span> <span class="l">15500</span><span class="p">,</span> <span class="l">16750</span><span class="p">,</span> <span class="l">19000</span><span class="p">,</span> <span class="l">21500</span><span class="p">,</span> <span class="l">25000</span><span class="p">,</span> <span class="l">36000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">100</span><span class="p">,</span><span class="p">{</span>  <span class="l">9650</span><span class="p">,</span> <span class="l">10450</span><span class="p">,</span> <span class="l">11500</span><span class="p">,</span> <span class="l">12375</span><span class="p">,</span> <span class="l">12500</span><span class="p">,</span> <span class="l">12875</span><span class="p">,</span> <span class="l">13500</span><span class="p">,</span> <span class="l">15500</span><span class="p">,</span> <span class="l">17500</span><span class="p">,</span> <span class="l">21500</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">101</span><span class="p">,</span><span class="p">{</span> <span class="l">10950</span><span class="p">,</span> <span class="l">11250</span><span class="p">,</span> <span class="l">11500</span><span class="p">,</span> <span class="l">11875</span><span class="p">,</span> <span class="l">12250</span><span class="p">,</span> <span class="l">12875</span><span class="p">,</span> <span class="l">13500</span><span class="p">,</span> <span class="l">14375</span><span class="p">,</span> <span class="l">22500</span><span class="p">,</span> <span class="l">39000</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">102</span><span class="p">,</span><span class="p">{</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">103</span><span class="p">,</span><span class="p">{</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">104</span><span class="p">,</span><span class="p">{</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">105</span><span class="p">,</span><span class="p">{</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">106</span><span class="p">,</span><span class="p">{</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">107</span><span class="p">,</span><span class="p">{</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">108</span><span class="p">,</span><span class="p">{</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span><span class="p">,</span>
  <span class="p">{</span> <span class="l">0</span><span class="p">,</span>  <span class="p">{</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">}</span><span class="p">;</span>

<a name="cmDspPicadaeDutyMap_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <span class="k">int</span> <a name="cmDspPicadaeDutyMap_t.us"></a><span class="i">us</span><span class="p">;</span>
  <span class="k">int</span> <a name="cmDspPicadaeDutyMap_t.dutyPct"></a><span class="i">dutyPct</span><span class="p">;</span>
<span class="p">}</span> <span class="t"><a href="#cmDspPicadaeDutyMap_t">cmDspPicadaeDutyMap_t</a></span><span class="p">;</span>

<a name="cmDspPicadaeDuty_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <span class="k">unsigned</span>  <a name="cmDspPicadaeDuty_t.pitch"></a><span class="i">pitch</span><span class="p">;</span>
  <a href="#cmDspPicadaeDutyMap_t">cmDspPicadaeDutyMap_t</a> <a name="cmDspPicadaeDuty_t.dutyMapA"></a><span class="i">dutyMapA</span><span class="p">[</span><span class="l">5</span><span class="p">]</span><span class="p">;</span>
<span class="p">}</span> <span class="t"><a href="#cmDspPicadaeDuty_t">cmDspPicadaeDuty_t</a></span><span class="p">;</span>

<span class="c">// This table is generated from picadae_ac_3/velTableToDataStruct.py </span>

<a href="#cmDspPicadaeDuty_t">cmDspPicadaeDuty_t</a> cmDspPicadaeDutyMap<span class="p">[</span><span class="p">]</span> <span class="p">=</span>
<span class="p">{</span>
  <span class="p">{</span><span class="l">21</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">22</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">23</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">70</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">24</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">75</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">25</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">70</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">26</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">65</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">27</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">70</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">28</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">70</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">29</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">65</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">30</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">65</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">31</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">65</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">32</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">33</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">65</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">34</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">65</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">35</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">65</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">36</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">65</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">37</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">65</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">38</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">39</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">40</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">55</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">41</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">42</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">43</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">65</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">44</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">45</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">46</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">47</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">48</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">70</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">49</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">50</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">51</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">52</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">55</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">53</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">54</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">55</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">22000</span><span class="p">,</span> <span class="l">55</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">56</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">57</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">58</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">59</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">60</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">61</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">62</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">55</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">63</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">64</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">65</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">17000</span><span class="p">,</span> <span class="l">65</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">66</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">53</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">67</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">55</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">68</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">53</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">69</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">55</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">70</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">71</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">72</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">73</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">74</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">75</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">55</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">76</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">70</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">77</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">15000</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">19000</span><span class="p">,</span> <span class="l">70</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">78</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">79</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">15000</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">19000</span><span class="p">,</span> <span class="l">70</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">80</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">45</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">81</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">15000</span><span class="p">,</span> <span class="l">70</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">82</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">12500</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">14000</span><span class="p">,</span> <span class="l">65</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">17000</span><span class="p">,</span> <span class="l">70</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">83</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">15000</span><span class="p">,</span> <span class="l">65</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">84</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">12500</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">14000</span><span class="p">,</span> <span class="l">65</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">17000</span><span class="p">,</span> <span class="l">70</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">85</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">12500</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">14000</span><span class="p">,</span> <span class="l">65</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">17000</span><span class="p">,</span> <span class="l">70</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">86</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">12500</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">14000</span><span class="p">,</span> <span class="l">65</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">17000</span><span class="p">,</span> <span class="l">70</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">87</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">14000</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">88</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">12500</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">14000</span><span class="p">,</span> <span class="l">65</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">17000</span><span class="p">,</span> <span class="l">70</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">89</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">12500</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">14000</span><span class="p">,</span> <span class="l">65</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">17000</span><span class="p">,</span> <span class="l">70</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">90</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span><span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">91</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">40</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">12500</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">14000</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">17000</span><span class="p">,</span> <span class="l">65</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span> 
  <span class="p">{</span><span class="l">92</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">40</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">14000</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">93</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">40</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">12500</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">14000</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">17000</span><span class="p">,</span> <span class="l">65</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">94</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">40</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">14000</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">95</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">40</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">12500</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">14000</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">17000</span><span class="p">,</span> <span class="l">65</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">96</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">40</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">12500</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">14000</span><span class="p">,</span> <span class="l">60</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">17000</span><span class="p">,</span> <span class="l">65</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">97</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">40</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">14000</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">98</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">99</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">100</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">101</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">0</span><span class="p">,</span> <span class="l">50</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">102</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span><span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">103</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span><span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">104</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span><span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">105</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span><span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">106</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">107</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span><span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span><span class="l">108</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span><span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  <span class="p">{</span>  <span class="l">0</span><span class="p">,</span> <span class="p">{</span><span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span><span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">{</span> <span class="l">-1</span><span class="p">,</span> <span class="l">-1</span> <span class="p">}</span><span class="p">,</span> <span class="p">}</span><span class="p">}</span><span class="p">,</span>
  
<span class="p">}</span><span class="p">;</span>

<a name="cmDspPicadae_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a> <a name="cmDspPicadae_t.inst"></a><span class="i">inst</span><span class="p">;</span>
  <span class="k">unsigned</span>    <a name="cmDspPicadae_t.curDutyPctA"></a><span class="i">curDutyPctA</span><span class="p">[</span><span class="l">127</span><span class="p">]</span><span class="p">;</span>  
<span class="p">}</span> <span class="t"><a href="#cmDspPicadae_t">cmDspPicadae_t</a></span><span class="p">;</span>


<span class="k">unsigned</span> <a name="_cmDspPicadaeVelToMicroseconds_defn"></a><a name="_cmDspPicadaeVelToMicroseconds"></a><span class="f">_cmDspPicadaeVelToMicroseconds</span><span class="p">(</span> <span class="k">unsigned</span> pitch<span class="p">,</span> <span class="k">unsigned</span> vel <span class="p">)</span>
<span class="p">{</span>
  <span class="k">unsigned</span> i<span class="p">;</span>
  
  <span class="k">unsigned</span> velN <span class="p">=</span> <span class="k">sizeof</span><span class="p">(</span>cmDspPicadaeVelMap<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>velMapA<span class="p">)</span><span class="p">/</span><span class="k">sizeof</span><span class="p">(</span>cmDspPicadaeVelMap<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>velMapA<span class="p">[</span><span class="l">0</span><span class="p">]</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">long</span> velIdx <span class="p">=</span> lround<span class="p">(</span> vel <span class="p">*</span> velN <span class="p">/</span> <span class="l">127.0</span>  <span class="p">)</span><span class="p">;</span>
  
  assert<span class="p">(</span> pitch <span class="p">&gt</span><span class="p">=</span> cmDspPicadaeVelMap<span class="p">[</span><span class="l">0</span><span class="p">]</span><span class="p">.</span>pitch <span class="p">)</span><span class="p">;</span>
  <span class="k">long</span> pitchIdx <span class="p">=</span> pitch <span class="p">-</span> cmDspPicadaeVelMap<span class="p">[</span><span class="l">0</span><span class="p">]</span><span class="p">.</span>pitch<span class="p">;</span>
  
  <span class="k">return</span> cmDspPicadaeVelMap<span class="p">[</span>pitchIdx<span class="p">]</span><span class="p">.</span>velMapA<span class="p">[</span>velIdx<span class="p">]</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">int</span> <a name="_cmDspPicadaeVelToDutyCycle_defn"></a><a name="_cmDspPicadaeVelToDutyCycle"></a><span class="f">_cmDspPicadaeVelToDutyCycle</span><span class="p">(</span> <span class="k">unsigned</span> pitch<span class="p">,</span> <span class="k">unsigned</span> usec <span class="p">)</span>
<span class="p">{</span>
  <span class="k">unsigned</span>            i<span class="p">;</span>
  <span class="k">int</span>                 dutyPct  <span class="p">=</span> <span class="l">-1</span><span class="p">;</span>
  <span class="k">long</span>                pitchIdx <span class="p">=</span> pitch <span class="p">-</span> cmDspPicadaeDutyMap<span class="p">[</span><span class="l">0</span><span class="p">]</span><span class="p">.</span>pitch<span class="p">;</span>
  <a href="#cmDspPicadaeDuty_t">cmDspPicadaeDuty_t</a><span class="p">*</span> r        <span class="p">=</span> cmDspPicadaeDutyMap <span class="p">+</span> pitchIdx<span class="p">;</span>
  
  <span class="k">for</span><span class="p">(</span>i<span class="p">=</span><span class="l">0</span><span class="p">;</span> r<span class="p">-</span><span class="p">&gt</span>dutyMapA<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>us <span class="p">!</span><span class="p">=</span> <span class="l">-1</span><span class="p">;</span> <span class="p">+</span><span class="p">+</span>i<span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> r<span class="p">-</span><span class="p">&gt</span>dutyMapA<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>us <span class="p">&lt</span><span class="p">=</span> usec <span class="p">)</span>
      dutyPct <span class="p">=</span> r<span class="p">-</span><span class="p">&gt</span>dutyMapA<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>dutyPct<span class="p">;</span>
  
  <span class="k">return</span> dutyPct<span class="p">;</span>
<span class="p">}</span>

<span class="k">void</span> <a name="_cmDspPicadaeSerialXmitNoteOff_defn"></a><a name="_cmDspPicadaeSerialXmitNoteOff"></a><span class="f">_cmDspPicadaeSerialXmitNoteOff</span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> uint8_t pitch <span class="p">)</span>
<span class="p">{</span>
  <span class="k">const</span> uint8_t note_off_op  <span class="p">=</span> <span class="l">3</span><span class="p">;</span>
  uint8_t      serialBuf<span class="p">[</span><span class="p">]</span>  <span class="p">=</span> <span class="p">{</span> <span class="l">'w'</span><span class="p">,</span> pitch<span class="p">,</span>  note_off_op<span class="p">,</span> <span class="l">1</span><span class="p">,</span> <span class="l">0</span> <span class="p">}</span><span class="p">;</span>
  
  <a href="cmSerialPort_h_0.html#cmSeSend">cmSeSend</a><span class="p">(</span> <a href="cmDspSys_h_0.html#cmDspSysSerialPort">cmDspSysSerialPort</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>dspH<span class="p">)</span><span class="p">,</span> serialBuf<span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span>serialBuf<span class="p">)</span> <span class="p">)</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">void</span> <a name="_cmDspPicadaeSerialXmitNoteOn_defn"></a><a name="_cmDspPicadaeSerialXmitNoteOn"></a><span class="f">_cmDspPicadaeSerialXmitNoteOn</span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> uint8_t pitch<span class="p">,</span> uint8_t coarse_tick<span class="p">,</span> uint8_t fine_tick <span class="p">)</span>
<span class="p">{</span>
  <span class="k">const</span> uint8_t  note_on_usec_op   <span class="p">=</span> <span class="l">2</span><span class="p">;</span>
  uint8_t serialBuf<span class="p">[</span><span class="p">]</span> <span class="p">=</span> <span class="p">{</span> <span class="l">'w'</span><span class="p">,</span> pitch<span class="p">,</span>  note_on_usec_op<span class="p">,</span> <span class="l">2</span><span class="p">,</span> coarse_tick<span class="p">,</span> fine_tick <span class="p">}</span><span class="p">;</span>
  
  <a href="cmSerialPort_h_0.html#cmSeSend">cmSeSend</a><span class="p">(</span> <a href="cmDspSys_h_0.html#cmDspSysSerialPort">cmDspSysSerialPort</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>dspH<span class="p">)</span><span class="p">,</span> serialBuf<span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span>serialBuf<span class="p">)</span> <span class="p">)</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">void</span> <a name="_cmDspPicadaeSerialXmitDuty_defn"></a><a name="_cmDspPicadaeSerialXmitDuty"></a><span class="f">_cmDspPicadaeSerialXmitDuty</span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="#cmDspPicadae_t">cmDspPicadae_t</a><span class="p">*</span> p<span class="p">,</span> uint8_t pitch<span class="p">,</span> uint8_t dutyPct <span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>curDutyPctA<span class="p">[</span> pitch <span class="p">]</span> <span class="p">!</span><span class="p">=</span> dutyPct <span class="p">)</span>
  <span class="p">{</span>
    uint8_t       duty_pct_op <span class="p">=</span> <span class="l">0</span><span class="p">;</span>
    <span class="k">unsigned</span> <span class="k">char</span> serialBuf<span class="p">[</span><span class="p">]</span> <span class="p">=</span> <span class="p">{</span> <span class="l">'w'</span><span class="p">,</span> pitch<span class="p">,</span>  duty_pct_op<span class="p">,</span> <span class="l">1</span><span class="p">,</span> dutyPct <span class="p">}</span><span class="p">;</span>
    
    <a href="cmSerialPort_h_0.html#cmSeSend">cmSeSend</a><span class="p">(</span> <a href="cmDspSys_h_0.html#cmDspSysSerialPort">cmDspSysSerialPort</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>dspH<span class="p">)</span><span class="p">,</span> serialBuf<span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span>serialBuf<span class="p">)</span> <span class="p">)</span><span class="p">;</span>
  <span class="p">}</span>
  
<span class="p">}</span>

<span class="k">void</span> <a name="_cmDspPicadaeSendNote_defn"></a><a name="_cmDspPicadaeSendNote"></a><span class="f">_cmDspPicadaeSendNote</span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspPicadae_t">cmDspPicadae_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspPicadae_t">cmDspPicadae_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  <span class="k">unsigned</span> prescaler_usec <span class="p">=</span> <span class="l">16</span><span class="p">;</span>
  
  <span class="k">unsigned</span> status   <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kStatusPcId">kStatusPcId</a><span class="p">)</span><span class="p">;</span>
  uint8_t  pitch    <span class="p">=</span> <span class="p">(</span>uint8_t<span class="p">)</span><a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kD0PcId">kD0PcId</a><span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span> velocity <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kD1PcId">kD1PcId</a><span class="p">)</span><span class="p">;</span>
  
  assert<span class="p">(</span> <span class="l">21</span><span class="p">&lt</span><span class="p">=</span>pitch <span class="p">&amp</span><span class="p">&amp</span> pitch<span class="p">&lt</span><span class="p">=</span><span class="l">108</span> <span class="p">)</span><span class="p">;</span>
  
  <span class="c">// if this is a note-off</span>
  <span class="k">if</span><span class="p">(</span> status <span class="p">=</span><span class="p">=</span> <a href="cmMidi_h_0.html#kNoteOffMdId">kNoteOffMdId</a> <span class="p">|</span><span class="p">|</span> velocity <span class="p">=</span><span class="p">=</span> <span class="l">0</span> <span class="p">)</span>
  <span class="p">{</span>
    <a href="#_cmDspPicadaeSerialXmitNoteOff">_cmDspPicadaeSerialXmitNoteOff</a><span class="p">(</span> ctx<span class="p">,</span> inst<span class="p">,</span> pitch <span class="p">)</span><span class="p">;</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="k">unsigned</span> usec     <span class="p">=</span> <a href="#_cmDspPicadaeVelToMicroseconds">_cmDspPicadaeVelToMicroseconds</a><span class="p">(</span>pitch<span class="p">,</span> velocity <span class="p">)</span><span class="p">;</span>
  
  <span class="c">// if the pitch is invalid then 'usec' will be set to 0</span>
  <span class="k">if</span><span class="p">(</span> usec <span class="p">=</span><span class="p">=</span> <span class="l">0</span> <span class="p">)</span>
    <span class="k">return</span><span class="p">;</span>
  
  <span class="k">unsigned</span> dutyPct    <span class="p">=</span> <a href="#_cmDspPicadaeVelToDutyCycle">_cmDspPicadaeVelToDutyCycle</a><span class="p">(</span> pitch<span class="p">,</span> usec <span class="p">)</span><span class="p">;</span>
  
  <span class="c">// if the pitch is invalid then dutyPct will be set to -1</span>
  <span class="k">if</span><span class="p">(</span> dutyPct <span class="p">=</span><span class="p">=</span> <span class="l">-1</span> <span class="p">)</span>
    <span class="k">return</span><span class="p">;</span>
  
  <span class="k">unsigned</span> coarse_usec <span class="p">=</span> prescaler_usec<span class="p">*</span><span class="l">255</span><span class="p">;</span> <span class="c"> // usec's in one coarse tick </span>
  uint8_t coarse_ticks <span class="p">=</span> <span class="p">(</span>uint8_t<span class="p">)</span><span class="p">(</span>usec <span class="p">/</span> coarse_usec<span class="p">)</span><span class="p">;</span>
  uint8_t fine_ticks   <span class="p">=</span> <span class="p">(</span>uint8_t<span class="p">)</span><span class="p">(</span><span class="p">(</span>usec <span class="p">-</span> coarse_ticks<span class="p">*</span>coarse_usec<span class="p">)</span> <span class="p">/</span> prescaler_usec<span class="p">)</span><span class="p">;</span>
  
  
  <a href="#_cmDspPicadaeSerialXmitDuty">_cmDspPicadaeSerialXmitDuty</a><span class="p">(</span> ctx<span class="p">,</span> p<span class="p">,</span> pitch<span class="p">,</span> dutyPct <span class="p">)</span><span class="p">;</span>
  
  <a href="#_cmDspPicadaeSerialXmitNoteOn">_cmDspPicadaeSerialXmitNoteOn</a><span class="p">(</span> ctx<span class="p">,</span> inst<span class="p">,</span> pitch<span class="p">,</span> coarse_ticks<span class="p">,</span> fine_ticks <span class="p">)</span><span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span>  <a name="_cmDspPicadaeAlloc_defn"></a><a name="_cmDspPicadaeAlloc"></a><span class="f">_cmDspPicadaeAlloc</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> classPtr<span class="p">,</span> <span class="k">unsigned</span> storeSymId<span class="p">,</span> <span class="k">unsigned</span> instSymId<span class="p">,</span> <span class="k">unsigned</span> id<span class="p">,</span> <span class="k">unsigned</span> va_cnt<span class="p">,</span> va_list vl <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspVarArg_t">cmDspVarArg_t</a> args<span class="p">[</span><span class="p">]</span> <span class="p">=</span>
  <span class="p">{</span>
    <span class="p">{</span> <span class="l">&quotstatus&quot</span><span class="p">,</span> <a href="#kStatusPcId">kStatusPcId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span>  <span class="l">0</span><span class="p">,</span>  <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span> <span class="l">&quotMIDI status&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotd0&quot</span><span class="p">,</span>     <a href="#kD0PcId">kD0PcId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>  <span class="l">0</span><span class="p">,</span>  <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span> <span class="l">&quotMIDI channel message d0&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotd1&quot</span><span class="p">,</span>     <a href="#kD1PcId">kD1PcId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>  <span class="l">0</span><span class="p">,</span>  <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span> <span class="l">&quotMIDI channel message d1&quot</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">&quotalloff&quot</span><span class="p">,</span> <a href="#kAllOffPcId">kAllOffPcId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span>  <span class="l">0</span><span class="p">,</span>  <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kSymDsvFl">kSymDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span> <span class="l">&quotAll notes off.&quot</span><span class="p">}</span><span class="p">,</span> 
    <span class="p">{</span> NULL<span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span> <span class="p">}</span>
  <span class="p">}</span><span class="p">;</span>
  
  <a href="#cmDspPicadae_t">cmDspPicadae_t</a><span class="p">*</span> p <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstAlloc">cmDspInstAlloc</a><span class="p">(</span><a href="#cmDspPicadae_t">cmDspPicadae_t</a><span class="p">,</span>ctx<span class="p">,</span>classPtr<span class="p">,</span>args<span class="p">,</span>instSymId<span class="p">,</span>id<span class="p">,</span>storeSymId<span class="p">,</span>va_cnt<span class="p">,</span>vl<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">;</span>
<span class="p">}</span>

<span class="k">void</span> <a name="_cmDspPicadaReset_defn"></a><a name="_cmDspPicadaReset"></a><span class="f">_cmDspPicadaReset</span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspPicadae_t">cmDspPicadae_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspPicadae_t">cmDspPicadae_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  memset<span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>curDutyPctA<span class="p">,</span><span class="l">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>curDutyPctA<span class="p">)</span><span class="p">)</span><span class="p">;</span>
  
  <span class="c">// send note-off messages to all keys </span>
  <span class="k">unsigned</span> i <span class="p">=</span> <span class="l">0</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span>i<span class="p">=</span><span class="l">0</span><span class="p">;</span> cmDspPicadaeVelMap<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>pitch <span class="p">!</span><span class="p">=</span><span class="l">0</span><span class="p">;</span> <span class="p">+</span><span class="p">+</span>i<span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> cmDspPicadaeVelMap<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>velMapA<span class="p">[</span><span class="l">0</span><span class="p">]</span> <span class="p">!</span><span class="p">=</span> <span class="l">0</span> <span class="p">)</span>
  <span class="p">{</span>
    <a href="#_cmDspPicadaeSerialXmitNoteOff">_cmDspPicadaeSerialXmitNoteOff</a><span class="p">(</span> ctx<span class="p">,</span> inst<span class="p">,</span> <span class="p">(</span>uint8_t<span class="p">)</span>cmDspPicadaeVelMap<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>pitch <span class="p">)</span><span class="p">;</span>
    <a href="cmThread_h_0.html#cmSleepMs">cmSleepMs</a><span class="p">(</span><span class="l">10</span><span class="p">)</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="c">// send pedal-up message</span>
  <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kD0PcId">kD0PcId</a><span class="p">,</span> <a href="cmMidi_h_0.html#kSustainCtlMdId">kSustainCtlMdId</a> <span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kD0PcId">kD0PcId</a><span class="p">,</span> <span class="l">0</span> <span class="p">)</span><span class="p">;</span>  
  <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kStatusPcId">kStatusPcId</a><span class="p">,</span><a href="cmMidi_h_0.html#kCtlMdId">kCtlMdId</a><span class="p">)</span><span class="p">;</span>
  
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspPicadaeReset_defn"></a><a name="_cmDspPicadaeReset"></a><span class="f">_cmDspPicadaeReset</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>      rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspApplyAllDefaults">cmDspApplyAllDefaults</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">;</span>
  
  
  
  
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span> 

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspPicadaeRecv_defn"></a><a name="_cmDspPicadaeRecv"></a><span class="f">_cmDspPicadaeRecv</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <span class="c">//<a href="#cmDspPicadae_t">cmDspPicadae_t</a>* p = (<a href="#cmDspPicadae_t">cmDspPicadae_t</a>*)inst;</span>
  
  <span class="k">switch</span><span class="p">(</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">)</span>
  <span class="p">{</span>
    
  <span class="k">case</span> <a href="#kStatusPcId">kStatusPcId</a><span class="p">:</span>  
    <span class="p">{</span>
      <span class="c">// note: the status byte arrives last (after d0 and d1)</span>
      <span class="k">unsigned</span> status     <span class="p">=</span> <a href="cmDspValue_h_0.html#cmDsvGetUInt">cmDsvGetUInt</a><span class="p">(</span>evt<span class="p">-</span><span class="p">&gt</span>valuePtr<span class="p">)</span><span class="p">;</span>        
      <span class="k">unsigned</span> stat_no_ch <span class="p">=</span> status <span class="p">&amp</span> <span class="l">0xf0</span><span class="p">;</span>
      
      <span class="c">// if this is a note-on or channel</span>
      <span class="k">if</span><span class="p">(</span> stat_no_ch <span class="p">=</span><span class="p">=</span> <a href="cmMidi_h_0.html#kNoteOnMdId">kNoteOnMdId</a> <span class="p">|</span><span class="p">|</span> stat_no_ch <span class="p">=</span><span class="p">=</span> <a href="cmMidi_h_0.html#kNoteOffMdId">kNoteOffMdId</a> <span class="p">|</span><span class="p">|</span> stat_no_ch <span class="p">=</span><span class="p">=</span> <a href="cmMidi_h_0.html#kCtlMdId">kCtlMdId</a>  <span class="p">)</span>
      <span class="p">{</span>
        
        <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kStatusPcId">kStatusPcId</a><span class="p">,</span>stat_no_ch<span class="p">)</span><span class="p">;</span>
        
        <span class="k">if</span><span class="p">(</span> stat_no_ch <span class="p">=</span><span class="p">=</span> <a href="cmMidi_h_0.html#kNoteOnMdId">kNoteOnMdId</a> <span class="p">|</span><span class="p">|</span> stat_no_ch <span class="p">=</span><span class="p">=</span> <a href="cmMidi_h_0.html#kNoteOffMdId">kNoteOffMdId</a> <span class="p">)</span>
          <a href="#_cmDspPicadaeSendNote">_cmDspPicadaeSendNote</a><span class="p">(</span> ctx<span class="p">,</span> inst <span class="p">)</span><span class="p">;</span>
        
      <span class="p">}</span>
      
    <span class="p">}</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kAllOffPcId">kAllOffPcId</a><span class="p">:</span>
    printf<span class="p">(</span><span class="l">&quotPicadae All Off\n&quot</span><span class="p">)</span><span class="p">;</span>
    <a href="#_cmDspPicadaReset">_cmDspPicadaReset</a><span class="p">(</span> ctx<span class="p">,</span> inst <span class="p">)</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">default</span><span class="p">:</span>
    <span class="c">// store </span>
    <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="p">}</span>
  
  
  <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> <a name="cmPicadaeClassCons_defn"></a><span class="f"><a href="cmDspKr_h_0.html#cmPicadaeClassCons">cmPicadaeClassCons</a></span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspClassSetup">cmDspClassSetup</a><span class="p">(</span><span class="p">&amp</span>_cmPicadaeDC<span class="p">,</span>ctx<span class="p">,</span><span class="l">&quotPicadae&quot</span><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspPicadaeAlloc">_cmDspPicadaeAlloc</a><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspPicadaeReset">_cmDspPicadaeReset</a><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspPicadaeRecv">_cmDspPicadaeRecv</a><span class="p">,</span>
  NULL<span class="p">,</span>
  NULL<span class="p">,</span>
  <span class="l">&quotPicadaesynth Mapper&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>_cmPicadaeDC<span class="p">;</span>
<span class="p">}</span>

<span class="c"><hr id="hr1"></span></pre>
</div>
<div class="cod"><div class="blk_title">cmDspRecdPlay : Record audio segments from a live perfromance and play them back at a later time</div><pre><a name="cmDspRecdPlay"></a>
<span class="k">enum</span>
<span class="p">{</span>
  <a name="kChCntPrId"></a><span class="e">kChCntPrId</span><span class="p">,</span>
  <a name="kFnPrId"></a><span class="e">kFnPrId</span><span class="p">,</span>
  <a name="kSecsPrId"></a><span class="e">kSecsPrId</span><span class="p">,</span>
  <a name="kMaxLaSecsPrId"></a><span class="e">kMaxLaSecsPrId</span><span class="p">,</span>
  <a name="kCurLaSecsPrId"></a><span class="e">kCurLaSecsPrId</span><span class="p">,</span>
  <a name="kFadeRatePrId"></a><span class="e">kFadeRatePrId</span><span class="p">,</span>
  <a name="kScInitLocIdxPrId"></a><span class="e">kScInitLocIdxPrId</span><span class="p">,</span>
  <a name="kScLocIdxPrId"></a><span class="e">kScLocIdxPrId</span><span class="p">,</span>
  <a name="kCmdPrId"></a><span class="e">kCmdPrId</span><span class="p">,</span>
  <a name="kInAudioBasePrId"></a><span class="e">kInAudioBasePrId</span>
<span class="p">}</span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a> _cmRecdPlayDC<span class="p">;</span>

<a name="cmDspRecdPlay_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a> <a name="cmDspRecdPlay_t.inst"></a><span class="i">inst</span><span class="p">;</span>
  <a href="cmProc4_h_0.html#cmRecdPlay">cmRecdPlay</a><span class="p">*</span> <a name="cmDspRecdPlay_t.rcdply"></a><span class="i">rcdply</span><span class="p">;</span>
  <a href="cmScore_h_0.html#cmScH_t">cmScH_t</a>     <a name="cmDspRecdPlay_t.scH"></a><span class="i">scH</span><span class="p">;</span>
  <span class="k">unsigned</span>    <a name="cmDspRecdPlay_t.onSymId"></a><span class="i">onSymId</span><span class="p">;</span>
  <span class="k">unsigned</span>    <a name="cmDspRecdPlay_t.offSymId"></a><span class="i">offSymId</span><span class="p">;</span>
  <span class="k">unsigned</span>    <a name="cmDspRecdPlay_t.audioOutBaseId"></a><span class="i">audioOutBaseId</span><span class="p">;</span>
  <span class="k">unsigned</span>    <a name="cmDspRecdPlay_t.chCnt"></a><span class="i">chCnt</span><span class="p">;</span>
  <span class="c">//unsigned    scLocIdx;</span>
<span class="p">}</span> <span class="t"><a href="#cmDspRecdPlay_t">cmDspRecdPlay_t</a></span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspRecdPlayParseRsrc_defn"></a><a name="_cmDspRecdPlayParseRsrc"></a><span class="f">_cmDspRecdPlayParseRsrc</span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <a href="cmProc4_h_0.html#cmRecdPlay">cmRecdPlay</a><span class="p">*</span> rcdply <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>       rc   <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> path <span class="p">=</span> NULL<span class="p">;</span>
  
  <span class="c">// read the 'recdplay' audio file path</span>
  <span class="k">if</span><span class="p">(</span> <a href="cmDspSys_h_0.html#cmDspRsrcString">cmDspRsrcString</a><span class="p">(</span> ctx<span class="p">-</span><span class="p">&gt</span>dspH<span class="p">,</span> <span class="p">&amp</span>path<span class="p">,</span> <span class="l">&quotrecdPlayPath&quot</span><span class="p">,</span> NULL <span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a> <span class="p">)</span>
  <span class="p">{</span>
    <a href="cmDspClass_h_0.html#cmDspInstErr">cmDspInstErr</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="cmDspClass_h_0.html#kRsrcNotFoundDspRC">kRsrcNotFoundDspRC</a><span class="p">,</span><span class="l">&quotThe 'recdPlayPath' resource string was not found.&quot</span><span class="p">)</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="k">if</span><span class="p">(</span> path <span class="p">=</span><span class="p">=</span> NULL <span class="p">)</span>
    path <span class="p">=</span> <span class="l">&quot&quot</span><span class="p">;</span>
  
  <a href="cmJson_h_0.html#cmJsonH_t">cmJsonH_t</a>     jsH <span class="p">=</span> <a href="cmDspSys_h_0.html#cmDspSysPgmRsrcHandle">cmDspSysPgmRsrcHandle</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>dspH<span class="p">)</span><span class="p">;</span>
  <a href="cmJson_h_0.html#cmJsonNode_t">cmJsonNode_t</a><span class="p">*</span> jnp <span class="p">=</span> <a href="cmJson_h_0.html#cmJsonFindValue">cmJsonFindValue</a><span class="p">(</span>jsH<span class="p">,</span><span class="l">&quotrecdPlay&quot</span><span class="p">,</span>NULL<span class="p">,</span> <a href="cmJson_h_0.html#kArrayTId">kArrayTId</a><span class="p">)</span><span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> jnp <span class="p">=</span><span class="p">=</span> NULL <span class="p">|</span><span class="p">|</span> <a href="cmJson_h_0.html#cmJsonIsArray">cmJsonIsArray</a><span class="p">(</span>jnp<span class="p">)</span><span class="p">=</span><span class="p">=</span>false <span class="p">)</span>
  <span class="p">{</span>
    <span class="c">// this is really a warning - the object does not require preloaded segments.</span>
    <a href="cmDspClass_h_0.html#cmDspInstErr">cmDspInstErr</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="cmDspClass_h_0.html#kRsrcNotFoundDspRC">kRsrcNotFoundDspRC</a><span class="p">,</span><span class="l">&quotWarning: The 'recdPlay' resource used to define pre-loaded segments was not found.&quot</span><span class="p">)</span><span class="p">;</span>
    <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="k">unsigned</span> n <span class="p">=</span> <a href="cmJson_h_0.html#cmJsonChildCount">cmJsonChildCount</a><span class="p">(</span>jnp<span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span> i<span class="p">;</span>
  
  <span class="c">// for each 'recdplay' segment record</span>
  <span class="k">for</span><span class="p">(</span>i<span class="p">=</span><span class="l">0</span><span class="p">;</span> i<span class="p">&lt</span>n <span class="p">&amp</span><span class="p">&amp</span> rc<span class="p">=</span><span class="p">=</span><a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span> <span class="p">+</span><span class="p">+</span>i<span class="p">)</span>
  <span class="p">{</span>
    <a href="cmJson_h_0.html#cmJsonNode_t">cmJsonNode_t</a><span class="p">*</span>   cnp      <span class="p">=</span> <a href="cmJson_h_0.html#cmJsonArrayElement">cmJsonArrayElement</a><span class="p">(</span>jnp<span class="p">,</span>i<span class="p">)</span><span class="p">;</span>
    <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> label    <span class="p">=</span> NULL<span class="p">;</span>
    <span class="k">unsigned</span>        segSymId <span class="p">=</span> <a href="cmGlobal_h_0.html#cmInvalidId">cmInvalidId</a><span class="p">;</span>
    <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> errLabel <span class="p">=</span> NULL<span class="p">;</span>
    <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> fn       <span class="p">=</span> NULL<span class="p">;</span>
    
    <span class="c">// read the ith segment record</span>
    <span class="k">if</span><span class="p">(</span> <a href="cmJson_h_0.html#cmJsonMemberValues">cmJsonMemberValues</a><span class="p">(</span>cnp<span class="p">,</span><span class="p">&amp</span>errLabel<span class="p">,</span>
    <span class="l">&quotlabel&quot</span><span class="p">,</span> <a href="cmJson_h_0.html#kStringTId">kStringTId</a><span class="p">,</span> <span class="p">&amp</span>label<span class="p">,</span>
    <span class="l">&quotfile&quot</span><span class="p">,</span>  <a href="cmJson_h_0.html#kStringTId">kStringTId</a><span class="p">,</span> <span class="p">&amp</span>fn<span class="p">,</span>
    NULL<span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmJson_h_0.html#kOkJsRC">kOkJsRC</a> <span class="p">)</span>
    <span class="p">{</span>
      rc <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstErr">cmDspInstErr</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="cmDspClass_h_0.html#kRsrcNotFoundDspRC">kRsrcNotFoundDspRC</a><span class="p">,</span><span class="l">&quotThe record at index %i in the 'recdPlay' pre-loaded segment list could not be parsed.&quot</span><span class="p">,</span>i<span class="p">)</span><span class="p">;</span>
      goto errLabel<span class="p">;</span>
    <span class="p">}</span>
    
    <span class="c">// find or generate the symbol id for the segment label symbol</span>
    <span class="k">if</span><span class="p">(</span><span class="p">(</span>segSymId <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblRegisterSymbol">cmSymTblRegisterSymbol</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span>label<span class="p">)</span><span class="p">)</span> <span class="p">=</span><span class="p">=</span> <a href="cmGlobal_h_0.html#cmInvalidId">cmInvalidId</a> <span class="p">)</span>
    <span class="p">{</span>
      rc <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstErr">cmDspInstErr</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="cmDspClass_h_0.html#kSymNotFoundDspRC">kSymNotFoundDspRC</a><span class="p">,</span><span class="l">&quotThe 'recdPlay' pre-load segment symbol '%s' could not be found or registered.&quot</span><span class="p">,</span><a href="cmGlobal_h_0.html#cmStringNullGuard">cmStringNullGuard</a><span class="p">(</span>label<span class="p">)</span><span class="p">)</span><span class="p">;</span>
      goto errLabel<span class="p">;</span>
    <span class="p">}</span>
    
    <span class="c">// create the full path name for the segment audio file</span>
    <span class="k">if</span><span class="p">(</span><span class="p">(</span>fn <span class="p">=</span> <a href="cmFileSys_h_0.html#cmFsMakeFn">cmFsMakeFn</a><span class="p">(</span> path<span class="p">,</span> fn<span class="p">,</span> NULL<span class="p">,</span> NULL <span class="p">)</span><span class="p">)</span> <span class="p">=</span><span class="p">=</span> NULL <span class="p">)</span>
    <span class="p">{</span>
      rc <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstErr">cmDspInstErr</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="cmDspClass_h_0.html#kFileSysFailDspRC">kFileSysFailDspRC</a><span class="p">,</span><span class="l">&quotThe 'recdPlay' file name '%s/%s' could not be generated.&quot</span><span class="p">,</span><a href="cmGlobal_h_0.html#cmStringNullGuard">cmStringNullGuard</a><span class="p">(</span>path<span class="p">)</span><span class="p">,</span><a href="cmGlobal_h_0.html#cmStringNullGuard">cmStringNullGuard</a><span class="p">(</span>fn<span class="p">)</span><span class="p">)</span><span class="p">;</span>
      goto errLabel<span class="p">;</span>
    <span class="p">}</span>
    
    
    <span class="c">// pre-load the segment</span>
    <span class="k">if</span><span class="p">(</span> <a href="cmProc4_h_0.html#cmRecdPlayInsertRecord">cmRecdPlayInsertRecord</a><span class="p">(</span>rcdply<span class="p">,</span>segSymId<span class="p">,</span>fn<span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmGlobal_h_0.html#cmOkRC">cmOkRC</a> <span class="p">)</span>
      rc <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstErr">cmDspInstErr</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="cmDspClass_h_0.html#kSubSysFailDspRC">kSubSysFailDspRC</a><span class="p">,</span><span class="l">&quotThe 'recdPlay' segment label:'%s'  file:'%s' could not be loaded.&quot</span><span class="p">,</span><a href="cmGlobal_h_0.html#cmStringNullGuard">cmStringNullGuard</a><span class="p">(</span>label<span class="p">)</span><span class="p">,</span><a href="cmGlobal_h_0.html#cmStringNullGuard">cmStringNullGuard</a><span class="p">(</span>fn<span class="p">)</span><span class="p">)</span><span class="p">;</span>
    
    
    <a href="cmFileSys_h_0.html#cmFsFreeFn">cmFsFreeFn</a><span class="p">(</span>fn<span class="p">)</span><span class="p">;</span>
    
  <span class="p">}</span>
  
  errLabel<span class="p">:</span>
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspRecdPlayOpenScore_defn"></a><a name="_cmDspRecdPlayOpenScore"></a><span class="f">_cmDspRecdPlayOpenScore</span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> rc <span class="p">=</span><a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> fn<span class="p">;</span>
  
  <a href="#cmDspRecdPlay_t">cmDspRecdPlay_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspRecdPlay_t">cmDspRecdPlay_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <span class="c">//p-&ampgtscLocIdx = 0;</span>
  
  
  <span class="k">if</span><span class="p">(</span><span class="p">(</span>fn <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspStrcz">cmDspStrcz</a><span class="p">(</span>inst<span class="p">,</span><a href="#kFnPrId">kFnPrId</a><span class="p">)</span><span class="p">)</span> <span class="p">=</span><span class="p">=</span> NULL <span class="p">|</span><span class="p">|</span> strlen<span class="p">(</span>fn<span class="p">)</span><span class="p">=</span><span class="p">=</span><span class="l">0</span> <span class="p">)</span>
    <span class="k">return</span> <a href="cmDspClass_h_0.html#cmDspInstErr">cmDspInstErr</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span> <a href="cmDspClass_h_0.html#kInvalidArgDspRC">kInvalidArgDspRC</a><span class="p">,</span> <span class="l">&quotNo score file name supplied.&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> <a href="cmScore_h_0.html#cmScoreInitialize">cmScoreInitialize</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span><a href="cmProcObj_h_0.html#cmCtx">cmCtx</a><span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>scH<span class="p">,</span> fn<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspSampleRate">cmDspSampleRate</a><span class="p">(</span>ctx<span class="p">)</span><span class="p">,</span> NULL<span class="p">,</span> <span class="l">0</span><span class="p">,</span> NULL<span class="p">,</span> NULL<span class="p">,</span> ctx<span class="p">-</span><span class="p">&gt</span>stH <span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmScore_h_0.html#kOkScRC">kOkScRC</a> <span class="p">)</span>
    <span class="k">return</span> <a href="cmDspClass_h_0.html#cmDspInstErr">cmDspInstErr</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span> <a href="cmDspClass_h_0.html#kSubSysFailDspRC">kSubSysFailDspRC</a><span class="p">,</span> <span class="l">&quotUnable to open the score '%s'.&quot</span><span class="p">,</span>fn<span class="p">)</span><span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> <a href="cmScore_h_0.html#cmScoreIsValid">cmScoreIsValid</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>scH<span class="p">)</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">unsigned</span> i<span class="p">;</span>
    <span class="k">unsigned</span> markerCnt <span class="p">=</span> <a href="cmScore_h_0.html#cmScoreMarkerLabelCount">cmScoreMarkerLabelCount</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>scH<span class="p">)</span><span class="p">;</span>
    <span class="k">double</span> initFragSecs <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kSecsPrId">kSecsPrId</a><span class="p">)</span><span class="p">;</span>
    <span class="k">double</span> maxLaSecs    <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kMaxLaSecsPrId">kMaxLaSecsPrId</a><span class="p">)</span><span class="p">;</span>
    <span class="k">double</span> curLaSecs    <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kCurLaSecsPrId">kCurLaSecsPrId</a><span class="p">)</span><span class="p">;</span>
    
    printf<span class="p">(</span><span class="l">&quot2 max la secs:%f\n&quot</span><span class="p">,</span><a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kMaxLaSecsPrId">kMaxLaSecsPrId</a><span class="p">)</span><span class="p">)</span><span class="p">;</span>
    
    
    <span class="k">if</span><span class="p">(</span><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>rcdply <span class="p">=</span> <a href="cmProc4_h_0.html#cmRecdPlayAlloc">cmRecdPlayAlloc</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>cmProcCtx<span class="p">,</span> NULL<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspSampleRate">cmDspSampleRate</a><span class="p">(</span>ctx<span class="p">)</span><span class="p">,</span> markerCnt<span class="p">,</span> p<span class="p">-</span><span class="p">&gt</span>chCnt<span class="p">,</span> initFragSecs<span class="p">,</span> maxLaSecs<span class="p">,</span> curLaSecs<span class="p">)</span><span class="p">)</span> <span class="p">=</span><span class="p">=</span> NULL<span class="p">)</span>
      <span class="k">return</span> <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>inst<span class="p">-</span><span class="p">&gt</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span><a href="cmDspClass_h_0.html#kSubSysFailDspRC">kSubSysFailDspRC</a><span class="p">,</span><span class="l">&quotUnable to create the internal recorder-player object.&quot</span><span class="p">)</span><span class="p">;</span>    
    
    <span class="k">for</span><span class="p">(</span>i<span class="p">=</span><span class="l">0</span><span class="p">;</span> i<span class="p">&lt</span>markerCnt<span class="p">;</span> <span class="p">+</span><span class="p">+</span>i<span class="p">)</span>
      <a href="cmProc4_h_0.html#cmRecdPlayRegisterFrag">cmRecdPlayRegisterFrag</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>rcdply<span class="p">,</span>i<span class="p">,</span> <a href="cmScore_h_0.html#cmScoreMarkerLabelSymbolId">cmScoreMarkerLabelSymbolId</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>scH<span class="p">,</span>i <span class="p">)</span><span class="p">)</span><span class="p">;</span>
    
    <span class="k">if</span><span class="p">(</span><span class="p">(</span>rc <span class="p">=</span> <a href="#_cmDspRecdPlayParseRsrc">_cmDspRecdPlayParseRsrc</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>p<span class="p">-</span><span class="p">&gt</span>rcdply<span class="p">)</span><span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a> <span class="p">)</span>
      rc <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstErr">cmDspInstErr</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="cmDspClass_h_0.html#kInstResetFailDspRC">kInstResetFailDspRC</a><span class="p">,</span><span class="l">&quotThe 'recdplay' segment pre-load failed.&quot</span><span class="p">)</span><span class="p">;</span>
    
    <span class="c">//p-&ampgtscLocIdx = <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a>(inst,<a href="#kScInitLocIdxPrId">kScInitLocIdxPrId</a>);</span>
    
  <span class="p">}</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>


<a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span>  <a name="_cmDspRecdPlayAlloc_defn"></a><a name="_cmDspRecdPlayAlloc"></a><span class="f">_cmDspRecdPlayAlloc</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> classPtr<span class="p">,</span> <span class="k">unsigned</span> storeSymId<span class="p">,</span> <span class="k">unsigned</span> instSymId<span class="p">,</span> <span class="k">unsigned</span> id<span class="p">,</span> <span class="k">unsigned</span> va_cnt<span class="p">,</span> va_list vl <span class="p">)</span>
<span class="p">{</span>
  
  <span class="k">if</span><span class="p">(</span> va_cnt <span class="p">&lt</span> <span class="l">1</span> <span class="p">)</span>
  <span class="p">{</span>
    <a href="cmDspClass_h_0.html#cmDspClassErr">cmDspClassErr</a><span class="p">(</span>ctx<span class="p">,</span>classPtr<span class="p">,</span><a href="cmDspClass_h_0.html#kVarArgParseFailDspRC">kVarArgParseFailDspRC</a><span class="p">,</span><span class="l">&quotThe 'RecdPlay' constructor must have a count of input ports.&quot</span><span class="p">)</span><span class="p">;</span>
    <span class="k">return</span> NULL<span class="p">;</span>
  <span class="p">}</span>
  
  va_list vl1<span class="p">;</span>
  va_copy<span class="p">(</span>vl1<span class="p">,</span>vl<span class="p">)</span><span class="p">;</span>
  
  <span class="k">int</span>      chCnt         <span class="p">=</span> va_arg<span class="p">(</span>vl<span class="p">,</span><span class="k">int</span><span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span> audioOutBase  <span class="p">=</span> <a href="#kInAudioBasePrId">kInAudioBasePrId</a> <span class="p">+</span> chCnt<span class="p">;</span>    
  
  <a href="#cmDspRecdPlay_t">cmDspRecdPlay_t</a><span class="p">*</span> p <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstAllocV">cmDspInstAllocV</a><span class="p">(</span><a href="#cmDspRecdPlay_t">cmDspRecdPlay_t</a><span class="p">,</span>ctx<span class="p">,</span>classPtr<span class="p">,</span>instSymId<span class="p">,</span>id<span class="p">,</span>storeSymId<span class="p">,</span>va_cnt<span class="p">,</span>vl1<span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotchs&quot</span><span class="p">,</span>    <a href="#kChCntPrId">kChCntPrId</a><span class="p">,</span>      <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kReqArgDsvFl">kReqArgDsvFl</a><span class="p">,</span>              <span class="l">&quotchannel count.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotfn&quot</span><span class="p">,</span>     <a href="#kFnPrId">kFnPrId</a><span class="p">,</span>         <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kStrzDsvFl">kStrzDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kReqArgDsvFl">kReqArgDsvFl</a><span class="p">,</span> <span class="l">&quotScore file.&quot</span> <span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotsecs&quot</span><span class="p">,</span>   <a href="#kSecsPrId">kSecsPrId</a><span class="p">,</span>       <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kReqArgDsvFl">kReqArgDsvFl</a><span class="p">,</span> <span class="l">&quotInitial fragment allocation in seconds.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotmaxla&quot</span><span class="p">,</span>  <a href="#kMaxLaSecsPrId">kMaxLaSecsPrId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kReqArgDsvFl">kReqArgDsvFl</a><span class="p">,</span> <span class="l">&quotMaximum look-ahead buffer in seconds.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotcurla&quot</span><span class="p">,</span>  <a href="#kCurLaSecsPrId">kCurLaSecsPrId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span> <span class="l">&quotCurrent look-head buffer in seconds.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotfrate&quot</span><span class="p">,</span>  <a href="#kFadeRatePrId">kFadeRatePrId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span> <span class="l">&quotFade rate in dB per second.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotinitIdx&quot</span><span class="p">,</span><a href="#kScInitLocIdxPrId">kScInitLocIdxPrId</a><span class="p">,</span><span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span><a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                  <span class="l">&quotScore search start location.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotindex&quot</span><span class="p">,</span>  <a href="#kScLocIdxPrId">kScLocIdxPrId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                <span class="l">&quotScore follower location index.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotcmd&quot</span><span class="p">,</span>    <a href="#kCmdPrId">kCmdPrId</a><span class="p">,</span>        <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kSymDsvFl">kSymDsvFl</a><span class="p">,</span>                 <span class="l">&quoton=reset off=stop.&quot</span><span class="p">,</span>
  chCnt<span class="p">,</span>     <span class="l">&quotin&quot</span><span class="p">,</span>     <a href="#kInAudioBasePrId">kInAudioBasePrId</a><span class="p">,</span><span class="l">0</span><span class="p">,</span><span class="l">1</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kAudioBufDsvFl">kAudioBufDsvFl</a><span class="p">,</span>            <span class="l">&quotAudio input&quot</span><span class="p">,</span>
  chCnt<span class="p">,</span>     <span class="l">&quotout&quot</span><span class="p">,</span>    audioOutBase<span class="p">,</span>    <span class="l">0</span><span class="p">,</span><span class="l">1</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kAudioBufDsvFl">kAudioBufDsvFl</a><span class="p">,</span>            <span class="l">&quotAudio output&quot</span><span class="p">,</span>
  <span class="l">0</span> <span class="p">)</span><span class="p">;</span>
  
  va_end<span class="p">(</span>vl1<span class="p">)</span><span class="p">;</span>
  
  p<span class="p">-</span><span class="p">&gt</span>onSymId        <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblId">cmSymTblId</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span><span class="l">&quoton&quot</span><span class="p">)</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>offSymId       <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblId">cmSymTblId</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span><span class="l">&quotoff&quot</span><span class="p">)</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>audioOutBaseId <span class="p">=</span> audioOutBase<span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>chCnt          <span class="p">=</span> chCnt<span class="p">;</span>
  <span class="c">//p-&ampgtscLocIdx       = 0;</span>
  
  printf<span class="p">(</span><span class="l">&quot0 max la secs:%f\n&quot</span><span class="p">,</span><a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kMaxLaSecsPrId">kMaxLaSecsPrId</a><span class="p">)</span><span class="p">)</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kSecsPrId">kSecsPrId</a><span class="p">,</span>     <span class="l">0.0</span><span class="p">,</span> <span class="l">10.0</span> <span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kMaxLaSecsPrId">kMaxLaSecsPrId</a><span class="p">,</span><span class="l">0.0</span><span class="p">,</span> <span class="l">2.0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kCurLaSecsPrId">kCurLaSecsPrId</a><span class="p">,</span><span class="l">0.0</span><span class="p">,</span> <span class="l">0.1</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kFadeRatePrId">kFadeRatePrId</a><span class="p">,</span> <span class="l">0.0</span><span class="p">,</span> <span class="l">1.0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>  ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kScInitLocIdxPrId">kScInitLocIdxPrId</a><span class="p">,</span><span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  
  printf<span class="p">(</span><span class="l">&quot1 max la secs:%f\n&quot</span><span class="p">,</span><a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kMaxLaSecsPrId">kMaxLaSecsPrId</a><span class="p">)</span><span class="p">)</span><span class="p">;</span>
  
  
  
  
  <span class="k">return</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspRecdPlayFree_defn"></a><a name="_cmDspRecdPlayFree"></a><span class="f">_cmDspRecdPlayFree</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>        rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspRecdPlay_t">cmDspRecdPlay_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspRecdPlay_t">cmDspRecdPlay_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <a href="cmProc4_h_0.html#cmRecdPlayFree">cmRecdPlayFree</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>rcdply<span class="p">)</span><span class="p">;</span>
  
  <a href="cmScore_h_0.html#cmScoreFinalize">cmScoreFinalize</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>scH<span class="p">)</span><span class="p">;</span>
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspRecdPlayReset_defn"></a><a name="_cmDspRecdPlayReset"></a><span class="f">_cmDspRecdPlayReset</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> rc<span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="p">(</span>rc <span class="p">=</span> <a href="#_cmDspRecdPlayOpenScore">_cmDspRecdPlayOpenScore</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">)</span> <span class="p">=</span><span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a> <span class="p">)</span>
    <a href="cmDspClass_h_0.html#cmDspApplyAllDefaults">cmDspApplyAllDefaults</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span> 

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspRecdPlayExec_defn"></a><a name="_cmDspRecdPlayExec"></a><span class="f">_cmDspRecdPlayExec</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>      rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  
  <a href="#cmDspRecdPlay_t">cmDspRecdPlay_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspRecdPlay_t">cmDspRecdPlay_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <span class="k">const</span> <a href="cmFloatTypes_h_0.html#cmSample_t">cmSample_t</a><span class="p">*</span> x<span class="p">[</span> p<span class="p">-</span><span class="p">&gt</span>chCnt <span class="p">]</span><span class="p">;</span>
  <a href="cmFloatTypes_h_0.html#cmSample_t">cmSample_t</a><span class="p">*</span>       y<span class="p">[</span> p<span class="p">-</span><span class="p">&gt</span>chCnt <span class="p">]</span><span class="p">;</span>
  <span class="k">unsigned</span> n <span class="p">=</span> <span class="l">0</span><span class="p">;</span>
  <span class="k">unsigned</span> i<span class="p">;</span>
  <span class="k">unsigned</span> actChCnt <span class="p">=</span> <span class="l">0</span><span class="p">;</span>
  
  <span class="k">for</span><span class="p">(</span>i<span class="p">=</span><span class="l">0</span><span class="p">;</span> i<span class="p">&lt</span>p<span class="p">-</span><span class="p">&gt</span>chCnt<span class="p">;</span> <span class="p">+</span><span class="p">+</span>i<span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span> <a href="cmDspClass_h_0.html#cmDspIsAudioInputConnected">cmDspIsAudioInputConnected</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kInAudioBasePrId">kInAudioBasePrId</a><span class="p">+</span>i<span class="p">)</span> <span class="p">=</span><span class="p">=</span> false <span class="p">)</span>
    <span class="p">{</span>
      x<span class="p">[</span>i<span class="p">]</span> <span class="p">=</span> NULL<span class="p">;</span>
      y<span class="p">[</span>i<span class="p">]</span> <span class="p">=</span> NULL<span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span> i<span class="p">=</span><span class="p">=</span><span class="l">0</span> <span class="p">)</span>
        n  <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBufSmpCount">cmDspAudioBufSmpCount</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kInAudioBasePrId">kInAudioBasePrId</a><span class="p">+</span>i<span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
      <span class="k">else</span>
      <span class="p">{</span> 
        
        assert<span class="p">(</span> n <span class="p">=</span><span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBufSmpCount">cmDspAudioBufSmpCount</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kInAudioBasePrId">kInAudioBasePrId</a><span class="p">+</span>i<span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">)</span><span class="p">;</span> 
      <span class="p">}</span>
      
      x<span class="p">[</span>i<span class="p">]</span> <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBuf">cmDspAudioBuf</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kInAudioBasePrId">kInAudioBasePrId</a><span class="p">+</span>i<span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
      
      <span class="k">if</span><span class="p">(</span> x<span class="p">[</span>i<span class="p">]</span> <span class="p">!</span><span class="p">=</span> NULL <span class="p">)</span>
      <span class="p">{</span>
        y<span class="p">[</span>i<span class="p">]</span> <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBuf">cmDspAudioBuf</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>p<span class="p">-</span><span class="p">&gt</span>audioOutBaseId<span class="p">+</span>i<span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
        
        <span class="k">if</span><span class="p">(</span> y<span class="p">[</span>i<span class="p">]</span> <span class="p">!</span><span class="p">=</span> NULL <span class="p">)</span>
        <span class="p">{</span>
          assert<span class="p">(</span> n <span class="p">=</span><span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBufSmpCount">cmDspAudioBufSmpCount</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>p<span class="p">-</span><span class="p">&gt</span>audioOutBaseId<span class="p">+</span>i<span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">)</span><span class="p">;</span>
          
          cmVOS_Zero<span class="p">(</span>y<span class="p">[</span>i<span class="p">]</span><span class="p">,</span>n<span class="p">)</span><span class="p">;</span>
          
          actChCnt <span class="p">+</span><span class="p">=</span> <span class="l">1</span><span class="p">;</span>
        <span class="p">}</span>
        
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <a href="cmProc4_h_0.html#cmRecdPlayExec">cmRecdPlayExec</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>rcdply<span class="p">,</span>x<span class="p">,</span>y<span class="p">,</span>actChCnt<span class="p">,</span>n<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspRecdPlayRecv_defn"></a><a name="_cmDspRecdPlayRecv"></a><span class="f">_cmDspRecdPlayRecv</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspRecdPlay_t">cmDspRecdPlay_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspRecdPlay_t">cmDspRecdPlay_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>rcdply <span class="p">=</span><span class="p">=</span> NULL <span class="p">)</span>
    <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
  
  <span class="k">switch</span><span class="p">(</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">)</span>
  <span class="p">{</span>
  <span class="k">case</span> <a href="#kCmdPrId">kCmdPrId</a><span class="p">:</span>
    <span class="k">if</span><span class="p">(</span> <a href="cmDspClass_h_0.html#cmDspSymbol">cmDspSymbol</a><span class="p">(</span>inst<span class="p">,</span><a href="#kCmdPrId">kCmdPrId</a><span class="p">)</span> <span class="p">=</span><span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>onSymId <span class="p">)</span>
    <span class="p">{</span>
      printf<span class="p">(</span><span class="l">&quotrewind\n&quot</span><span class="p">)</span><span class="p">;</span>
      <a href="cmProc4_h_0.html#cmRecdPlayRewind">cmRecdPlayRewind</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>rcdply<span class="p">)</span><span class="p">;</span>
      <span class="c">//p-&ampgtscLocIdx = <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a>(inst,<a href="#kScInitLocIdxPrId">kScInitLocIdxPrId</a>);</span>
    <span class="p">}</span>
    <span class="k">else</span>
      <span class="k">if</span><span class="p">(</span> <a href="cmDspClass_h_0.html#cmDspSymbol">cmDspSymbol</a><span class="p">(</span>inst<span class="p">,</span><a href="#kCmdPrId">kCmdPrId</a><span class="p">)</span> <span class="p">=</span><span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>offSymId <span class="p">)</span>
    <span class="p">{</span>
    <span class="p">}</span>
    
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kCurLaSecsPrId">kCurLaSecsPrId</a><span class="p">:</span>
    <a href="cmProc4_h_0.html#cmRecdPlaySetLaSecs">cmRecdPlaySetLaSecs</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>rcdply<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kCurLaSecsPrId">kCurLaSecsPrId</a><span class="p">)</span><span class="p">)</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kScInitLocIdxPrId">kScInitLocIdxPrId</a><span class="p">:</span>
    printf<span class="p">(</span><span class="l">&quotinit-idx:%i\n&quot</span><span class="p">,</span><a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kScInitLocIdxPrId">kScInitLocIdxPrId</a><span class="p">)</span><span class="p">)</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kScLocIdxPrId">kScLocIdxPrId</a><span class="p">:</span>
    <span class="p">{</span>
      <span class="k">unsigned</span> endScLocIdx <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kScLocIdxPrId">kScLocIdxPrId</a><span class="p">)</span><span class="p">;</span>
      
      <span class="k">if</span><span class="p">(</span> endScLocIdx <span class="p">&lt</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kScInitLocIdxPrId">kScInitLocIdxPrId</a><span class="p">)</span> <span class="p">)</span>
        <span class="k">break</span><span class="p">;</span>
      
      <a href="cmScore_h_0.html#cmScoreLoc_t">cmScoreLoc_t</a><span class="p">*</span>    loc <span class="p">=</span> <a href="cmScore_h_0.html#cmScoreLoc">cmScoreLoc</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>scH<span class="p">,</span> endScLocIdx <span class="p">)</span><span class="p">;</span>
      <span class="k">if</span><span class="p">(</span> loc <span class="p">=</span><span class="p">=</span> NULL <span class="p">)</span>
        <span class="k">break</span><span class="p">;</span>
      
      <a href="cmScore_h_0.html#cmScoreMarker_t">cmScoreMarker_t</a><span class="p">*</span> mp  <span class="p">=</span> loc<span class="p">-</span><span class="p">&gt</span>markList<span class="p">;</span>
      
      <span class="k">for</span><span class="p">(</span><span class="p">;</span> mp<span class="p">!</span><span class="p">=</span>NULL<span class="p">;</span> mp<span class="p">=</span>mp<span class="p">-</span><span class="p">&gt</span>link<span class="p">)</span>
        <span class="k">switch</span><span class="p">(</span> mp<span class="p">-</span><span class="p">&gt</span>markTypeId <span class="p">)</span>
      <span class="p">{</span>
      <span class="k">case</span> <a href="cmScore_h_0.html#kRecdBegScMId">kRecdBegScMId</a><span class="p">:</span>
        printf<span class="p">(</span><span class="l">&quotrecd-beg %s\n&quot</span><span class="p">,</span><a href="cmSymTbl_h_0.html#cmSymTblLabel">cmSymTblLabel</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span>mp<span class="p">-</span><span class="p">&gt</span>labelSymId<span class="p">)</span><span class="p">)</span><span class="p">;</span>
        <a href="cmProc4_h_0.html#cmRecdPlayBeginRecord">cmRecdPlayBeginRecord</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>rcdply<span class="p">,</span> mp<span class="p">-</span><span class="p">&gt</span>labelSymId <span class="p">)</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
        
      <span class="k">case</span> <a href="cmScore_h_0.html#kRecdEndScMId">kRecdEndScMId</a><span class="p">:</span>
        printf<span class="p">(</span><span class="l">&quotrecd-end %s\n&quot</span><span class="p">,</span><a href="cmSymTbl_h_0.html#cmSymTblLabel">cmSymTblLabel</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span>mp<span class="p">-</span><span class="p">&gt</span>labelSymId<span class="p">)</span><span class="p">)</span><span class="p">;</span>
        <a href="cmProc4_h_0.html#cmRecdPlayEndRecord">cmRecdPlayEndRecord</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>rcdply<span class="p">,</span> mp<span class="p">-</span><span class="p">&gt</span>labelSymId <span class="p">)</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
        
      <span class="k">case</span> <a href="cmScore_h_0.html#kPlayBegScMId">kPlayBegScMId</a><span class="p">:</span>
        printf<span class="p">(</span><span class="l">&quotplay-beg\n&quot</span><span class="p">)</span><span class="p">;</span>
        <a href="cmProc4_h_0.html#cmRecdPlayBeginPlay">cmRecdPlayBeginPlay</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>rcdply<span class="p">,</span> mp<span class="p">-</span><span class="p">&gt</span>labelSymId <span class="p">)</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
        
      <span class="k">case</span> <a href="cmScore_h_0.html#kPlayEndScMId">kPlayEndScMId</a><span class="p">:</span>
        printf<span class="p">(</span><span class="l">&quotplay-end\n&quot</span><span class="p">)</span><span class="p">;</span>
        <a href="cmProc4_h_0.html#cmRecdPlayEndPlay">cmRecdPlayEndPlay</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>rcdply<span class="p">,</span> mp<span class="p">-</span><span class="p">&gt</span>labelSymId <span class="p">)</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
        
      <span class="k">case</span> <a href="cmScore_h_0.html#kFadeScMId">kFadeScMId</a><span class="p">:</span>
        printf<span class="p">(</span><span class="l">&quotfade-beg\n&quot</span><span class="p">)</span><span class="p">;</span>
        <a href="cmProc4_h_0.html#cmRecdPlayBeginFade">cmRecdPlayBeginFade</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>rcdply<span class="p">,</span> mp<span class="p">-</span><span class="p">&gt</span>labelSymId<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kFadeRatePrId">kFadeRatePrId</a><span class="p">)</span> <span class="p">)</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
        
      <span class="k">default</span><span class="p">:</span>
        <span class="k">break</span><span class="p">;</span>
      <span class="p">}</span>
      
      
      <span class="c">//p-&ampgtscLocIdx = endScLocIdx+1;</span>
    <span class="p">}</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> <a name="cmRecdPlayClassCons_defn"></a><span class="f"><a href="cmDspKr_h_0.html#cmRecdPlayClassCons">cmRecdPlayClassCons</a></span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspClassSetup">cmDspClassSetup</a><span class="p">(</span><span class="p">&amp</span>_cmRecdPlayDC<span class="p">,</span>ctx<span class="p">,</span><span class="l">&quotRecdPlay&quot</span><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspRecdPlayAlloc">_cmDspRecdPlayAlloc</a><span class="p">,</span>
  <a href="#_cmDspRecdPlayFree">_cmDspRecdPlayFree</a><span class="p">,</span>
  <a href="#_cmDspRecdPlayReset">_cmDspRecdPlayReset</a><span class="p">,</span>
  <a href="#_cmDspRecdPlayExec">_cmDspRecdPlayExec</a><span class="p">,</span>
  <a href="#_cmDspRecdPlayRecv">_cmDspRecdPlayRecv</a><span class="p">,</span>
  NULL<span class="p">,</span>
  NULL<span class="p">,</span>
  <span class="l">&quotScore controlled live recorder/player&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>_cmRecdPlayDC<span class="p">;</span>
<span class="p">}</span>

<span class="c"><hr id="hr1"></span></pre>
</div>
<div class="cod"><div class="blk_title">cmDspGoertzel : Goertzel tone detection filter</div><pre><a name="cmDspGoertzel"></a><span class="k">enum</span>
<span class="p">{</span>
  <a name="kHopFactGrId"></a><span class="e">kHopFactGrId</span><span class="p">,</span>
  <a name="kInGrId"></a><span class="e">kInGrId</span><span class="p">,</span>
  <a name="kHzBaseGrId"></a><span class="e">kHzBaseGrId</span><span class="p">,</span>
<span class="p">}</span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a> _cmGoertzelDC<span class="p">;</span>

<a name="cmDspGoertzel_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a> <a name="cmDspGoertzel_t.inst"></a><span class="i">inst</span><span class="p">;</span>
  <a href="cmProc5_h_0.html#cmGoertzel">cmGoertzel</a><span class="p">*</span> <a name="cmDspGoertzel_t.g"></a><span class="i">g</span><span class="p">;</span>
  <span class="k">double</span>      <a name="cmDspGoertzel_t.outPhs"></a><span class="i">outPhs</span><span class="p">;</span>
  <span class="k">unsigned</span>    <a name="cmDspGoertzel_t.outBaseGrId"></a><span class="i">outBaseGrId</span><span class="p">;</span>
  <span class="k">unsigned</span>    <a name="cmDspGoertzel_t.chCnt"></a><span class="i">chCnt</span><span class="p">;</span>
<span class="p">}</span> <span class="t"><a href="#cmDspGoertzel_t">cmDspGoertzel_t</a></span><span class="p">;</span>


<a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span>  <a name="_cmDspGoertzelAlloc_defn"></a><a name="_cmDspGoertzelAlloc"></a><span class="f">_cmDspGoertzelAlloc</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> classPtr<span class="p">,</span> <span class="k">unsigned</span> storeSymId<span class="p">,</span> <span class="k">unsigned</span> instSymId<span class="p">,</span> <span class="k">unsigned</span> id<span class="p">,</span> <span class="k">unsigned</span> va_cnt<span class="p">,</span> va_list vl <span class="p">)</span>
<span class="p">{</span>
  
  <span class="k">if</span><span class="p">(</span> va_cnt <span class="p">!</span><span class="p">=</span><span class="l">3</span> <span class="p">)</span>
  <span class="p">{</span>
    <a href="cmDspClass_h_0.html#cmDspClassErr">cmDspClassErr</a><span class="p">(</span>ctx<span class="p">,</span>classPtr<span class="p">,</span><a href="cmDspClass_h_0.html#kVarArgParseFailDspRC">kVarArgParseFailDspRC</a><span class="p">,</span><span class="l">&quotThe 'Goertzel' constructor must have two arguments: a channel count and frequency array.&quot</span><span class="p">)</span><span class="p">;</span>
    <span class="k">return</span> NULL<span class="p">;</span>
  <span class="p">}</span>
  
  va_list vl1<span class="p">;</span>
  va_copy<span class="p">(</span>vl1<span class="p">,</span>vl<span class="p">)</span><span class="p">;</span>
  
  <span class="k">unsigned</span> hopFact     <span class="p">=</span> va_arg<span class="p">(</span>vl<span class="p">,</span><span class="k">unsigned</span><span class="p">)</span><span class="p">;</span>
  <span class="k">int</span>      chCnt       <span class="p">=</span> va_arg<span class="p">(</span>vl<span class="p">,</span><span class="k">int</span><span class="p">)</span><span class="p">;</span>
  <span class="k">double</span><span class="p">*</span>  hzV         <span class="p">=</span> va_arg<span class="p">(</span>vl<span class="p">,</span><span class="k">double</span><span class="p">*</span><span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span> outBaseGrId <span class="p">=</span> <a href="#kHzBaseGrId">kHzBaseGrId</a> <span class="p">+</span> chCnt<span class="p">;</span>
  <span class="k">unsigned</span> i<span class="p">;</span>
  
  <a href="#cmDspGoertzel_t">cmDspGoertzel_t</a><span class="p">*</span> p <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstAllocV">cmDspInstAllocV</a><span class="p">(</span><a href="#cmDspGoertzel_t">cmDspGoertzel_t</a><span class="p">,</span>ctx<span class="p">,</span>classPtr<span class="p">,</span>instSymId<span class="p">,</span>id<span class="p">,</span>storeSymId<span class="p">,</span><span class="l">1</span><span class="p">,</span>vl1<span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quothop&quot</span><span class="p">,</span> <a href="#kHopFactGrId">kHopFactGrId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a><span class="p">,</span>    <span class="l">&quotHop factor&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotin&quot</span><span class="p">,</span>  <a href="#kInGrId">kInGrId</a><span class="p">,</span>       <span class="l">0</span><span class="p">,</span><span class="l">1</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kAudioBufDsvFl">kAudioBufDsvFl</a><span class="p">,</span>  <span class="l">&quotAudio input&quot</span><span class="p">,</span>
  chCnt<span class="p">,</span>     <span class="l">&quothz&quot</span><span class="p">,</span>  <a href="#kHzBaseGrId">kHzBaseGrId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a><span class="p">,</span>    <span class="l">&quotHz input.&quot</span><span class="p">,</span>
  chCnt<span class="p">,</span>     <span class="l">&quotout&quot</span><span class="p">,</span> outBaseGrId<span class="p">,</span>   <span class="l">0</span><span class="p">,</span><span class="l">1</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a><span class="p">,</span>    <span class="l">&quotDetector output&quot</span><span class="p">,</span>
  <span class="l">0</span> <span class="p">)</span><span class="p">;</span>
  
  va_end<span class="p">(</span>vl1<span class="p">)</span><span class="p">;</span>
  
  
  p<span class="p">-</span><span class="p">&gt</span>outBaseGrId <span class="p">=</span> outBaseGrId<span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>chCnt       <span class="p">=</span> chCnt<span class="p">;</span>
  
  p<span class="p">-</span><span class="p">&gt</span>g <span class="p">=</span> <a href="cmProc5_h_0.html#cmGoertzelAlloc">cmGoertzelAlloc</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>cmProcCtx<span class="p">,</span> NULL<span class="p">,</span> <span class="l">0</span><span class="p">,</span> NULL<span class="p">,</span> <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span><span class="l">0</span> <span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kHopFactGrId">kHopFactGrId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmGlobal_h_0.html#cmMax">cmMax</a><span class="p">(</span>hopFact<span class="p">,</span><span class="l">1</span><span class="p">)</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">for</span><span class="p">(</span>i<span class="p">=</span><span class="l">0</span><span class="p">;</span> i<span class="p">&lt</span>chCnt<span class="p">;</span> <span class="p">+</span><span class="p">+</span>i<span class="p">)</span>
    <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kHzBaseGrId">kHzBaseGrId</a><span class="p">+</span>i<span class="p">,</span> <span class="l">0.0</span><span class="p">,</span> hzV<span class="p">[</span>i<span class="p">]</span> <span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspGoertzelSetup_defn"></a><a name="_cmDspGoertzelSetup"></a><span class="f">_cmDspGoertzelSetup</span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>        rc         <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspGoertzel_t">cmDspGoertzel_t</a><span class="p">*</span> p          <span class="p">=</span> <span class="p">(</span><a href="#cmDspGoertzel_t">cmDspGoertzel_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  <span class="k">unsigned</span>         hopFact    <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kHopFactGrId">kHopFactGrId</a><span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>         procSmpCnt <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBufSmpCount">cmDspAudioBufSmpCount</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kInGrId">kInGrId</a><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>         wndSmpCnt  <span class="p">=</span> procSmpCnt <span class="p">*</span> hopFact<span class="p">;</span>
  <span class="k">double</span>           fcHzV<span class="p">[</span> p<span class="p">-</span><span class="p">&gt</span>chCnt <span class="p">]</span><span class="p">;</span>
  <span class="k">unsigned</span>         i<span class="p">;</span>
  
  <span class="k">for</span><span class="p">(</span>i<span class="p">=</span><span class="l">0</span><span class="p">;</span> i<span class="p">&lt</span>p<span class="p">-</span><span class="p">&gt</span>chCnt<span class="p">;</span> <span class="p">+</span><span class="p">+</span>i<span class="p">)</span>
  <span class="p">{</span>
    <span class="k">double</span> hz<span class="p">;</span>
    <span class="k">if</span><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>g<span class="p">-</span><span class="p">&gt</span>ch <span class="p">=</span><span class="p">=</span> NULL <span class="p">|</span><span class="p">|</span> p<span class="p">-</span><span class="p">&gt</span>g<span class="p">-</span><span class="p">&gt</span>ch<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>hz <span class="p">=</span><span class="p">=</span> <span class="l">0</span> <span class="p">)</span>
      hz <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kHzBaseGrId">kHzBaseGrId</a><span class="p">)</span><span class="p">;</span>
    <span class="k">else</span>
      hz <span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>g<span class="p">-</span><span class="p">&gt</span>ch<span class="p">[</span>i<span class="p">]</span><span class="p">.</span>hz<span class="p">;</span>
    
    fcHzV<span class="p">[</span>i<span class="p">]</span> <span class="p">=</span> hz<span class="p">;</span>
  <span class="p">}</span>
  
  <span class="k">if</span><span class="p">(</span> <a href="cmProc5_h_0.html#cmGoertzelInit">cmGoertzelInit</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>g<span class="p">,</span><a href="cmDspSys_h_0.html#cmDspSysSampleRate">cmDspSysSampleRate</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>dspH<span class="p">)</span><span class="p">,</span>fcHzV<span class="p">,</span>p<span class="p">-</span><span class="p">&gt</span>chCnt<span class="p">,</span>procSmpCnt<span class="p">,</span>procSmpCnt<span class="p">,</span>wndSmpCnt<span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmGlobal_h_0.html#cmOkRC">cmOkRC</a> <span class="p">)</span>
    rc <span class="p">=</span> <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>inst<span class="p">-</span><span class="p">&gt</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span> <a href="cmDspClass_h_0.html#kSubSysFailDspRC">kSubSysFailDspRC</a><span class="p">,</span> <span class="l">&quotUnable to initialize the internal Goertzel detector.&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspGoertzelFree_defn"></a><a name="_cmDspGoertzelFree"></a><span class="f">_cmDspGoertzelFree</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>        rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspGoertzel_t">cmDspGoertzel_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspGoertzel_t">cmDspGoertzel_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <a href="cmProc5_h_0.html#cmGoertzelFree">cmGoertzelFree</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>g<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspGoertzelReset_defn"></a><a name="_cmDspGoertzelReset"></a><span class="f">_cmDspGoertzelReset</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspGoertzel_t">cmDspGoertzel_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspGoertzel_t">cmDspGoertzel_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspApplyAllDefaults">cmDspApplyAllDefaults</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">;</span>
  
  p<span class="p">-</span><span class="p">&gt</span>outPhs <span class="p">=</span> <span class="l">0</span><span class="p">;</span>
  
  <span class="k">return</span> <a href="#_cmDspGoertzelSetup">_cmDspGoertzelSetup</a><span class="p">(</span>ctx<span class="p">,</span> inst <span class="p">)</span><span class="p">;</span>
<span class="p">}</span> 

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspGoertzelExec_defn"></a><a name="_cmDspGoertzelExec"></a><span class="f">_cmDspGoertzelExec</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>         rc        <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspGoertzel_t">cmDspGoertzel_t</a><span class="p">*</span>  p         <span class="p">=</span> <span class="p">(</span><a href="#cmDspGoertzel_t">cmDspGoertzel_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  <span class="k">const</span> <a href="cmFloatTypes_h_0.html#cmSample_t">cmSample_t</a><span class="p">*</span> x         <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBuf">cmDspAudioBuf</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kInGrId">kInGrId</a><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>          n         <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBufSmpCount">cmDspAudioBufSmpCount</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kInGrId">kInGrId</a><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <span class="k">double</span>            outMs     <span class="p">=</span> <span class="l">50.0</span><span class="p">;</span>
  <span class="k">double</span>            outPhsMax <span class="p">=</span> outMs <span class="p">*</span> <a href="cmDspSys_h_0.html#cmDspSysSampleRate">cmDspSysSampleRate</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>dspH<span class="p">)</span>  <span class="p">/</span> <span class="l">1000.0</span><span class="p">;</span>
  <span class="k">double</span>            outV<span class="p">[</span> p<span class="p">-</span><span class="p">&gt</span>chCnt <span class="p">]</span><span class="p">;</span>
  <span class="k">unsigned</span>          i<span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> x <span class="p">!</span><span class="p">=</span> NULL <span class="p">)</span>
  <span class="p">{</span>
    <a href="cmProc5_h_0.html#cmGoertzelExec">cmGoertzelExec</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>g<span class="p">,</span>x<span class="p">,</span>n<span class="p">,</span>outV<span class="p">,</span>p<span class="p">-</span><span class="p">&gt</span>chCnt<span class="p">)</span><span class="p">;</span>
    
    p<span class="p">-</span><span class="p">&gt</span>outPhs <span class="p">+</span><span class="p">=</span> n<span class="p">;</span>
    <span class="k">if</span><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>outPhs <span class="p">&gt</span> outPhsMax <span class="p">)</span>
    <span class="p">{</span>
      <span class="k">while</span><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>outPhs <span class="p">&gt</span> outPhsMax <span class="p">)</span>
        p<span class="p">-</span><span class="p">&gt</span>outPhs <span class="p">-</span><span class="p">=</span> outPhsMax<span class="p">;</span>
      
      <span class="k">for</span><span class="p">(</span>i<span class="p">=</span><span class="l">0</span><span class="p">;</span> i<span class="p">&lt</span>p<span class="p">-</span><span class="p">&gt</span>chCnt<span class="p">;</span> <span class="p">+</span><span class="p">+</span>i<span class="p">)</span>
      <span class="p">{</span>
        <a href="cmDspClass_h_0.html#cmDspSetDouble">cmDspSetDouble</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>p<span class="p">-</span><span class="p">&gt</span>outBaseGrId<span class="p">+</span>i<span class="p">,</span>outV<span class="p">[</span>i<span class="p">]</span><span class="p">)</span><span class="p">;</span>
        <span class="c">//printf(&ampquot%f &ampquot,outV[i]);</span>
      <span class="p">}</span>
      <span class="c">//printf(&ampquot\n&ampquot);</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspGoertzelRecv_defn"></a><a name="_cmDspGoertzelRecv"></a><span class="f">_cmDspGoertzelRecv</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspGoertzel_t">cmDspGoertzel_t</a><span class="p">*</span>  p         <span class="p">=</span> <span class="p">(</span><a href="#cmDspGoertzel_t">cmDspGoertzel_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> <a href="#kHzBaseGrId">kHzBaseGrId</a> <span class="p">&lt</span><span class="p">=</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">&amp</span><span class="p">&amp</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">&lt</span> <a href="#kHzBaseGrId">kHzBaseGrId</a><span class="p">+</span>p<span class="p">-</span><span class="p">&gt</span>chCnt <span class="p">)</span>
    <a href="cmProc5_h_0.html#cmGoertzelSetFcHz">cmGoertzelSetFcHz</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>g<span class="p">,</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">-</span> <a href="#kHzBaseGrId">kHzBaseGrId</a><span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span>evt<span class="p">-</span><span class="p">&gt</span>dstVarId<span class="p">)</span><span class="p">)</span><span class="p">;</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId<span class="p">=</span><span class="p">=</span><a href="#kHopFactGrId">kHopFactGrId</a> <span class="p">)</span>
    <span class="p">{</span>
      <a href="#_cmDspGoertzelSetup">_cmDspGoertzelSetup</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> <a name="cmGoertzelClassCons_defn"></a><span class="f"><a href="cmDspKr_h_0.html#cmGoertzelClassCons">cmGoertzelClassCons</a></span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspClassSetup">cmDspClassSetup</a><span class="p">(</span><span class="p">&amp</span>_cmGoertzelDC<span class="p">,</span>ctx<span class="p">,</span><span class="l">&quotGoertzel&quot</span><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspGoertzelAlloc">_cmDspGoertzelAlloc</a><span class="p">,</span>
  <a href="#_cmDspGoertzelFree">_cmDspGoertzelFree</a><span class="p">,</span>
  <a href="#_cmDspGoertzelReset">_cmDspGoertzelReset</a><span class="p">,</span>
  <a href="#_cmDspGoertzelExec">_cmDspGoertzelExec</a><span class="p">,</span>
  <a href="#_cmDspGoertzelRecv">_cmDspGoertzelRecv</a><span class="p">,</span>
  NULL<span class="p">,</span>
  NULL<span class="p">,</span>
  <span class="l">&quotGoertzel Tone Detector Filter&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>_cmGoertzelDC<span class="p">;</span>
<span class="p">}</span>

<span class="c"><hr id="hr1"></span></pre>
</div>
<div class="cod"><div class="blk_title">cmDspSyncRecd : Time align a MIDI and associated audio recording</div><pre><a name="cmDspSyncRecd"></a>
<span class="k">enum</span>
<span class="p">{</span>
  <a name="kRecdDirSrId"></a><span class="e">kRecdDirSrId</span><span class="p">,</span>
  <a name="kSrFnSrId"></a><span class="e">kSrFnSrId</span><span class="p">,</span>
  <a name="kAfSrId"></a><span class="e">kAfSrId</span><span class="p">,</span>
  <a name="kBitsSrId"></a><span class="e">kBitsSrId</span><span class="p">,</span>
  <a name="kCmdSrId"></a><span class="e">kCmdSrId</span><span class="p">,</span>
  <a name="kStatusSrId"></a><span class="e">kStatusSrId</span><span class="p">,</span>
  <a name="kD0SrId"></a><span class="e">kD0SrId</span><span class="p">,</span>
  <a name="kD1SrId"></a><span class="e">kD1SrId</span><span class="p">,</span>
  <a name="kSecSrId"></a><span class="e">kSecSrId</span><span class="p">,</span>
  <a name="kNSecSrId"></a><span class="e">kNSecSrId</span><span class="p">,</span>
  <a name="kAinBaseSrId"></a><span class="e">kAinBaseSrId</span>
<span class="p">}</span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a> _cmSyncRecdDC<span class="p">;</span>

<a name="cmDspSyncRecd_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a>     <a name="cmDspSyncRecd_t.inst"></a><span class="i">inst</span><span class="p">;</span>
  <span class="k">unsigned</span>        <a name="cmDspSyncRecd_t.chCnt"></a><span class="i">chCnt</span><span class="p">;</span>
  <a href="cmTime_h_0.html#cmTimeSpec_t">cmTimeSpec_t</a>    <a name="cmDspSyncRecd_t.ats"></a><span class="i">ats</span><span class="p">;</span>
  <a href="cmSyncRecd_h_0.html#cmSyncRecdH_t">cmSyncRecdH_t</a>   <a name="cmDspSyncRecd_t.srH"></a><span class="i">srH</span><span class="p">;</span>
  <span class="k">unsigned</span>        <a name="cmDspSyncRecd_t.openSymId"></a><span class="i">openSymId</span><span class="p">;</span>
  <span class="k">unsigned</span>        <a name="cmDspSyncRecd_t.closeSymId"></a><span class="i">closeSymId</span><span class="p">;</span>
  <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> <a name="cmDspSyncRecd_t.aFn"></a><span class="i">aFn</span><span class="p">;</span>
  <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> <a name="cmDspSyncRecd_t.srFn"></a><span class="i">srFn</span><span class="p">;</span>
  <span class="k">unsigned</span>        <a name="cmDspSyncRecd_t.smpIdx"></a><span class="i">smpIdx</span><span class="p">;</span>
<span class="p">}</span> <span class="t"><a href="#cmDspSyncRecd_t">cmDspSyncRecd_t</a></span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspSyncRecdCreateFile_defn"></a><a name="_cmDspSyncRecdCreateFile"></a><span class="f">_cmDspSyncRecdCreateFile</span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspSyncRecd_t">cmDspSyncRecd_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspSyncRecd_t">cmDspSyncRecd_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> aFn  <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspStrcz">cmDspStrcz</a><span class="p">(</span>inst<span class="p">,</span><a href="#kAfSrId">kAfSrId</a><span class="p">)</span><span class="p">;</span>
  <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> srFn <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspStrcz">cmDspStrcz</a><span class="p">(</span>inst<span class="p">,</span><a href="#kSrFnSrId">kSrFnSrId</a><span class="p">)</span><span class="p">;</span>
  <span class="k">const</span> <a href="cmGlobal_h_0.html#cmChar_t">cmChar_t</a><span class="p">*</span> dir  <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspStrcz">cmDspStrcz</a><span class="p">(</span>inst<span class="p">,</span><a href="#kRecdDirSrId">kRecdDirSrId</a><span class="p">)</span><span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> <span class="p">!</span><a href="cmFileSys_h_0.html#cmFsIsDir">cmFsIsDir</a><span class="p">(</span>dir<span class="p">)</span> <span class="p">)</span>
    <span class="k">return</span> <a href="cmDspClass_h_0.html#cmDspInstErr">cmDspInstErr</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="cmDspClass_h_0.html#kInvalidArgDspRC">kInvalidArgDspRC</a><span class="p">,</span><span class="l">&quot'%s' is not a valid directory.&quot</span><span class="p">,</span><a href="cmGlobal_h_0.html#cmStringNullGuard">cmStringNullGuard</a><span class="p">(</span>dir<span class="p">)</span><span class="p">)</span><span class="p">;</span>
  
  <a href="cmMallocDebug_h_0.html#cmMemPtrFree">cmMemPtrFree</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>aFn<span class="p">)</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span> <a href="cmFileSys_h_0.html#cmFsGenFn">cmFsGenFn</a><span class="p">(</span>dir<span class="p">,</span>aFn<span class="p">,</span><span class="l">&quotaiff&quot</span><span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>aFn<span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmFileSys_h_0.html#kOkFsRC">kOkFsRC</a> <span class="p">)</span>
    <span class="k">return</span> <a href="cmDspClass_h_0.html#cmDspInstErr">cmDspInstErr</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="cmDspClass_h_0.html#kFileSysFailDspRC">kFileSysFailDspRC</a><span class="p">,</span><span class="l">&quotAudio file name generation failed for dir='%s' and prefix='%s'.&quot</span><span class="p">,</span><a href="cmGlobal_h_0.html#cmStringNullGuard">cmStringNullGuard</a><span class="p">(</span>dir<span class="p">)</span><span class="p">,</span><a href="cmGlobal_h_0.html#cmStringNullGuard">cmStringNullGuard</a><span class="p">(</span>aFn<span class="p">)</span><span class="p">)</span><span class="p">;</span>
  
  <a href="cmMallocDebug_h_0.html#cmMemPtrFree">cmMemPtrFree</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>srFn<span class="p">)</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span> <a href="cmFileSys_h_0.html#cmFsGenFn">cmFsGenFn</a><span class="p">(</span>dir<span class="p">,</span>srFn<span class="p">,</span><span class="l">&quotsr&quot</span><span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>srFn<span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmFileSys_h_0.html#kOkFsRC">kOkFsRC</a> <span class="p">)</span>
    <span class="k">return</span> <a href="cmDspClass_h_0.html#cmDspInstErr">cmDspInstErr</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="cmDspClass_h_0.html#kFileSysFailDspRC">kFileSysFailDspRC</a><span class="p">,</span><span class="l">&quotSync-recd file name generation failed for dir='%s' and prefix='%s'.&quot</span><span class="p">,</span><a href="cmGlobal_h_0.html#cmStringNullGuard">cmStringNullGuard</a><span class="p">(</span>dir<span class="p">)</span><span class="p">,</span><a href="cmGlobal_h_0.html#cmStringNullGuard">cmStringNullGuard</a><span class="p">(</span>srFn<span class="p">)</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">unsigned</span> bits <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kBitsSrId">kBitsSrId</a><span class="p">)</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span> <a href="cmSyncRecd_h_0.html#cmSyncRecdCreate">cmSyncRecdCreate</a><span class="p">(</span>  ctx<span class="p">-</span><span class="p">&gt</span><a href="cmProcObj_h_0.html#cmCtx">cmCtx</a><span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>srH<span class="p">,</span> p<span class="p">-</span><span class="p">&gt</span>srFn<span class="p">,</span> p<span class="p">-</span><span class="p">&gt</span>aFn<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspSampleRate">cmDspSampleRate</a><span class="p">(</span>ctx<span class="p">)</span><span class="p">,</span> p<span class="p">-</span><span class="p">&gt</span>chCnt<span class="p">,</span> bits <span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmSyncRecd_h_0.html#kOkSyRC">kOkSyRC</a> <span class="p">)</span>
    <span class="k">return</span> <a href="cmDspClass_h_0.html#cmDspInstErr">cmDspInstErr</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="cmDspClass_h_0.html#kSubSysFailDspRC">kSubSysFailDspRC</a><span class="p">,</span><span class="l">&quotSync-recd file create failed for '%s'.&quot</span><span class="p">,</span>p<span class="p">-</span><span class="p">&gt</span>srFn<span class="p">)</span><span class="p">;</span>
  
  p<span class="p">-</span><span class="p">&gt</span>smpIdx <span class="p">=</span> <span class="l">0</span><span class="p">;</span>
  
  <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span>  <a name="_cmDspSyncRecdAlloc_defn"></a><a name="_cmDspSyncRecdAlloc"></a><span class="f">_cmDspSyncRecdAlloc</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> classPtr<span class="p">,</span> <span class="k">unsigned</span> storeSymId<span class="p">,</span> <span class="k">unsigned</span> instSymId<span class="p">,</span> <span class="k">unsigned</span> id<span class="p">,</span> <span class="k">unsigned</span> va_cnt<span class="p">,</span> va_list vl <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspSyncRecd_t">cmDspSyncRecd_t</a><span class="p">*</span> p <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstAllocV">cmDspInstAllocV</a><span class="p">(</span><a href="#cmDspSyncRecd_t">cmDspSyncRecd_t</a><span class="p">,</span>ctx<span class="p">,</span>classPtr<span class="p">,</span>instSymId<span class="p">,</span>id<span class="p">,</span>storeSymId<span class="p">,</span>va_cnt<span class="p">,</span>vl<span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotdir&quot</span><span class="p">,</span>    <a href="#kRecdDirSrId">kRecdDirSrId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kStrzDsvFl">kStrzDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kReqArgDsvFl">kReqArgDsvFl</a><span class="p">,</span> <span class="l">&quotRecording  directory.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotsrfn&quot</span><span class="p">,</span>   <a href="#kSrFnSrId">kSrFnSrId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kStrzDsvFl">kStrzDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kReqArgDsvFl">kReqArgDsvFl</a><span class="p">,</span> <span class="l">&quotSyncRecd file prefix.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotafn&quot</span><span class="p">,</span>    <a href="#kAfSrId">kAfSrId</a><span class="p">,</span>       <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kStrzDsvFl">kStrzDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kReqArgDsvFl">kReqArgDsvFl</a><span class="p">,</span> <span class="l">&quotAudio file prefix.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotbits&quot</span><span class="p">,</span>   <a href="#kBitsSrId">kBitsSrId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span> <span class="l">&quotAudio file bits per sample.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotcmd&quot</span><span class="p">,</span>    <a href="#kCmdSrId">kCmdSrId</a><span class="p">,</span>      <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kSymDsvFl">kSymDsvFl</a><span class="p">,</span>                 <span class="l">&quotCommand: open | close&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotstatus&quot</span><span class="p">,</span> <a href="#kStatusSrId">kStatusSrId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                <span class="l">&quotMIDI status&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotd0&quot</span><span class="p">,</span>     <a href="#kD0SrId">kD0SrId</a><span class="p">,</span>       <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                <span class="l">&quotMIDI d0&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotd1&quot</span><span class="p">,</span>     <a href="#kD1SrId">kD1SrId</a><span class="p">,</span>       <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                <span class="l">&quotMIDI d1&quot</span><span class="p">,</span> 
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotsec&quot</span><span class="p">,</span>    <a href="#kSecSrId">kSecSrId</a><span class="p">,</span>      <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                <span class="l">&quotMIDI Timestamp Seconds&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotnsec&quot</span><span class="p">,</span>   <a href="#kNSecSrId">kNSecSrId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>                <span class="l">&quotMIDI Timestamp Nanoseconds&quot</span><span class="p">,</span>
  <span class="l">2</span><span class="p">,</span>         <span class="l">&quotain&quot</span><span class="p">,</span>    <a href="#kAinBaseSrId">kAinBaseSrId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span><span class="l">1</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kAudioBufDsvFl">kAudioBufDsvFl</a><span class="p">,</span>            <span class="l">&quotAudio Input&quot</span><span class="p">,</span>    
  <span class="l">0</span> <span class="p">)</span><span class="p">;</span>
  
  p<span class="p">-</span><span class="p">&gt</span>chCnt <span class="p">=</span> <span class="l">2</span><span class="p">;</span>
  
  p<span class="p">-</span><span class="p">&gt</span>openSymId  <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblRegisterStaticSymbol">cmSymTblRegisterStaticSymbol</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span><span class="l">&quotopen&quot</span><span class="p">)</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>closeSymId <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblRegisterStaticSymbol">cmSymTblRegisterStaticSymbol</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span><span class="l">&quotclose&quot</span><span class="p">)</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kBitsSrId">kBitsSrId</a><span class="p">,</span><span class="l">0</span><span class="p">,</span><span class="l">16</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">;</span>
<span class="p">}</span>


<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspSyncRecdFree_defn"></a><a name="_cmDspSyncRecdFree"></a><span class="f">_cmDspSyncRecdFree</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>        rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspSyncRecd_t">cmDspSyncRecd_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspSyncRecd_t">cmDspSyncRecd_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <a href="cmMallocDebug_h_0.html#cmMemPtrFree">cmMemPtrFree</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>aFn<span class="p">)</span><span class="p">;</span>
  <a href="cmMallocDebug_h_0.html#cmMemPtrFree">cmMemPtrFree</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>srFn<span class="p">)</span><span class="p">;</span>
  <a href="cmSyncRecd_h_0.html#cmSyncRecdFinal">cmSyncRecdFinal</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>srH<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspSyncRecdReset_defn"></a><a name="_cmDspSyncRecdReset"></a><span class="f">_cmDspSyncRecdReset</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspApplyAllDefaults">cmDspApplyAllDefaults</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span> 

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspSyncRecdExec_defn"></a><a name="_cmDspSyncRecdExec"></a><span class="f">_cmDspSyncRecdExec</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>      rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  
  <a href="#cmDspSyncRecd_t">cmDspSyncRecd_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspSyncRecd_t">cmDspSyncRecd_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <span class="k">const</span> <a href="cmFloatTypes_h_0.html#cmSample_t">cmSample_t</a><span class="p">*</span> x<span class="p">[</span> p<span class="p">-</span><span class="p">&gt</span>chCnt <span class="p">]</span><span class="p">;</span>
  <span class="k">unsigned</span> n <span class="p">=</span> <span class="l">0</span><span class="p">;</span>
  <span class="k">unsigned</span> i<span class="p">;</span>
  
  <span class="c">//const <a href="cmTime_h_0.html#cmTimeSpec_t">cmTimeSpec_t</a>* ts  = &ampampctx-&ampgtctx-&ampgtoTimeStamp;
  //printf(&ampquotSR: %ld %ld\n&ampquot,ts-&ampgttv_sec,ts-&ampgttv_nsec);</span>  
  p<span class="p">-</span><span class="p">&gt</span>ats <span class="p">=</span> ctx<span class="p">-</span><span class="p">&gt</span>ctx<span class="p">-</span><span class="p">&gt</span>iTimeStamp<span class="p">;</span>
  
  <span class="k">for</span><span class="p">(</span>i<span class="p">=</span><span class="l">0</span><span class="p">;</span> i<span class="p">&lt</span>p<span class="p">-</span><span class="p">&gt</span>chCnt<span class="p">;</span> <span class="p">+</span><span class="p">+</span>i<span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span> i<span class="p">=</span><span class="p">=</span><span class="l">0</span> <span class="p">)</span>
      n  <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBufSmpCount">cmDspAudioBufSmpCount</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kAinBaseSrId">kAinBaseSrId</a><span class="p">+</span>i<span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
    <span class="k">else</span>
    <span class="p">{</span> assert<span class="p">(</span> n <span class="p">=</span><span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBufSmpCount">cmDspAudioBufSmpCount</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kAinBaseSrId">kAinBaseSrId</a><span class="p">+</span>i<span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">)</span><span class="p">;</span> <span class="p">}</span>
    
    x<span class="p">[</span>i<span class="p">]</span> <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBuf">cmDspAudioBuf</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kAinBaseSrId">kAinBaseSrId</a><span class="p">+</span>i<span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="k">if</span><span class="p">(</span> n<span class="p">&gt</span><span class="l">0</span> <span class="p">&amp</span><span class="p">&amp</span> <a href="cmSyncRecd_h_0.html#cmSyncRecdIsValid">cmSyncRecdIsValid</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>srH <span class="p">)</span> <span class="p">)</span>
    <span class="k">if</span><span class="p">(</span> <a href="cmSyncRecd_h_0.html#cmSyncRecdAudioWrite">cmSyncRecdAudioWrite</a><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>srH<span class="p">,</span> <span class="p">&amp</span>ctx<span class="p">-</span><span class="p">&gt</span>ctx<span class="p">-</span><span class="p">&gt</span>iTimeStamp<span class="p">,</span> p<span class="p">-</span><span class="p">&gt</span>smpIdx<span class="p">,</span> x<span class="p">,</span> p<span class="p">-</span><span class="p">&gt</span>chCnt<span class="p">,</span> n <span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmSyncRecd_h_0.html#kOkSyRC">kOkSyRC</a> <span class="p">)</span>
      <span class="k">return</span> <a href="cmDspClass_h_0.html#cmDspInstErr">cmDspInstErr</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="cmDspClass_h_0.html#kSubSysFailDspRC">kSubSysFailDspRC</a><span class="p">,</span><span class="l">&quotSync-recd audio update failed.&quot</span><span class="p">)</span><span class="p">;</span>
  
  p<span class="p">-</span><span class="p">&gt</span>smpIdx <span class="p">+</span><span class="p">=</span> n<span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspSyncRecdRecv_defn"></a><a name="_cmDspSyncRecdRecv"></a><span class="f">_cmDspSyncRecdRecv</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspSyncRecd_t">cmDspSyncRecd_t</a><span class="p">*</span>  p         <span class="p">=</span> <span class="p">(</span><a href="#cmDspSyncRecd_t">cmDspSyncRecd_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
  
  <span class="k">switch</span><span class="p">(</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">)</span>
  <span class="p">{</span>
  <span class="k">case</span> <a href="#kStatusSrId">kStatusSrId</a><span class="p">:</span>
    <span class="k">if</span><span class="p">(</span><a href="cmMidi_h_0.html#cmMidiIsChStatus">cmMidiIsChStatus</a><span class="p">(</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kStatusSrId">kStatusSrId</a><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
    <span class="p">{</span>
      <a href="cmTime_h_0.html#cmTimeSpec_t">cmTimeSpec_t</a> ts<span class="p">;</span>
      ts<span class="p">.</span>tv_sec <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kSecSrId">kSecSrId</a><span class="p">)</span><span class="p">;</span>
      ts<span class="p">.</span>tv_nsec <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kNSecSrId">kNSecSrId</a><span class="p">)</span><span class="p">;</span>
      
      <span class="c">//printf(&ampquot%i %i\n&ampquot,<a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a>(inst,<a href="#kD1SrId">kD1SrId</a>),<a href="cmTime_h_0.html#cmTimeElapsedMicros">cmTimeElapsedMicros</a>(&ampampts,&ampampp-&ampgtats));</span>
      
      <span class="k">if</span><span class="p">(</span> <a href="cmSyncRecd_h_0.html#cmSyncRecdIsValid">cmSyncRecdIsValid</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>srH <span class="p">)</span> <span class="p">)</span>
        <span class="k">if</span><span class="p">(</span> <a href="cmSyncRecd_h_0.html#cmSyncRecdMidiWrite">cmSyncRecdMidiWrite</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>srH<span class="p">,</span> <span class="p">&amp</span>ts<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kStatusSrId">kStatusSrId</a><span class="p">)</span><span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kD0SrId">kD0SrId</a><span class="p">)</span><span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kD1SrId">kD1SrId</a><span class="p">)</span> <span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmSyncRecd_h_0.html#kOkSyRC">kOkSyRC</a> <span class="p">)</span>
          <span class="k">return</span> <a href="cmDspClass_h_0.html#cmDspInstErr">cmDspInstErr</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="cmDspClass_h_0.html#kSubSysFailDspRC">kSubSysFailDspRC</a><span class="p">,</span><span class="l">&quotSync-recd MIDI update failed.&quot</span><span class="p">)</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kCmdSrId">kCmdSrId</a><span class="p">:</span>
    <span class="p">{</span>
      <span class="k">unsigned</span> cmdId <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspSymbol">cmDspSymbol</a><span class="p">(</span>inst<span class="p">,</span><a href="#kCmdSrId">kCmdSrId</a><span class="p">)</span><span class="p">;</span>
      <span class="k">if</span><span class="p">(</span> cmdId <span class="p">=</span><span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>openSymId <span class="p">)</span>
        rc <span class="p">=</span> <a href="#_cmDspSyncRecdCreateFile">_cmDspSyncRecdCreateFile</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">;</span>
      <span class="k">else</span>
        <span class="k">if</span><span class="p">(</span> cmdId <span class="p">=</span><span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>closeSymId <span class="p">&amp</span><span class="p">&amp</span> <a href="cmSyncRecd_h_0.html#cmSyncRecdIsValid">cmSyncRecdIsValid</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>srH<span class="p">)</span><span class="p">)</span>
      <span class="p">{</span>
        <a href="cmSyncRecd_h_0.html#cmSyncRecdFinal">cmSyncRecdFinal</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>srH<span class="p">)</span><span class="p">;</span>
        <span class="c">//<a href="cmSyncRecd_h_0.html#cmSyncRecdTest">cmSyncRecdTest</a>(ctx-&ampgtcmCtx);</span>
        
      <span class="p">}</span>
      
    <span class="p">}</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> <a name="cmSyncRecdClassCons_defn"></a><span class="f"><a href="cmDspKr_h_0.html#cmSyncRecdClassCons">cmSyncRecdClassCons</a></span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspClassSetup">cmDspClassSetup</a><span class="p">(</span><span class="p">&amp</span>_cmSyncRecdDC<span class="p">,</span>ctx<span class="p">,</span><span class="l">&quotSyncRecd&quot</span><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspSyncRecdAlloc">_cmDspSyncRecdAlloc</a><span class="p">,</span>
  <a href="#_cmDspSyncRecdFree">_cmDspSyncRecdFree</a><span class="p">,</span>
  <a href="#_cmDspSyncRecdReset">_cmDspSyncRecdReset</a><span class="p">,</span>
  <a href="#_cmDspSyncRecdExec">_cmDspSyncRecdExec</a><span class="p">,</span>
  <a href="#_cmDspSyncRecdRecv">_cmDspSyncRecdRecv</a><span class="p">,</span>
  NULL<span class="p">,</span>
  NULL<span class="p">,</span>
  <span class="l">&quotSynchronized Audio and MIDI recorder.&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>_cmSyncRecdDC<span class="p">;</span>
<span class="p">}</span>


<span class="c"><hr id="hr1"></span></pre>
</div>
<div class="cod"><div class="blk_title">cmDspTakeSeqBldr : User interface unit for creating a single sequence from multiple, score aligned, MIDI fragments.</div><pre><a name="cmDspTakeSeqBldr"></a>
<span class="k">enum</span>
<span class="p">{</span>
  <a name="kFnTsbId"></a><span class="e">kFnTsbId</span><span class="p">,</span>
  <a name="kBldrTsbId"></a><span class="e">kBldrTsbId</span><span class="p">,</span>
  <a name="kSelTsbId"></a><span class="e">kSelTsbId</span><span class="p">,</span>
  <a name="kRefreshTsbId"></a><span class="e">kRefreshTsbId</span><span class="p">,</span>
  <a name="kSendTsbId"></a><span class="e">kSendTsbId</span>
<span class="p">}</span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a> _cmTakeSeqBldrDC<span class="p">;</span>

<a name="cmDspTakeSeqBldr_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a>      <a name="cmDspTakeSeqBldr_t.inst"></a><span class="i">inst</span><span class="p">;</span>
  <a href="cmTakeSeqBldr_h_0.html#cmTakeSeqBldrH_t">cmTakeSeqBldrH_t</a> <a name="cmDspTakeSeqBldr_t.h"></a><span class="i">h</span><span class="p">;</span>
  <span class="k">bool</span>             <a name="cmDspTakeSeqBldr_t.errFl"></a><span class="i">errFl</span><span class="p">;</span>
<span class="p">}</span> <span class="t"><a href="#cmDspTakeSeqBldr_t">cmDspTakeSeqBldr_t</a></span><span class="p">;</span>


<a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span>  <a name="_cmDspTakeSeqBldrAlloc_defn"></a><a name="_cmDspTakeSeqBldrAlloc"></a><span class="f">_cmDspTakeSeqBldrAlloc</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> classPtr<span class="p">,</span> <span class="k">unsigned</span> storeSymId<span class="p">,</span> <span class="k">unsigned</span> instSymId<span class="p">,</span> <span class="k">unsigned</span> id<span class="p">,</span> <span class="k">unsigned</span> va_cnt<span class="p">,</span> va_list vl <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspTakeSeqBldr_t">cmDspTakeSeqBldr_t</a><span class="p">*</span> p <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstAllocV">cmDspInstAllocV</a><span class="p">(</span><a href="#cmDspTakeSeqBldr_t">cmDspTakeSeqBldr_t</a><span class="p">,</span>ctx<span class="p">,</span>classPtr<span class="p">,</span>instSymId<span class="p">,</span>id<span class="p">,</span>storeSymId<span class="p">,</span>va_cnt<span class="p">,</span>vl<span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>       <span class="l">&quotfn&quot</span><span class="p">,</span>      <a href="#kFnTsbId">kFnTsbId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kStrzDsvFl">kStrzDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kReqArgDsvFl">kReqArgDsvFl</a><span class="p">,</span> <span class="l">&quotScore Tracking file.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>      <span class="l">&quotbldr&quot</span><span class="p">,</span>   <a href="#kBldrTsbId">kBldrTsbId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kPtrDsvFl">kPtrDsvFl</a><span class="p">,</span> <span class="l">&quotBldr Ref&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>       <span class="l">&quotsel&quot</span><span class="p">,</span>   <a href="#kSelTsbId">kSelTsbId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>   <span class="l">&quotSelected score element location index.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>   <span class="l">&quotrefresh&quot</span><span class="p">,</span><a href="#kRefreshTsbId">kRefreshTsbId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>   <span class="l">&quotRefresh&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>      <span class="l">&quotsend&quot</span><span class="p">,</span>   <a href="#kSendTsbId">kSendTsbId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kTypeDsvMask">kTypeDsvMask</a><span class="p">,</span>  <span class="l">&quotResend last selected score element location.&quot</span><span class="p">,</span>
  <span class="l">0</span> <span class="p">)</span><span class="p">;</span>
  
  p<span class="p">-</span><span class="p">&gt</span>errFl      <span class="p">=</span> false<span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultInt">cmDspSetDefaultInt</a><span class="p">(</span>   ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kRefreshTsbId">kRefreshTsbId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> <a href="cmTakeSeqBldr_h_0.html#cmTakeSeqBldrAlloc">cmTakeSeqBldrAlloc</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span><a href="cmProcObj_h_0.html#cmCtx">cmCtx</a><span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>h <span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmTakeSeqBldr_h_0.html#kOkTsbRC">kOkTsbRC</a> <span class="p">)</span>
    <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">.</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span> <a href="cmDspClass_h_0.html#kSubSysFailDspRC">kSubSysFailDspRC</a><span class="p">,</span> <span class="l">&quotAllocate TaskSeqBldr object.&quot</span><span class="p">)</span><span class="p">;</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <a href="cmDspClass_h_0.html#cmDspUiTakeSeqBldrCreate">cmDspUiTakeSeqBldrCreate</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kFnTsbId">kFnTsbId</a><span class="p">,</span><a href="#kBldrTsbId">kBldrTsbId</a><span class="p">,</span><a href="#kSelTsbId">kSelTsbId</a><span class="p">,</span><a href="#kRefreshTsbId">kRefreshTsbId</a><span class="p">)</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="k">return</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspTakeSeqBldrSetup_defn"></a><a name="_cmDspTakeSeqBldrSetup"></a><span class="f">_cmDspTakeSeqBldrSetup</span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>           rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspTakeSeqBldr_t">cmDspTakeSeqBldr_t</a><span class="p">*</span> p  <span class="p">=</span> <span class="p">(</span><a href="#cmDspTakeSeqBldr_t">cmDspTakeSeqBldr_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> <a href="cmTakeSeqBldr_h_0.html#cmTakeSeqBldrInitialize">cmTakeSeqBldrInitialize</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>h<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspStrcz">cmDspStrcz</a><span class="p">(</span>inst<span class="p">,</span><a href="#kFnTsbId">kFnTsbId</a><span class="p">)</span> <span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmTakeSeqBldr_h_0.html#kOkTsbRC">kOkTsbRC</a> <span class="p">)</span>
  <span class="p">{</span>
    rc <span class="p">=</span> <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>inst<span class="p">-</span><span class="p">&gt</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span> <a href="cmDspClass_h_0.html#kSubSysFailDspRC">kSubSysFailDspRC</a><span class="p">,</span> <span class="l">&quotUnable to initialize the internal TakeSeqBldr object with %s.&quot</span><span class="p">,</span><a href="cmGlobal_h_0.html#cmStringNullGuard">cmStringNullGuard</a><span class="p">(</span><a href="cmDspClass_h_0.html#cmDspStrcz">cmDspStrcz</a><span class="p">(</span>inst<span class="p">,</span><a href="#kFnTsbId">kFnTsbId</a><span class="p">)</span><span class="p">)</span><span class="p">)</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <a href="cmDspClass_h_0.html#cmDspSetPtr">cmDspSetPtr</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kBldrTsbId">kBldrTsbId</a><span class="p">,</span>p<span class="p">-</span><span class="p">&gt</span>h<span class="p">.</span>h<span class="p">)</span><span class="p">;</span>
    p<span class="p">-</span><span class="p">&gt</span>errFl <span class="p">=</span> false<span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspTakeSeqBldrFree_defn"></a><a name="_cmDspTakeSeqBldrFree"></a><span class="f">_cmDspTakeSeqBldrFree</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>           rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspTakeSeqBldr_t">cmDspTakeSeqBldr_t</a><span class="p">*</span> p  <span class="p">=</span> <span class="p">(</span><a href="#cmDspTakeSeqBldr_t">cmDspTakeSeqBldr_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <a href="cmTakeSeqBldr_h_0.html#cmTakeSeqBldrFree">cmTakeSeqBldrFree</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>h<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspTakeSeqBldrReset_defn"></a><a name="_cmDspTakeSeqBldrReset"></a><span class="f">_cmDspTakeSeqBldrReset</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <span class="c">//<a href="#cmDspTakeSeqBldr_t">cmDspTakeSeqBldr_t</a>* p = (<a href="#cmDspTakeSeqBldr_t">cmDspTakeSeqBldr_t</a>*)inst;</span>
  
  <a href="cmDspClass_h_0.html#cmDspApplyAllDefaults">cmDspApplyAllDefaults</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <a href="#_cmDspTakeSeqBldrSetup">_cmDspTakeSeqBldrSetup</a><span class="p">(</span>ctx<span class="p">,</span> inst <span class="p">)</span><span class="p">;</span>
<span class="p">}</span> 

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspTakeSeqBldrExec_defn"></a><a name="_cmDspTakeSeqBldrExec"></a><span class="f">_cmDspTakeSeqBldrExec</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>            rc  <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspTakeSeqBldrRecv_defn"></a><a name="_cmDspTakeSeqBldrRecv"></a><span class="f">_cmDspTakeSeqBldrRecv</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  
  <span class="c">// not matter what arrives at the 'send' input ....</span>
  <span class="k">if</span><span class="p">(</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId <span class="p">=</span><span class="p">=</span> <a href="#kSendTsbId">kSendTsbId</a> <span class="p">)</span>
  <span class="p">{</span>
    <span class="c">// send the last score loc </span>
    <span class="k">unsigned</span> selIdx<span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="p">(</span>selIdx <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kSelTsbId">kSelTsbId</a><span class="p">)</span><span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmGlobal_h_0.html#cmInvalidIdx">cmInvalidIdx</a> <span class="p">)</span>
      <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kSelTsbId">kSelTsbId</a><span class="p">,</span> selIdx <span class="p">)</span><span class="p">;</span>
    
    <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <span class="p">}</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
  
  <span class="k">switch</span><span class="p">(</span>evt<span class="p">-</span><span class="p">&gt</span>dstVarId<span class="p">)</span>
  <span class="p">{</span>
  <span class="k">case</span> <a href="#kFnTsbId">kFnTsbId</a><span class="p">:</span>
    <a href="#_cmDspMidiFilePlayOpen">_cmDspMidiFilePlayOpen</a><span class="p">(</span>ctx<span class="p">,</span> inst <span class="p">)</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="p">}</span>
  <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> <a name="cmTakeSeqBldrClassCons_defn"></a><span class="f"><a href="cmDspKr_h_0.html#cmTakeSeqBldrClassCons">cmTakeSeqBldrClassCons</a></span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspClassSetup">cmDspClassSetup</a><span class="p">(</span><span class="p">&amp</span>_cmTakeSeqBldrDC<span class="p">,</span>ctx<span class="p">,</span><span class="l">&quotTakeSeqBldr&quot</span><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspTakeSeqBldrAlloc">_cmDspTakeSeqBldrAlloc</a><span class="p">,</span>
  <a href="#_cmDspTakeSeqBldrFree">_cmDspTakeSeqBldrFree</a><span class="p">,</span>
  <a href="#_cmDspTakeSeqBldrReset">_cmDspTakeSeqBldrReset</a><span class="p">,</span>
  <a href="#_cmDspTakeSeqBldrExec">_cmDspTakeSeqBldrExec</a><span class="p">,</span>
  <a href="#_cmDspTakeSeqBldrRecv">_cmDspTakeSeqBldrRecv</a><span class="p">,</span>
  NULL<span class="p">,</span>
  NULL<span class="p">,</span>
  <span class="l">&quotTakeSeqBldr&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>_cmTakeSeqBldrDC<span class="p">;</span>
<span class="p">}</span>




<span class="c"><hr id="hr1"></span></pre>
</div>
<div class="cod"><div class="blk_title">cmDspTakeSeqRend : User interface unit for graphically rendering the MIDI sequences created by cmDspTakeSeqBldr.</div><pre><a name="cmDspTakeSeqRend"></a><span class="k">enum</span>
<span class="p">{</span>
  <a name="kBldrTsrId"></a><span class="e">kBldrTsrId</span><span class="p">,</span>
  <a name="kRefreshTsrId"></a><span class="e">kRefreshTsrId</span><span class="p">,</span>
  <a name="kCmdTsrId"></a><span class="e">kCmdTsrId</span><span class="p">,</span>
  <a name="kSelTsrId"></a><span class="e">kSelTsrId</span><span class="p">,</span>
  <a name="kStatusTsrId"></a><span class="e">kStatusTsrId</span><span class="p">,</span>
  <a name="kD0TsrId"></a><span class="e">kD0TsrId</span><span class="p">,</span>
  <a name="kD1TsrId"></a><span class="e">kD1TsrId</span><span class="p">,</span>
  <a name="kSmpIdxTsrId"></a><span class="e">kSmpIdxTsrId</span>
<span class="p">}</span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a> _cmTakeSeqRendDC<span class="p">;</span>

<a name="cmDspTakeSeqRend_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a>      <a name="cmDspTakeSeqRend_t.inst"></a><span class="i">inst</span><span class="p">;</span>
  <a href="cmTakeSeqBldr_h_0.html#cmTakeSeqBldrH_t">cmTakeSeqBldrH_t</a> <a name="cmDspTakeSeqRend_t.h"></a><span class="i">h</span><span class="p">;</span>
  <span class="k">unsigned</span>         <a name="cmDspTakeSeqRend_t.startSymId"></a><span class="i">startSymId</span><span class="p">;</span>
  <span class="k">unsigned</span>         <a name="cmDspTakeSeqRend_t.stopSymId"></a><span class="i">stopSymId</span><span class="p">;</span>
  <span class="k">unsigned</span>         <a name="cmDspTakeSeqRend_t.contSymId"></a><span class="i">contSymId</span><span class="p">;</span>
  <span class="k">unsigned</span>         <a name="cmDspTakeSeqRend_t.onSymId"></a><span class="i">onSymId</span><span class="p">;</span>
  <span class="k">unsigned</span>         <a name="cmDspTakeSeqRend_t.offSymId"></a><span class="i">offSymId</span><span class="p">;</span>
  <span class="k">bool</span>             <a name="cmDspTakeSeqRend_t.errFl"></a><span class="i">errFl</span><span class="p">;</span>
<span class="p">}</span> <span class="t"><a href="#cmDspTakeSeqRend_t">cmDspTakeSeqRend_t</a></span><span class="p">;</span>


<a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span>  <a name="_cmDspTakeSeqRendAlloc_defn"></a><a name="_cmDspTakeSeqRendAlloc"></a><span class="f">_cmDspTakeSeqRendAlloc</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> classPtr<span class="p">,</span> <span class="k">unsigned</span> storeSymId<span class="p">,</span> <span class="k">unsigned</span> instSymId<span class="p">,</span> <span class="k">unsigned</span> id<span class="p">,</span> <span class="k">unsigned</span> va_cnt<span class="p">,</span> va_list vl <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspTakeSeqRend_t">cmDspTakeSeqRend_t</a><span class="p">*</span> p <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstAllocV">cmDspInstAllocV</a><span class="p">(</span><a href="#cmDspTakeSeqRend_t">cmDspTakeSeqRend_t</a><span class="p">,</span>ctx<span class="p">,</span>classPtr<span class="p">,</span>instSymId<span class="p">,</span>id<span class="p">,</span>storeSymId<span class="p">,</span>va_cnt<span class="p">,</span>vl<span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>      <span class="l">&quotbldr&quot</span><span class="p">,</span>   <a href="#kBldrTsrId">kBldrTsrId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kPtrDsvFl">kPtrDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span> <span class="l">&quotTake Sequene Builder Ref&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>   <span class="l">&quotrefresh&quot</span><span class="p">,</span><a href="#kRefreshTsrId">kRefreshTsrId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kOptArgDsvFl">kOptArgDsvFl</a><span class="p">,</span> <span class="l">&quotRefresh&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>       <span class="l">&quotcmd&quot</span><span class="p">,</span>    <a href="#kCmdTsrId">kCmdTsrId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kSymDsvFl">kSymDsvFl</a><span class="p">,</span>  <span class="l">&quotstart | stop | continue&quot</span> <span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>       <span class="l">&quotsel&quot</span><span class="p">,</span>    <a href="#kSelTsrId">kSelTsrId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span> <span class="l">&quotSelected score element location index input.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>    <span class="l">&quotstatus&quot</span><span class="p">,</span> <a href="#kStatusTsrId">kStatusTsrId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kIntDsvFl">kIntDsvFl</a><span class="p">,</span>  <span class="l">&quotStatus value output&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>       <span class="l">&quotd0&quot</span><span class="p">,</span>      <a href="#kD0TsrId">kD0TsrId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span> <span class="l">&quotData byte 0&quot</span> <span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>       <span class="l">&quotd1&quot</span><span class="p">,</span>      <a href="#kD1TsrId">kD1TsrId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span> <span class="l">&quotData byte 1&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>    <span class="l">&quotsmpidx&quot</span><span class="p">,</span> <a href="#kSmpIdxTsrId">kSmpIdxTsrId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a> <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span> <span class="l">&quotMsg time tag as a sample index.&quot</span><span class="p">,</span>
  <span class="l">0</span> <span class="p">)</span><span class="p">;</span>
  
  p<span class="p">-</span><span class="p">&gt</span>startSymId <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblRegisterStaticSymbol">cmSymTblRegisterStaticSymbol</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span><span class="l">&quotstart&quot</span><span class="p">)</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>stopSymId  <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblRegisterStaticSymbol">cmSymTblRegisterStaticSymbol</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span><span class="l">&quotstop&quot</span><span class="p">)</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>contSymId  <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblRegisterStaticSymbol">cmSymTblRegisterStaticSymbol</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span><span class="l">&quotcontinue&quot</span><span class="p">)</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>onSymId    <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblRegisterStaticSymbol">cmSymTblRegisterStaticSymbol</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span><span class="l">&quoton&quot</span><span class="p">)</span><span class="p">;</span>
  p<span class="p">-</span><span class="p">&gt</span>offSymId   <span class="p">=</span> <a href="cmSymTbl_h_0.html#cmSymTblRegisterStaticSymbol">cmSymTblRegisterStaticSymbol</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>stH<span class="p">,</span><span class="l">&quotoff&quot</span><span class="p">)</span><span class="p">;</span>
  
  p<span class="p">-</span><span class="p">&gt</span>errFl      <span class="p">=</span> false<span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultInt">cmDspSetDefaultInt</a><span class="p">(</span>   ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kRefreshTsrId">kRefreshTsrId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultSymbol">cmDspSetDefaultSymbol</a><span class="p">(</span>ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kCmdTsrId">kCmdTsrId</a><span class="p">,</span>    p<span class="p">-</span><span class="p">&gt</span>stopSymId<span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultInt">cmDspSetDefaultInt</a><span class="p">(</span>   ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kSmpIdxTsrId">kSmpIdxTsrId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>  ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kStatusTsrId">kStatusTsrId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>  ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kD0TsrId">kD0TsrId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>  ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span>  <a href="#kD1TsrId">kD1TsrId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">)</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspUiTakeSeqRendCreate">cmDspUiTakeSeqRendCreate</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="#kBldrTsrId">kBldrTsrId</a><span class="p">,</span><a href="#kRefreshTsrId">kRefreshTsrId</a><span class="p">,</span><a href="#kSelTsrId">kSelTsrId</a><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspTakeSeqRendFree_defn"></a><a name="_cmDspTakeSeqRendFree"></a><span class="f">_cmDspTakeSeqRendFree</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>           rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspTakeSeqRendReset_defn"></a><a name="_cmDspTakeSeqRendReset"></a><span class="f">_cmDspTakeSeqRendReset</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <span class="c">//<a href="#cmDspTakeSeqRend_t">cmDspTakeSeqRend_t</a>* p = (<a href="#cmDspTakeSeqRend_t">cmDspTakeSeqRend_t</a>*)inst;</span>
  
  <a href="cmDspClass_h_0.html#cmDspApplyAllDefaults">cmDspApplyAllDefaults</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">;</span>
  <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
<span class="p">}</span> 

<a name="_cmDspTakeSeqRendCbArg_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span>  <a name="_cmDspTakeSeqRendCbArg_t.ctx"></a><span class="i">ctx</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> <a name="_cmDspTakeSeqRendCbArg_t.inst"></a><span class="i">inst</span><span class="p">;</span>
<span class="p">}</span> <span class="t"><a href="#_cmDspTakeSeqRendCbArg_t">_cmDspTakeSeqRendCbArg_t</a></span><span class="p">;</span>

<span class="c">// Called from cmDspTakeSeqRendExec() -&ampgt cmTakeSeqRendPlayExec() to
// deliver MIDI messages which need to be transmitted.</span>
<span class="k">void</span> <a name="_cmDspTakeSeqRendMidiCb_defn"></a><a name="_cmDspTakeSeqRendMidiCb"></a><span class="f">_cmDspTakeSeqRendMidiCb</span><span class="p">(</span> <span class="k">void</span><span class="p">*</span> arg<span class="p">,</span> <span class="k">const</span> <a href="cmTakeSeqBldr_h_0.html#cmTksbEvent_t">cmTksbEvent_t</a><span class="p">*</span> e <span class="p">)</span>
<span class="p">{</span>
  <a href="#_cmDspTakeSeqRendCbArg_t">_cmDspTakeSeqRendCbArg_t</a><span class="p">*</span> a <span class="p">=</span> <span class="p">(</span><a href="#_cmDspTakeSeqRendCbArg_t">_cmDspTakeSeqRendCbArg_t</a><span class="p">*</span><span class="p">)</span>arg<span class="p">;</span>
  
  <span class="k">switch</span><span class="p">(</span> e<span class="p">-</span><span class="p">&gt</span>status <span class="p">)</span>
  <span class="p">{</span>
  <span class="k">case</span> <a href="cmMidi_h_0.html#kNoteOffMdId">kNoteOffMdId</a><span class="p">:</span>
  <span class="k">case</span> <a href="cmMidi_h_0.html#kNoteOnMdId">kNoteOnMdId</a><span class="p">:</span>
  <span class="k">case</span> <a href="cmMidi_h_0.html#kCtlMdId">kCtlMdId</a><span class="p">:</span>
    <span class="c">//if( !<a href="cmMidi_h_0.html#cmMidiIsPedal">cmMidiIsPedal</a>(e-&ampgtstatus,e-&ampgtd0))</span>
    <span class="p">{</span>
      <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>a<span class="p">-</span><span class="p">&gt</span>ctx<span class="p">,</span>a<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kSmpIdxTsrId">kSmpIdxTsrId</a><span class="p">,</span> e<span class="p">-</span><span class="p">&gt</span>smpIdx<span class="p">)</span><span class="p">;</span>
      <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>a<span class="p">-</span><span class="p">&gt</span>ctx<span class="p">,</span>a<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kD1TsrId">kD1TsrId</a><span class="p">,</span>     e<span class="p">-</span><span class="p">&gt</span>d1<span class="p">)</span><span class="p">;</span>
      <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>a<span class="p">-</span><span class="p">&gt</span>ctx<span class="p">,</span>a<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kD0TsrId">kD0TsrId</a><span class="p">,</span>     e<span class="p">-</span><span class="p">&gt</span>d0<span class="p">)</span><span class="p">;</span>
      <a href="cmDspClass_h_0.html#cmDspSetUInt">cmDspSetUInt</a><span class="p">(</span>a<span class="p">-</span><span class="p">&gt</span>ctx<span class="p">,</span>a<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kStatusTsrId">kStatusTsrId</a><span class="p">,</span> e<span class="p">-</span><span class="p">&gt</span>status<span class="p">)</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="p">}</span>
  
<span class="p">}</span>

<span class="k">void</span> <a name="_cmDspTakeSeqRendPedalsUp_defn"></a><a name="_cmDspTakeSeqRendPedalsUp"></a><span class="f">_cmDspTakeSeqRendPedalsUp</span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst <span class="p">)</span>
<span class="p">{</span>
  <a href="#_cmDspTakeSeqRendCbArg_t">_cmDspTakeSeqRendCbArg_t</a> a<span class="p">;</span>
  a<span class="p">.</span>ctx <span class="p">=</span> ctx<span class="p">;</span>
  a<span class="p">.</span>inst <span class="p">=</span> inst<span class="p">;</span>
  
  <a href="cmTakeSeqBldr_h_0.html#cmTksbEvent_t">cmTksbEvent_t</a> e<span class="p">[</span><span class="p">]</span> <span class="p">=</span>
  <span class="p">{</span>
    <span class="p">{</span> <span class="l">0</span><span class="p">,</span> <a href="cmMidi_h_0.html#kCtlMdId">kCtlMdId</a><span class="p">,</span> <a href="cmMidi_h_0.html#kSustainCtlMdId">kSustainCtlMdId</a><span class="p">,</span>   <span class="l">0</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">0</span><span class="p">,</span> <a href="cmMidi_h_0.html#kCtlMdId">kCtlMdId</a><span class="p">,</span> <a href="cmMidi_h_0.html#kPortamentoCtlMdId">kPortamentoCtlMdId</a><span class="p">,</span><span class="l">0</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">0</span><span class="p">,</span> <a href="cmMidi_h_0.html#kCtlMdId">kCtlMdId</a><span class="p">,</span> <a href="cmMidi_h_0.html#kSostenutoCtlMdId">kSostenutoCtlMdId</a><span class="p">,</span> <span class="l">0</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">0</span><span class="p">,</span> <a href="cmMidi_h_0.html#kCtlMdId">kCtlMdId</a><span class="p">,</span> <a href="cmMidi_h_0.html#kSoftPedalCtlMdId">kSoftPedalCtlMdId</a><span class="p">,</span> <span class="l">0</span> <span class="p">}</span><span class="p">,</span>
    <span class="p">{</span> <span class="l">0</span><span class="p">,</span> <a href="cmMidi_h_0.html#kCtlMdId">kCtlMdId</a><span class="p">,</span> <a href="cmMidi_h_0.html#kLegatoCtlMdId">kLegatoCtlMdId</a><span class="p">,</span>    <span class="l">0</span> <span class="p">}</span>
  <span class="p">}</span><span class="p">;</span>
  
  <span class="k">unsigned</span> n <span class="p">=</span> <span class="k">sizeof</span><span class="p">(</span>e<span class="p">)</span><span class="p">/</span><span class="k">sizeof</span><span class="p">(</span>e<span class="p">[</span><span class="l">0</span><span class="p">]</span><span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span> i<span class="p">;</span>
  <span class="k">for</span><span class="p">(</span>i<span class="p">=</span><span class="l">0</span><span class="p">;</span> i<span class="p">&lt</span>n<span class="p">;</span> <span class="p">+</span><span class="p">+</span>i<span class="p">)</span>
    <a href="#_cmDspTakeSeqRendMidiCb">_cmDspTakeSeqRendMidiCb</a><span class="p">(</span><span class="p">&amp</span>a<span class="p">,</span>e<span class="p">+</span>i<span class="p">)</span><span class="p">;</span>
<span class="p">}</span>


<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspTakeSeqRendExec_defn"></a><a name="_cmDspTakeSeqRendExec"></a><span class="f">_cmDspTakeSeqRendExec</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>            rc  <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspTakeSeqRend_t">cmDspTakeSeqRend_t</a><span class="p">*</span>  p   <span class="p">=</span> <span class="p">(</span><a href="#cmDspTakeSeqRend_t">cmDspTakeSeqRend_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> <a href="cmDspClass_h_0.html#cmDspSymbol">cmDspSymbol</a><span class="p">(</span>inst<span class="p">,</span><a href="#kCmdTsrId">kCmdTsrId</a><span class="p">)</span> <span class="p">!</span><span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>stopSymId <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span> <a href="cmTakeSeqBldr_h_0.html#cmTakeSeqBldrIsValid">cmTakeSeqBldrIsValid</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>h<span class="p">)</span> <span class="p">=</span><span class="p">=</span> false <span class="p">)</span>
    <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>errFl<span class="p">=</span><span class="p">=</span>false <span class="p">)</span>
      <span class="p">{</span>
        rc <span class="p">=</span> <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>inst<span class="p">-</span><span class="p">&gt</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span> <a href="cmDspClass_h_0.html#kInvalidStateDspRC">kInvalidStateDspRC</a><span class="p">,</span><span class="l">&quotThe Take Sequence Builder not been given a valid file.&quot</span><span class="p">)</span><span class="p">;</span>
        p<span class="p">-</span><span class="p">&gt</span>errFl <span class="p">=</span> true<span class="p">;</span>
      <span class="p">}</span>
      <span class="k">return</span> rc<span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">unsigned</span>                 sPc <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspSamplesPerCycle">cmDspSamplesPerCycle</a><span class="p">(</span>ctx<span class="p">)</span><span class="p">;</span>
    <a href="#_cmDspTakeSeqRendCbArg_t">_cmDspTakeSeqRendCbArg_t</a> arg<span class="p">;</span>
    arg<span class="p">.</span>inst <span class="p">=</span> inst<span class="p">;</span>
    arg<span class="p">.</span>ctx  <span class="p">=</span> ctx<span class="p">;</span>
    
    <span class="c">// This call may result in multiple callbacks  
    // to <a href="#_cmDspTakeSeqRendMidiCb">_cmDspTakeSeqRendMidiCb</a>() from within the function.</span>    
    <a href="cmTakeSeqBldr_h_0.html#cmTakeSeqBldrPlayExec">cmTakeSeqBldrPlayExec</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>h<span class="p">,</span>sPc<span class="p">,</span><a href="#_cmDspTakeSeqRendMidiCb">_cmDspTakeSeqRendMidiCb</a><span class="p">,</span> <span class="p">&amp</span>arg <span class="p">)</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>


<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspTakeSeqRendRecv_defn"></a><a name="_cmDspTakeSeqRendRecv"></a><span class="f">_cmDspTakeSeqRendRecv</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspTakeSeqRend_t">cmDspTakeSeqRend_t</a><span class="p">*</span> p <span class="p">=</span> <span class="p">(</span><a href="#cmDspTakeSeqRend_t">cmDspTakeSeqRend_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  printf<span class="p">(</span><span class="l">&quotRecv:%s\n&quot</span><span class="p">,</span><a href="cmGlobal_h_0.html#cmStringNullGuard">cmStringNullGuard</a><span class="p">(</span><a href="cmDspClass_h_0.html#cmDspVarLabel">cmDspVarLabel</a><span class="p">(</span>ctx<span class="p">,</span> inst<span class="p">,</span> evt<span class="p">-</span><span class="p">&gt</span>dstVarId<span class="p">)</span><span class="p">)</span> <span class="p">)</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
  
  <span class="k">switch</span><span class="p">(</span>evt<span class="p">-</span><span class="p">&gt</span>dstVarId<span class="p">)</span>
  <span class="p">{</span>
  <span class="k">case</span> <a href="#kBldrTsrId">kBldrTsrId</a><span class="p">:</span>
    p<span class="p">-</span><span class="p">&gt</span>h<span class="p">.</span>h <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspPtr">cmDspPtr</a><span class="p">(</span>inst<span class="p">,</span><a href="#kBldrTsrId">kBldrTsrId</a><span class="p">)</span><span class="p">;</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kCmdTsrId">kCmdTsrId</a><span class="p">:</span>
    <span class="p">{</span>
      <span class="k">unsigned</span> symId <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspSymbol">cmDspSymbol</a><span class="p">(</span>inst<span class="p">,</span><a href="#kCmdTsrId">kCmdTsrId</a><span class="p">)</span><span class="p">;</span>
      
      <span class="k">if</span><span class="p">(</span> symId <span class="p">=</span><span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>onSymId <span class="p">)</span>
        <a href="cmDspClass_h_0.html#cmDspSetSymbol">cmDspSetSymbol</a><span class="p">(</span> ctx<span class="p">,</span> inst<span class="p">,</span> <a href="#kCmdTsrId">kCmdTsrId</a><span class="p">,</span> p<span class="p">-</span><span class="p">&gt</span>startSymId <span class="p">)</span><span class="p">;</span>
      <span class="k">else</span>
        <span class="k">if</span><span class="p">(</span> symId <span class="p">=</span><span class="p">=</span> p<span class="p">-</span><span class="p">&gt</span>offSymId <span class="p">)</span>
          <a href="cmDspClass_h_0.html#cmDspSetSymbol">cmDspSetSymbol</a><span class="p">(</span> ctx<span class="p">,</span> inst<span class="p">,</span> <a href="#kCmdTsrId">kCmdTsrId</a><span class="p">,</span> p<span class="p">-</span><span class="p">&gt</span>stopSymId <span class="p">)</span><span class="p">;</span>
      
      <span class="k">if</span><span class="p">(</span> <a href="cmTakeSeqBldr_h_0.html#cmTakeSeqBldrIsValid">cmTakeSeqBldrIsValid</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>h<span class="p">)</span> <span class="p">&amp</span><span class="p">&amp</span> <a href="cmDspClass_h_0.html#cmDspSymbol">cmDspSymbol</a><span class="p">(</span>inst<span class="p">,</span><a href="#kCmdTsrId">kCmdTsrId</a><span class="p">)</span><span class="p">=</span><span class="p">=</span>p<span class="p">-</span><span class="p">&gt</span>startSymId <span class="p">)</span> 
      <span class="p">{</span>
        <a href="#_cmDspTakeSeqRendPedalsUp">_cmDspTakeSeqRendPedalsUp</a><span class="p">(</span> ctx<span class="p">,</span> inst <span class="p">)</span><span class="p">;</span>
        <a href="cmTakeSeqBldr_h_0.html#cmTakeSeqBldrPlaySeekLoc">cmTakeSeqBldrPlaySeekLoc</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>h<span class="p">,</span> <a href="cmGlobal_h_0.html#cmInvalidId">cmInvalidId</a> <span class="p">)</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="k">case</span> <a href="#kSelTsrId">kSelTsrId</a><span class="p">:</span>
    <span class="p">{</span>
      <span class="c">// seek the playback position to the scLocIdx.</span>
      <span class="k">unsigned</span> scLocIdx <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kSelTsrId">kSelTsrId</a><span class="p">)</span><span class="p">;</span>        
      <span class="k">if</span><span class="p">(</span> <a href="cmTakeSeqBldr_h_0.html#cmTakeSeqBldrIsValid">cmTakeSeqBldrIsValid</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>h<span class="p">)</span>  <span class="p">&amp</span><span class="p">&amp</span> <a href="cmTakeSeqBldr_h_0.html#cmTakeSeqBldrPlaySeekLoc">cmTakeSeqBldrPlaySeekLoc</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>h<span class="p">,</span> scLocIdx <span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmTakeSeqBldr_h_0.html#kOkTsbRC">kOkTsbRC</a> <span class="p">)</span>
        <span class="k">return</span> <a href="cmDspClass_h_0.html#cmDspInstErr">cmDspInstErr</a><span class="p">(</span>ctx<span class="p">,</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span><a href="cmDspClass_h_0.html#kSubSysFailDspRC">kSubSysFailDspRC</a><span class="p">,</span><span class="l">&quotTake Sequence Bldr Seek failed on score location index %i.&quot</span><span class="p">,</span> scLocIdx<span class="p">)</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">break</span><span class="p">;</span>
    
  <span class="p">}</span>
  <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> <a name="cmTakeSeqRendClassCons_defn"></a><span class="f"><a href="cmDspKr_h_0.html#cmTakeSeqRendClassCons">cmTakeSeqRendClassCons</a></span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspClassSetup">cmDspClassSetup</a><span class="p">(</span><span class="p">&amp</span>_cmTakeSeqRendDC<span class="p">,</span>ctx<span class="p">,</span><span class="l">&quotTakeSeqRend&quot</span><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspTakeSeqRendAlloc">_cmDspTakeSeqRendAlloc</a><span class="p">,</span>
  <a href="#_cmDspTakeSeqRendFree">_cmDspTakeSeqRendFree</a><span class="p">,</span>
  <a href="#_cmDspTakeSeqRendReset">_cmDspTakeSeqRendReset</a><span class="p">,</span>
  <a href="#_cmDspTakeSeqRendExec">_cmDspTakeSeqRendExec</a><span class="p">,</span>
  <a href="#_cmDspTakeSeqRendRecv">_cmDspTakeSeqRendRecv</a><span class="p">,</span>
  NULL<span class="p">,</span>
  NULL<span class="p">,</span>
  <span class="l">&quotTakeSeqRend&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>_cmTakeSeqRendDC<span class="p">;</span>
<span class="p">}</span>


<span class="c"><hr id="hr1"></span></pre>
</div>
<div class="cod"><div class="blk_title">cmDspReflectCalc : Estimate the time-of-flight of from an acoustic signal from a speaker to a microphone.</div><pre><a name="cmDspReflectCalc"></a><span class="k">enum</span>
<span class="p">{</span>
  <a name="kLfsrN_RcId"></a><span class="e">kLfsrN_RcId</span><span class="p">,</span>
  <a name="kMlsCoeff0RcId"></a><span class="e">kMlsCoeff0RcId</span><span class="p">,</span>
  <a name="kMlsCoeff1RcId"></a><span class="e">kMlsCoeff1RcId</span><span class="p">,</span>
  <a name="kSmpPerChipRcId"></a><span class="e">kSmpPerChipRcId</span><span class="p">,</span>
  <a name="kRcosBetaRcId"></a><span class="e">kRcosBetaRcId</span><span class="p">,</span>
  <a name="kRcosOS_RcId"></a><span class="e">kRcosOS_RcId</span><span class="p">,</span>
  <a name="kCarrierHzRcId"></a><span class="e">kCarrierHzRcId</span><span class="p">,</span>
  <a name="kAtkDcyMsRcId"></a><span class="e">kAtkDcyMsRcId</span><span class="p">,</span>
  <a name="kPhatAlphaRcId"></a><span class="e">kPhatAlphaRcId</span><span class="p">,</span>
  <a name="kPhatMultRcId"></a><span class="e">kPhatMultRcId</span><span class="p">,</span>
  <a name="kInRcId"></a><span class="e">kInRcId</span><span class="p">,</span>
  <a name="kOutRcId"></a><span class="e">kOutRcId</span><span class="p">,</span>
<span class="p">}</span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a> _cmReflectCalcDC<span class="p">;</span>

<a name="cmDspReflectCalc_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a>    <a name="cmDspReflectCalc_t.inst"></a><span class="i">inst</span><span class="p">;</span>
  <a href="cmProc5_h_0.html#cmReflectCalc_t">cmReflectCalc_t</a><span class="p">*</span> <a name="cmDspReflectCalc_t.r"></a><span class="i">r</span><span class="p">;</span>
<span class="p">}</span> <span class="t"><a href="#cmDspReflectCalc_t">cmDspReflectCalc_t</a></span><span class="p">;</span>


<a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span>  <a name="_cmDspReflectCalcAlloc_defn"></a><a name="_cmDspReflectCalcAlloc"></a><span class="f">_cmDspReflectCalcAlloc</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> classPtr<span class="p">,</span> <span class="k">unsigned</span> storeSymId<span class="p">,</span> <span class="k">unsigned</span> instSymId<span class="p">,</span> <span class="k">unsigned</span> id<span class="p">,</span> <span class="k">unsigned</span> va_cnt<span class="p">,</span> va_list vl <span class="p">)</span>
<span class="p">{</span>
  
  <span class="c">//  if( va_cnt !=3 )
  //  {
  //    <a href="cmDspClass_h_0.html#cmDspClassErr">cmDspClassErr</a>(ctx,classPtr,<a href="cmDspClass_h_0.html#kVarArgParseFailDspRC">kVarArgParseFailDspRC</a>,&ampquotThe 'ReflectCalc' constructor must have two arguments: a channel count and frequency array.&ampquot);
  //    return NULL;
  //  }</span>  
  
  <a href="#cmDspReflectCalc_t">cmDspReflectCalc_t</a><span class="p">*</span> p <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstAllocV">cmDspInstAllocV</a><span class="p">(</span><a href="#cmDspReflectCalc_t">cmDspReflectCalc_t</a><span class="p">,</span>ctx<span class="p">,</span>classPtr<span class="p">,</span>instSymId<span class="p">,</span>id<span class="p">,</span>storeSymId<span class="p">,</span>va_cnt<span class="p">,</span>vl<span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotlfsrN&quot</span><span class="p">,</span> <a href="#kLfsrN_RcId">kLfsrN_RcId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>    <span class="l">&quotGold code generator LFSR length&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotmlsc0&quot</span><span class="p">,</span> <a href="#kMlsCoeff0RcId">kMlsCoeff0RcId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>    <span class="l">&quotLFSR coefficient 0&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotmlsc1&quot</span><span class="p">,</span> <a href="#kMlsCoeff1RcId">kMlsCoeff1RcId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>    <span class="l">&quotLFSR coefficient 0&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotspchip&quot</span><span class="p">,</span><a href="#kSmpPerChipRcId">kSmpPerChipRcId</a><span class="p">,</span><span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>    <span class="l">&quotSamples per spreading code bit.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotrcosb&quot</span><span class="p">,</span> <a href="#kRcosBetaRcId">kRcosBetaRcId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a><span class="p">,</span>  <span class="l">&quotRaised cosine beta&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotrcosos&quot</span><span class="p">,</span><a href="#kRcosOS_RcId">kRcosOS_RcId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>    <span class="l">&quotRaised cosine oversample factor.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotcarhz&quot</span><span class="p">,</span> <a href="#kCarrierHzRcId">kCarrierHzRcId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a><span class="p">,</span>  <span class="l">&quotCarrier frequency in Hertz.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotenvms&quot</span><span class="p">,</span> <a href="#kAtkDcyMsRcId">kAtkDcyMsRcId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a><span class="p">,</span>  <span class="l">&quotSignal Attack/Decay milliseconds.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotalpha&quot</span><span class="p">,</span> <a href="#kPhatAlphaRcId">kPhatAlphaRcId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a><span class="p">,</span>  <span class="l">&quotPHAT alpha coefficient.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>         <span class="l">&quotmult&quot</span><span class="p">,</span>  <a href="#kPhatMultRcId">kPhatMultRcId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>    <span class="l">&quotPHAT multiplier coefficient.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>          <span class="l">&quotin&quot</span><span class="p">,</span>   <a href="#kInRcId">kInRcId</a><span class="p">,</span>        <span class="l">0</span><span class="p">,</span><span class="l">1</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kAudioBufDsvFl">kAudioBufDsvFl</a><span class="p">,</span><span class="l">&quotAudio input&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>          <span class="l">&quotout&quot</span><span class="p">,</span>  <a href="#kOutRcId">kOutRcId</a><span class="p">,</span>       <span class="l">0</span><span class="p">,</span><span class="l">1</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kAudioBufDsvFl">kAudioBufDsvFl</a><span class="p">,</span><span class="l">&quotAudio output&quot</span><span class="p">,</span>
  <span class="l">0</span> <span class="p">)</span><span class="p">;</span>
  
  
  p<span class="p">-</span><span class="p">&gt</span>r <span class="p">=</span> <a href="cmProc5_h_0.html#cmReflectCalcAlloc">cmReflectCalcAlloc</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>cmProcCtx<span class="p">,</span> NULL<span class="p">,</span> NULL<span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span> <span class="p">)</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>   ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kLfsrN_RcId">kLfsrN_RcId</a><span class="p">,</span>     <span class="l">0</span><span class="p">,</span>  <span class="l">8</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>   ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kMlsCoeff0RcId">kMlsCoeff0RcId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span> <span class="l">0x8e</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>   ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kMlsCoeff1RcId">kMlsCoeff1RcId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span> <span class="l">0x96</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>   ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kSmpPerChipRcId">kSmpPerChipRcId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">64</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span> ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kRcosBetaRcId">kRcosBetaRcId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span> <span class="l">0.5</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>   ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kRcosOS_RcId">kRcosOS_RcId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span> <span class="l">4</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span> ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kCarrierHzRcId">kCarrierHzRcId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span> <span class="l">2500.0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span> ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kAtkDcyMsRcId">kAtkDcyMsRcId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span> <span class="l">50.0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span> ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kPhatAlphaRcId">kPhatAlphaRcId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span> <span class="l">0.5</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>   ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kPhatMultRcId">kPhatMultRcId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span> <span class="l">1</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspReflectCalcSetup_defn"></a><a name="_cmDspReflectCalcSetup"></a><span class="f">_cmDspReflectCalcSetup</span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>   rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspReflectCalc_t">cmDspReflectCalc_t</a><span class="p">*</span> p  <span class="p">=</span> <span class="p">(</span><a href="#cmDspReflectCalc_t">cmDspReflectCalc_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  <a href="cmProc5_h_0.html#cmGoldSigArg_t">cmGoldSigArg_t</a> gsa<span class="p">;</span>
  
  gsa<span class="p">.</span>chN            <span class="p">=</span> <span class="l">1</span><span class="p">;</span>
  gsa<span class="p">.</span>srate          <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspSampleRate">cmDspSampleRate</a><span class="p">(</span>ctx<span class="p">)</span><span class="p">;</span>
  gsa<span class="p">.</span>lfsrN          <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kLfsrN_RcId">kLfsrN_RcId</a><span class="p">)</span><span class="p">;</span>
  gsa<span class="p">.</span>mlsCoeff0      <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kMlsCoeff0RcId">kMlsCoeff0RcId</a><span class="p">)</span><span class="p">;</span>
  gsa<span class="p">.</span>mlsCoeff1      <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kMlsCoeff1RcId">kMlsCoeff1RcId</a><span class="p">)</span><span class="p">;</span>
  gsa<span class="p">.</span>samplesPerChip <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kSmpPerChipRcId">kSmpPerChipRcId</a><span class="p">)</span><span class="p">;</span>
  gsa<span class="p">.</span>rcosBeta       <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kRcosBetaRcId">kRcosBetaRcId</a><span class="p">)</span><span class="p">;</span>
  gsa<span class="p">.</span>rcosOSFact     <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kRcosOS_RcId">kRcosOS_RcId</a><span class="p">)</span><span class="p">;</span>
  gsa<span class="p">.</span>carrierHz      <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kCarrierHzRcId">kCarrierHzRcId</a><span class="p">)</span><span class="p">;</span>
  gsa<span class="p">.</span>envMs          <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kAtkDcyMsRcId">kAtkDcyMsRcId</a><span class="p">)</span><span class="p">;</span>
  
  <span class="k">double</span>   phatAlpha <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kPhatAlphaRcId">kPhatAlphaRcId</a><span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span> phatMult  <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kPhatMultRcId">kPhatMultRcId</a><span class="p">)</span><span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> <a href="cmProc5_h_0.html#cmReflectCalcInit">cmReflectCalcInit</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>r<span class="p">,</span><span class="p">&amp</span>gsa<span class="p">,</span>phatAlpha<span class="p">,</span>phatMult<span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmGlobal_h_0.html#cmOkRC">cmOkRC</a> <span class="p">)</span>
    rc <span class="p">=</span> <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>inst<span class="p">-</span><span class="p">&gt</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span> <a href="cmDspClass_h_0.html#kSubSysFailDspRC">kSubSysFailDspRC</a><span class="p">,</span> <span class="l">&quotUnable to initialize the internal ReflectCalc detector.&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspReflectCalcFree_defn"></a><a name="_cmDspReflectCalcFree"></a><span class="f">_cmDspReflectCalcFree</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>           rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspReflectCalc_t">cmDspReflectCalc_t</a><span class="p">*</span> p  <span class="p">=</span> <span class="p">(</span><a href="#cmDspReflectCalc_t">cmDspReflectCalc_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <a href="cmProc5_h_0.html#cmReflectCalcFree">cmReflectCalcFree</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>r<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspReflectCalcReset_defn"></a><a name="_cmDspReflectCalcReset"></a><span class="f">_cmDspReflectCalcReset</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <span class="c">//<a href="#cmDspReflectCalc_t">cmDspReflectCalc_t</a>* p = (<a href="#cmDspReflectCalc_t">cmDspReflectCalc_t</a>*)inst;</span>
  
  <a href="cmDspClass_h_0.html#cmDspApplyAllDefaults">cmDspApplyAllDefaults</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <a href="#_cmDspReflectCalcSetup">_cmDspReflectCalcSetup</a><span class="p">(</span>ctx<span class="p">,</span> inst <span class="p">)</span><span class="p">;</span>
<span class="p">}</span> 

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspReflectCalcExec_defn"></a><a name="_cmDspReflectCalcExec"></a><span class="f">_cmDspReflectCalcExec</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>           rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspReflectCalc_t">cmDspReflectCalc_t</a><span class="p">*</span> p  <span class="p">=</span> <span class="p">(</span><a href="#cmDspReflectCalc_t">cmDspReflectCalc_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  <span class="k">const</span> <a href="cmFloatTypes_h_0.html#cmSample_t">cmSample_t</a><span class="p">*</span>   xV <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBuf">cmDspAudioBuf</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kInRcId">kInRcId</a><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>            xN <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBufSmpCount">cmDspAudioBufSmpCount</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kInRcId">kInRcId</a><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <a href="cmFloatTypes_h_0.html#cmSample_t">cmSample_t</a><span class="p">*</span>         yV <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBuf">cmDspAudioBuf</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kOutRcId">kOutRcId</a><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>            yN <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBufSmpCount">cmDspAudioBufSmpCount</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kOutRcId">kOutRcId</a><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> xV <span class="p">!</span><span class="p">=</span> NULL <span class="p">&amp</span><span class="p">&amp</span> yV <span class="p">!</span><span class="p">=</span> NULL <span class="p">)</span>
  <span class="p">{</span>
    assert<span class="p">(</span> xN <span class="p">=</span><span class="p">=</span> yN <span class="p">)</span><span class="p">;</span>
    <a href="cmProc5_h_0.html#cmReflectCalcExec">cmReflectCalcExec</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>r<span class="p">,</span>xV<span class="p">,</span>yV<span class="p">,</span>xN<span class="p">)</span><span class="p">;</span>
  <span class="p">}</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspReflectCalcRecv_defn"></a><a name="_cmDspReflectCalcRecv"></a><span class="f">_cmDspReflectCalcRecv</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <span class="c">//<a href="#cmDspReflectCalc_t">cmDspReflectCalc_t</a>*  p         = (<a href="#cmDspReflectCalc_t">cmDspReflectCalc_t</a>*)inst;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> <a name="cmReflectCalcClassCons_defn"></a><span class="f"><a href="cmDspKr_h_0.html#cmReflectCalcClassCons">cmReflectCalcClassCons</a></span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspClassSetup">cmDspClassSetup</a><span class="p">(</span><span class="p">&amp</span>_cmReflectCalcDC<span class="p">,</span>ctx<span class="p">,</span><span class="l">&quotReflectCalc&quot</span><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspReflectCalcAlloc">_cmDspReflectCalcAlloc</a><span class="p">,</span>
  <a href="#_cmDspReflectCalcFree">_cmDspReflectCalcFree</a><span class="p">,</span>
  <a href="#_cmDspReflectCalcReset">_cmDspReflectCalcReset</a><span class="p">,</span>
  <a href="#_cmDspReflectCalcExec">_cmDspReflectCalcExec</a><span class="p">,</span>
  <a href="#_cmDspReflectCalcRecv">_cmDspReflectCalcRecv</a><span class="p">,</span>
  NULL<span class="p">,</span>
  NULL<span class="p">,</span>
  <span class="l">&quotReflecttion time calculator&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>_cmReflectCalcDC<span class="p">;</span>
<span class="p">}</span>


<span class="c"><hr id="hr1"></span></pre>
</div>
<div class="cod"><div class="blk_title">cmDspEchoCancel : Normalized least mean squares echo canceller.</div><pre><a name="cmDspEchoCancel"></a><span class="k">enum</span>
<span class="p">{</span>
  <a name="kMuEcId"></a><span class="e">kMuEcId</span><span class="p">,</span>
  <a name="kImpRespN_EcId"></a><span class="e">kImpRespN_EcId</span><span class="p">,</span>
  <a name="kDelayN_EcId"></a><span class="e">kDelayN_EcId</span><span class="p">,</span>
  <a name="kBypassEcId"></a><span class="e">kBypassEcId</span><span class="p">,</span>
  <a name="kUnfiltInEcId"></a><span class="e">kUnfiltInEcId</span><span class="p">,</span>
  <a name="kFiltInEcId"></a><span class="e">kFiltInEcId</span><span class="p">,</span>
  <a name="kOutEcId"></a><span class="e">kOutEcId</span>
<span class="p">}</span><span class="p">;</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a> _cmEchoCancelDC<span class="p">;</span>

<a name="cmDspEchoCancel_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a>    <a name="cmDspEchoCancel_t.inst"></a><span class="i">inst</span><span class="p">;</span>
  <a href="cmProc5_h_0.html#cmNlmsEc_t">cmNlmsEc_t</a><span class="p">*</span>    <a name="cmDspEchoCancel_t.r"></a><span class="i">r</span><span class="p">;</span>
<span class="p">}</span> <span class="t"><a href="#cmDspEchoCancel_t">cmDspEchoCancel_t</a></span><span class="p">;</span>


<a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span>  <a name="_cmDspEchoCancelAlloc_defn"></a><a name="_cmDspEchoCancelAlloc"></a><span class="f">_cmDspEchoCancelAlloc</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> classPtr<span class="p">,</span> <span class="k">unsigned</span> storeSymId<span class="p">,</span> <span class="k">unsigned</span> instSymId<span class="p">,</span> <span class="k">unsigned</span> id<span class="p">,</span> <span class="k">unsigned</span> va_cnt<span class="p">,</span> va_list vl <span class="p">)</span>
<span class="p">{</span>
  
  <span class="c">//  if( va_cnt !=3 )
  //  {
  //    <a href="cmDspClass_h_0.html#cmDspClassErr">cmDspClassErr</a>(ctx,classPtr,<a href="cmDspClass_h_0.html#kVarArgParseFailDspRC">kVarArgParseFailDspRC</a>,&ampquotThe 'EchoCancel' constructor must have two arguments: a channel count and frequency array.&ampquot);
  //    return NULL;
  //  }</span>  
  
  <a href="#cmDspEchoCancel_t">cmDspEchoCancel_t</a><span class="p">*</span> p <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspInstAllocV">cmDspInstAllocV</a><span class="p">(</span><a href="#cmDspEchoCancel_t">cmDspEchoCancel_t</a><span class="p">,</span>ctx<span class="p">,</span>classPtr<span class="p">,</span>instSymId<span class="p">,</span>id<span class="p">,</span>storeSymId<span class="p">,</span>va_cnt<span class="p">,</span>vl<span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>   <span class="l">&quotmu&quot</span><span class="p">,</span>     <a href="#kMuEcId">kMuEcId</a><span class="p">,</span>        <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kDoubleDsvFl">kDoubleDsvFl</a><span class="p">,</span>   <span class="l">&quotNLSM mu coefficient.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>   <span class="l">&quotirN&quot</span><span class="p">,</span>    <a href="#kImpRespN_EcId">kImpRespN_EcId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>     <span class="l">&quotFilter impulse response length in samples.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>   <span class="l">&quotdelayN&quot</span><span class="p">,</span> <a href="#kDelayN_EcId">kDelayN_EcId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kUIntDsvFl">kUIntDsvFl</a><span class="p">,</span>     <span class="l">&quotFixed feedback delay in samples.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>   <span class="l">&quotbypass&quot</span><span class="p">,</span> <a href="#kBypassEcId">kBypassEcId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kBoolDsvFl">kBoolDsvFl</a><span class="p">,</span>     <span class="l">&quotBypass enable flag.&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>   <span class="l">&quotuf_in&quot</span><span class="p">,</span>  <a href="#kUnfiltInEcId">kUnfiltInEcId</a><span class="p">,</span>  <span class="l">0</span><span class="p">,</span><span class="l">1</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kAudioBufDsvFl">kAudioBufDsvFl</a><span class="p">,</span> <span class="l">&quotUnfiltered audio input&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>   <span class="l">&quotf_in&quot</span><span class="p">,</span>   <a href="#kFiltInEcId">kFiltInEcId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span><span class="l">1</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kInDsvFl">kInDsvFl</a>   <span class="p">|</span> <a href="cmDspValue_h_0.html#kAudioBufDsvFl">kAudioBufDsvFl</a><span class="p">,</span> <span class="l">&quotFiltered audio input&quot</span><span class="p">,</span>
  <span class="l">1</span><span class="p">,</span>   <span class="l">&quotout&quot</span><span class="p">,</span>    <a href="#kOutEcId">kOutEcId</a><span class="p">,</span>       <span class="l">0</span><span class="p">,</span><span class="l">1</span><span class="p">,</span> <a href="cmDspValue_h_0.html#kOutDsvFl">kOutDsvFl</a>  <span class="p">|</span> <a href="cmDspValue_h_0.html#kAudioBufDsvFl">kAudioBufDsvFl</a><span class="p">,</span> <span class="l">&quotAudio output&quot</span><span class="p">,</span>
  <span class="l">0</span> <span class="p">)</span><span class="p">;</span>
  
  
  p<span class="p">-</span><span class="p">&gt</span>r <span class="p">=</span> <a href="cmProc5_h_0.html#cmNlmsEcAlloc">cmNlmsEcAlloc</a><span class="p">(</span>ctx<span class="p">-</span><span class="p">&gt</span>cmProcCtx<span class="p">,</span> NULL<span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">0</span><span class="p">,</span><span class="l">0</span><span class="p">,</span><span class="l">0</span> <span class="p">)</span><span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetDefaultDouble">cmDspSetDefaultDouble</a><span class="p">(</span> ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kMuEcId">kMuEcId</a><span class="p">,</span>        <span class="l">0</span><span class="p">,</span> <span class="l">0.1</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>   ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kImpRespN_EcId">kImpRespN_EcId</a><span class="p">,</span> <span class="l">0</span><span class="p">,</span> <span class="l">2048</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultUInt">cmDspSetDefaultUInt</a><span class="p">(</span>   ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kDelayN_EcId">kDelayN_EcId</a><span class="p">,</span>   <span class="l">0</span><span class="p">,</span> <span class="l">1765</span><span class="p">)</span><span class="p">;</span>
  <a href="cmDspClass_h_0.html#cmDspSetDefaultBool">cmDspSetDefaultBool</a><span class="p">(</span>   ctx<span class="p">,</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">,</span> <a href="#kBypassEcId">kBypassEcId</a><span class="p">,</span>    <span class="l">0</span><span class="p">,</span> false<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>inst<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspEchoCancelSetup_defn"></a><a name="_cmDspEchoCancelSetup"></a><span class="f">_cmDspEchoCancelSetup</span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>          rc     <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspEchoCancel_t">cmDspEchoCancel_t</a><span class="p">*</span> p      <span class="p">=</span> <span class="p">(</span><a href="#cmDspEchoCancel_t">cmDspEchoCancel_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  <span class="k">double</span>             mu     <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspDouble">cmDspDouble</a><span class="p">(</span>inst<span class="p">,</span><a href="#kMuEcId">kMuEcId</a><span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>           hN     <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kImpRespN_EcId">kImpRespN_EcId</a><span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>           delayN <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kDelayN_EcId">kDelayN_EcId</a><span class="p">)</span><span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> <a href="cmProc5_h_0.html#cmNlmsEcInit">cmNlmsEcInit</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>r<span class="p">,</span><a href="cmDspClass_h_0.html#cmDspSampleRate">cmDspSampleRate</a><span class="p">(</span>ctx<span class="p">)</span><span class="p">,</span>mu<span class="p">,</span>hN<span class="p">,</span>delayN<span class="p">)</span> <span class="p">!</span><span class="p">=</span> <a href="cmGlobal_h_0.html#cmOkRC">cmOkRC</a> <span class="p">)</span>
    rc <span class="p">=</span> <a href="cmErr_h_0.html#cmErrMsg">cmErrMsg</a><span class="p">(</span><span class="p">&amp</span>inst<span class="p">-</span><span class="p">&gt</span>classPtr<span class="p">-</span><span class="p">&gt</span>err<span class="p">,</span> <a href="cmDspClass_h_0.html#kSubSysFailDspRC">kSubSysFailDspRC</a><span class="p">,</span> <span class="l">&quotUnable to initialize the internal echo canceller.&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspEchoCancelFree_defn"></a><a name="_cmDspEchoCancelFree"></a><span class="f">_cmDspEchoCancelFree</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>           rc <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspEchoCancel_t">cmDspEchoCancel_t</a><span class="p">*</span> p  <span class="p">=</span> <span class="p">(</span><a href="#cmDspEchoCancel_t">cmDspEchoCancel_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <a href="cmProc5_h_0.html#cmNlmsEcWrite">cmNlmsEcWrite</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>r<span class="p">,</span> <span class="l">&quot/Users/kevin/temp/kc&quot</span><span class="p">)</span><span class="p">;</span>
  
  <a href="cmProc5_h_0.html#cmNlmsEcFree">cmNlmsEcFree</a><span class="p">(</span><span class="p">&amp</span>p<span class="p">-</span><span class="p">&gt</span>r<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspEchoCancelReset_defn"></a><a name="_cmDspEchoCancelReset"></a><span class="f">_cmDspEchoCancelReset</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <span class="c">//<a href="#cmDspEchoCancel_t">cmDspEchoCancel_t</a>* p = (<a href="#cmDspEchoCancel_t">cmDspEchoCancel_t</a>*)inst;</span>
  
  <a href="cmDspClass_h_0.html#cmDspApplyAllDefaults">cmDspApplyAllDefaults</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <a href="#_cmDspEchoCancelSetup">_cmDspEchoCancelSetup</a><span class="p">(</span>ctx<span class="p">,</span> inst <span class="p">)</span><span class="p">;</span>
<span class="p">}</span> 

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspEchoCancelExec_defn"></a><a name="_cmDspEchoCancelExec"></a><span class="f">_cmDspEchoCancelExec</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a>          rc       <span class="p">=</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
  <a href="#cmDspEchoCancel_t">cmDspEchoCancel_t</a><span class="p">*</span> p        <span class="p">=</span> <span class="p">(</span><a href="#cmDspEchoCancel_t">cmDspEchoCancel_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  <span class="k">bool</span>               bypassFl <span class="p">=</span> true<span class="p">;</span> <span class="c"> // <a href="cmDspClass_h_0.html#cmDspBool">cmDspBool</a>(inst,<a href="#kBypassEcId">kBypassEcId</a>);</span>
  
  <span class="k">const</span> <a href="cmFloatTypes_h_0.html#cmSample_t">cmSample_t</a><span class="p">*</span>   fV <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBuf">cmDspAudioBuf</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kFiltInEcId">kFiltInEcId</a><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>            fN <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBufSmpCount">cmDspAudioBufSmpCount</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kFiltInEcId">kFiltInEcId</a><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">const</span> <a href="cmFloatTypes_h_0.html#cmSample_t">cmSample_t</a><span class="p">*</span>   uV <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBuf">cmDspAudioBuf</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kUnfiltInEcId">kUnfiltInEcId</a><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>            uN <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBufSmpCount">cmDspAudioBufSmpCount</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kUnfiltInEcId">kUnfiltInEcId</a><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  
  <a href="cmFloatTypes_h_0.html#cmSample_t">cmSample_t</a><span class="p">*</span>         yV <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBuf">cmDspAudioBuf</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kOutEcId">kOutEcId</a><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  <span class="k">unsigned</span>            yN <span class="p">=</span> <a href="cmDspClass_h_0.html#cmDspAudioBufSmpCount">cmDspAudioBufSmpCount</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span><a href="#kOutEcId">kOutEcId</a><span class="p">,</span><span class="l">0</span><span class="p">)</span><span class="p">;</span>
  
  assert<span class="p">(</span> fN<span class="p">=</span><span class="p">=</span>uN <span class="p">&amp</span><span class="p">&amp</span> fN<span class="p">=</span><span class="p">=</span>yN <span class="p">)</span><span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> bypassFl <span class="p">)</span>
  <span class="p">{</span>
    cmVOS_Copy<span class="p">(</span>yV<span class="p">,</span>yN<span class="p">,</span>uV<span class="p">)</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span>
  <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span> fV <span class="p">!</span><span class="p">=</span>NULL <span class="p">&amp</span><span class="p">&amp</span> uV <span class="p">!</span><span class="p">=</span> NULL <span class="p">&amp</span><span class="p">&amp</span> yV <span class="p">!</span><span class="p">=</span> NULL <span class="p">)</span>
    <span class="p">{</span>
      assert<span class="p">(</span> uN <span class="p">=</span><span class="p">=</span> yN <span class="p">&amp</span><span class="p">&amp</span> fN <span class="p">=</span><span class="p">=</span> yN <span class="p">)</span><span class="p">;</span>
      <a href="cmProc5_h_0.html#cmNlmsEcExec">cmNlmsEcExec</a><span class="p">(</span>p<span class="p">-</span><span class="p">&gt</span>r<span class="p">,</span>uV<span class="p">,</span>fV<span class="p">,</span>yV<span class="p">,</span>yN<span class="p">)</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="k">return</span> rc<span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspRC_t">cmDspRC_t</a> <a name="_cmDspEchoCancelRecv_defn"></a><a name="_cmDspEchoCancelRecv"></a><span class="f">_cmDspEchoCancelRecv</span><span class="p">(</span><a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspInst_t">cmDspInst_t</a><span class="p">*</span> inst<span class="p">,</span> <span class="k">const</span> <a href="cmDspClass_h_0.html#cmDspEvt_t">cmDspEvt_t</a><span class="p">*</span> evt <span class="p">)</span>
<span class="p">{</span>
  <a href="#cmDspEchoCancel_t">cmDspEchoCancel_t</a><span class="p">*</span>  p <span class="p">=</span> <span class="p">(</span><a href="#cmDspEchoCancel_t">cmDspEchoCancel_t</a><span class="p">*</span><span class="p">)</span>inst<span class="p">;</span>
  
  <a href="cmDspClass_h_0.html#cmDspSetEvent">cmDspSetEvent</a><span class="p">(</span>ctx<span class="p">,</span>inst<span class="p">,</span>evt<span class="p">)</span><span class="p">;</span>
  
  <span class="k">if</span><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>r <span class="p">!</span><span class="p">=</span> NULL <span class="p">)</span>
  <span class="p">{</span>
    <span class="k">switch</span><span class="p">(</span>evt<span class="p">-</span><span class="p">&gt</span>dstVarId<span class="p">)</span>
    <span class="p">{</span>
    <span class="k">case</span> <a href="#kMuEcId">kMuEcId</a><span class="p">:</span>
      <a href="cmProc5_h_0.html#cmNlmsEcSetMu">cmNlmsEcSetMu</a><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>r<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspReal">cmDspReal</a><span class="p">(</span>inst<span class="p">,</span><a href="#kMuEcId">kMuEcId</a><span class="p">)</span><span class="p">)</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
      
    <span class="k">case</span> <a href="#kImpRespN_EcId">kImpRespN_EcId</a><span class="p">:</span>
      <a href="cmProc5_h_0.html#cmNlmsEcSetIrN">cmNlmsEcSetIrN</a><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>r<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kImpRespN_EcId">kImpRespN_EcId</a><span class="p">)</span><span class="p">)</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
      
    <span class="k">case</span> <a href="#kDelayN_EcId">kDelayN_EcId</a><span class="p">:</span>
      <a href="cmProc5_h_0.html#cmNlmsEcSetDelayN">cmNlmsEcSetDelayN</a><span class="p">(</span> p<span class="p">-</span><span class="p">&gt</span>r<span class="p">,</span> <a href="cmDspClass_h_0.html#cmDspUInt">cmDspUInt</a><span class="p">(</span>inst<span class="p">,</span><a href="#kDelayN_EcId">kDelayN_EcId</a><span class="p">)</span><span class="p">)</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
      
    <span class="k">case</span> <a href="#kBypassEcId">kBypassEcId</a><span class="p">:</span>
      printf<span class="p">(</span><span class="l">&quotEC bypass:%i\n&quot</span><span class="p">,</span><a href="cmDspClass_h_0.html#cmDspBool">cmDspBool</a><span class="p">(</span>inst<span class="p">,</span><a href="#kBypassEcId">kBypassEcId</a><span class="p">)</span><span class="p">)</span><span class="p">;</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  printf<span class="p">(</span><span class="l">&quotmu:%f dN:%i hN:%i\n&quot</span><span class="p">,</span>p<span class="p">-</span><span class="p">&gt</span>r<span class="p">-</span><span class="p">&gt</span>mu<span class="p">,</span>p<span class="p">-</span><span class="p">&gt</span>r<span class="p">-</span><span class="p">&gt</span>delayN<span class="p">,</span>p<span class="p">-</span><span class="p">&gt</span>r<span class="p">-</span><span class="p">&gt</span>hN<span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <a href="cmDspClass_h_0.html#kOkDspRC">kOkDspRC</a><span class="p">;</span>
<span class="p">}</span>

<a href="cmDspClass_h_0.html#cmDspClass_t">cmDspClass_t</a><span class="p">*</span> <a name="cmEchoCancelClassCons_defn"></a><span class="f"><a href="cmDspKr_h_0.html#cmEchoCancelClassCons">cmEchoCancelClassCons</a></span><span class="p">(</span> <a href="cmDspCtx_h_0.html#cmDspCtx_t">cmDspCtx_t</a><span class="p">*</span> ctx <span class="p">)</span>
<span class="p">{</span>
  <a href="cmDspClass_h_0.html#cmDspClassSetup">cmDspClassSetup</a><span class="p">(</span><span class="p">&amp</span>_cmEchoCancelDC<span class="p">,</span>ctx<span class="p">,</span><span class="l">&quotEchoCancel&quot</span><span class="p">,</span>
  NULL<span class="p">,</span>
  <a href="#_cmDspEchoCancelAlloc">_cmDspEchoCancelAlloc</a><span class="p">,</span>
  <a href="#_cmDspEchoCancelFree">_cmDspEchoCancelFree</a><span class="p">,</span>
  <a href="#_cmDspEchoCancelReset">_cmDspEchoCancelReset</a><span class="p">,</span>
  <a href="#_cmDspEchoCancelExec">_cmDspEchoCancelExec</a><span class="p">,</span>
  <a href="#_cmDspEchoCancelRecv">_cmDspEchoCancelRecv</a><span class="p">,</span>
  NULL<span class="p">,</span>
  NULL<span class="p">,</span>
  <span class="l">&quotEcho canceller&quot</span><span class="p">)</span><span class="p">;</span>
  
  <span class="k">return</span> <span class="p">&amp</span>_cmEchoCancelDC<span class="p">;</span>
<span class="p">}</span></pre>
</div>
<!-- End nodes -->
</div>
</body>
</html>
