<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>cmMsgProtocol.h</title>
    <link href="cdg_code.css"    rel="stylesheet" type="text/css" media="screen" />
  </head>
  <body>
    <div class="highlight">

      <div class="license">
	<p>
	  Copyright (C) Kevin Larke 2009-2020
	</p>

	<p>
	  This file is part of libcm.
	</p>

	<p>
	  libcm is free software: you can redistribute it and/or modify it under
	  the terms of the GNU General Public License as published by the Free
	  Software Foundation, either version 3 of the License, or (at your
	  option) any later version.
	</p>

	<p>
	  libcm is distributed in the hope that it will be useful, but WITHOUT
	  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
	  FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
	  for more details.
	</p>

	<p>
	  See the GNU General Public License distributed with the libcm
	  package or look here: <https://www.gnu.org/licenses/>.
	</p>


      </div>

      <hr>
<a name="cmMsgProtocol.h"></a><!-- Begin nodes -->
<div class="cod"><div class="blk_title">cmMsgProtocol : Global constants and data structures for transmiting messages between threads and network nodes.</div><pre><a name="cmMsgProtocol_h_code_0"></a><span class="m">  #define </span><a name="cmAudDspSys_FILENAME"></a><span class="m">cmAudDspSys_FILENAME</span><span class="m"> "aud_dsp.js"</span>



<span class="c">// UI seletor id's used in the <a href="#cmDspUiHdr_t">cmDspUiHdr_t</a> selId field</span>
<span class="k">enum</span> 
<span class="p">{</span>
  <a name="kPrintDuiId"></a><span class="e">kPrintDuiId</span><span class="p">,</span>       <span class="c"> // ui&amplt--eng <a href="cmMain_c_0.html#print">print</a> the value to the console</span>
  <a name="kSliderDuiId"></a><span class="e">kSliderDuiId</span><span class="p">,</span>      <span class="c"> // ui&amplt--eng create a slider control</span>
  <a name="kButtonDuiId"></a><span class="e">kButtonDuiId</span><span class="p">,</span>      <span class="c"> // ui&amplt--eng create button control</span>
  <a name="kCheckDuiId"></a><span class="e">kCheckDuiId</span><span class="p">,</span>       <span class="c"> // ui&amplt--eng create a check box control</span>
  <a name="kLabelDuiId"></a><span class="e">kLabelDuiId</span><span class="p">,</span>       <span class="c"> // ui&amplt--eng create a label control</span>
  <a name="kTimeLineDuiId"></a><span class="e">kTimeLineDuiId</span><span class="p">,</span>    <span class="c"> // ui&amplt--eng create a time-line control</span>
  <a name="kScoreDuiId"></a><span class="e">kScoreDuiId</span><span class="p">,</span>       <span class="c"> // ui&amplt--eng create a score control</span>
  <a name="kTakeSeqBldrDuiId"></a><span class="e">kTakeSeqBldrDuiId</span><span class="p">,</span> <span class="c"> // ui&amplt--eng create a take sequence builder</span>
  <a name="kTakeSeqRendDuiId"></a><span class="e">kTakeSeqRendDuiId</span><span class="p">,</span> <span class="c"> // ui&amplt--eng create a take sequence renderer</span>
  <a name="kTwodDuiId"></a><span class="e">kTwodDuiId</span><span class="p">,</span>        <span class="c"> // ui&amplt--eng create a 2d control</span>
  <a name="kNumberDuiId"></a><span class="e">kNumberDuiId</span><span class="p">,</span>      <span class="c"> // ui&amplt--eng create a number box</span>
  <a name="kTextDuiId"></a><span class="e">kTextDuiId</span><span class="p">,</span>        <span class="c"> // ui&amplt--eng create a text entry control</span>
  <a name="kFnameDuiId"></a><span class="e">kFnameDuiId</span><span class="p">,</span>       <span class="c"> // ui&amplt--eng create a file/directory picker control</span>
  <a name="kMsgListDuiId"></a><span class="e">kMsgListDuiId</span><span class="p">,</span>     <span class="c"> // ui&amplt--eng create a msg list control</span>
  <a name="kMeterDuiId"></a><span class="e">kMeterDuiId</span><span class="p">,</span>       <span class="c"> // ui&amplt--eng create a meter display</span>
  <a name="kValueDuiId"></a><span class="e">kValueDuiId</span><span class="p">,</span>       <span class="c"> // ui&amplt-&ampgteng a control changed values </span>
  <a name="kColumnDuiId"></a><span class="e">kColumnDuiId</span><span class="p">,</span>      <span class="c"> // ui&amplt--eng start a new column</span>
  <a name="kHBorderDuiId"></a><span class="e">kHBorderDuiId</span><span class="p">,</span>     <span class="c"> // ui&amplt--eng insert a vertical border </span>
  <a name="kPageDuiId"></a><span class="e">kPageDuiId</span><span class="p">,</span>        <span class="c"> // ui&amplt--eng insert a new control page</span>
  
  <a name="kAudioSysCfgDuiId"></a><span class="e">kAudioSysCfgDuiId</span><span class="p">,</span>     <span class="c"> // ui&amplt--audio system cfg label </span>
  <a name="kAudioSysCfgDfltDuiId"></a><span class="e">kAudioSysCfgDfltDuiId</span><span class="p">,</span> <span class="c"> // ui&amplt--dflt audio system cfg label </span>
  <a name="kSubSysCntDuiId"></a><span class="e">kSubSysCntDuiId</span><span class="p">,</span>       <span class="c"> // ui&amplt--eng audio sub-system count</span>
  <a name="kDeviceDuiId"></a><span class="e">kDeviceDuiId</span><span class="p">,</span>          <span class="c"> // ui&amplt--eng device label</span>
  <a name="kProgramDuiId"></a><span class="e">kProgramDuiId</span><span class="p">,</span>         <span class="c"> // ui&amplt--eng program label</span>
  <a name="kProgramDfltDuiId"></a><span class="e">kProgramDfltDuiId</span><span class="p">,</span>     <span class="c"> // ui&amplt--eng dflt program label</span>
  <a name="kPgmDoneDuiId"></a><span class="e">kPgmDoneDuiId</span><span class="p">,</span>         <span class="c"> // ui&amplt--end the program is done </span>
  
  <span class="c">// The following selId's are used by cmAudDsp to indicate various commands.</span>
  <a name="kSetAudioCfgDuiId"></a><span class="e">kSetAudioCfgDuiId</span><span class="p">,</span>     <span class="c"> // 1) select an audio system setup</span>
  <a name="kSetAudioDevDuiId"></a><span class="e">kSetAudioDevDuiId</span><span class="p">,</span>     <span class="c"> // 2) (optional) set an audio device on an audio sub-system</span>
  <a name="kSetSampleRateDuiId"></a><span class="e">kSetSampleRateDuiId</span><span class="p">,</span>   <span class="c"> // 3) (optional) set the sample rate of an audio sub-system</span>
  <a name="kSetPgmDuiId"></a><span class="e">kSetPgmDuiId</span><span class="p">,</span>          <span class="c"> // 4) select a program</span>
  <a name="kEnableDuiId"></a><span class="e">kEnableDuiId</span><span class="p">,</span>          <span class="c"> // 5) enable/disable the audio system (also resets the DSP system)</span>
  <a name="kSyncDuiId"></a><span class="e">kSyncDuiId</span><span class="p">,</span>            <span class="c"> // 6) sent by cmAudDsp to client to indicate sync success or failure.</span>
  <a name="kSetNotifyEnableDuiId"></a><span class="e">kSetNotifyEnableDuiId</span><span class="p">,</span> <span class="c"> // enable/disable periodic status notification from the audio system.</span>
  <a name="kClientMsgPollDuiId"></a><span class="e">kClientMsgPollDuiId</span><span class="p">,</span>   <span class="c"> // Periodic check for and deliver messages waiting in the audio system for delivery to the client. </span>
  <a name="kSendMsgDuiId"></a><span class="e">kSendMsgDuiId</span><span class="p">,</span>         <span class="c"> // forward msg to the audio system</span>
  <a name="kDevReportDuiId"></a><span class="e">kDevReportDuiId</span><span class="p">,</span>       <span class="c"> // <a href="cmMain_c_0.html#print">print</a> a device report</span>
  <a name="kPrintPgmDuiId"></a><span class="e">kPrintPgmDuiId</span><span class="p">,</span>        <span class="c"> // write the currently loaded pgm as a JSON file</span>
  
  <a name="kRightAlignDuiId"></a><span class="e">kRightAlignDuiId</span> <span class="p">=</span> <span class="l">0</span><span class="p">,</span>  <span class="c"> // label alignment id used by <a href="#kLabelDuiId">kLabelDuiId</a> </span>
  <a name="kLeftAlignDuiId"></a><span class="e">kLeftAlignDuiId</span><span class="p">,</span>  
  <a name="kCenterAlignDuiId"></a><span class="e">kCenterAlignDuiId</span>
<span class="p">}</span><span class="p">;</span>

<span class="k">enum</span>
<span class="p">{</span>
  <a name="kDuplexDuiFl"></a><span class="e">kDuplexDuiFl</span> <span class="p">=</span> <span class="l">0x01</span>
<span class="p">}</span><span class="p">;</span>

<span class="c">// Header record for all messages between the host and the DSP controllers.</span>
<a name="cmDspUiHdr_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <span class="k">unsigned</span>     <a name="cmDspUiHdr_t.asSubIdx"></a><span class="i">asSubIdx</span><span class="p">;</span>  <span class="c"> // the audio sub-system this UI belongs to</span>
  <span class="k">unsigned</span>     <a name="cmDspUiHdr_t.uiId"></a><span class="i">uiId</span><span class="p">;</span>      <span class="c"> // msg type kXXXAsId </span>
  <span class="k">unsigned</span>     <a name="cmDspUiHdr_t.selId"></a><span class="i">selId</span><span class="p">;</span>     <span class="c"> // action to perform see above</span>
  <span class="k">unsigned</span>     <a name="cmDspUiHdr_t.flags"></a><span class="i">flags</span><span class="p">;</span>     <span class="c"> </span>
  <span class="k">unsigned</span>     <a name="cmDspUiHdr_t.instId"></a><span class="i">instId</span><span class="p">;</span>    <span class="c"> // DSP instance id</span>
  <span class="k">unsigned</span>     <a name="cmDspUiHdr_t.instVarId"></a><span class="i">instVarId</span><span class="p">;</span> <span class="c"> // DSP instance var id</span>
  
  <span class="c">// The <a href="cmDspValue_h_0.html#cmDspValue_t">cmDspValue_t</a> field must come last in the structure in
  // order for the <a href="cmDspValue_h_0.html#cmDsvSerialize">cmDsvSerialize</a>() to work in cmDspUI.c:_cmDspUiMsg().</span>  
  <a href="cmDspValue_h_0.html#cmDspValue_t">cmDspValue_t</a> <a name="cmDspUiHdr_t.value"></a><span class="i">value</span><span class="p">;</span>     <span class="c"> // Data value associated with this msg. </span>
<span class="p">}</span> <span class="t"><a href="#cmDspUiHdr_t">cmDspUiHdr_t</a></span><span class="p">;</span>


<span class="c">// <a href="#cmDspNetMsg_t">cmDspNetMsg_t</a> sub-selector id's</span>
<span class="k">enum</span> <span class="p">{</span>
  <a name="kNetHelloSelAsId"></a><span class="e">kNetHelloSelAsId</span><span class="p">,</span>     <span class="c"> // node-&ampgtnode awake msg </span>
  <a name="kNetDstIdReqSelAsId"></a><span class="e">kNetDstIdReqSelAsId</span><span class="p">,</span>  <span class="c"> // src-&ampgtdst request a dst id</span>
  <a name="kNetDstIdReqDoneAsId"></a><span class="e">kNetDstIdReqDoneAsId</span><span class="p">,</span> <span class="c"> // src-&ampgtdst all requests have been sent</span>
  <a name="kNetDstIdSelAsId"></a><span class="e">kNetDstIdSelAsId</span><span class="p">,</span>     <span class="c"> // dst-&ampgtsrc provide dst id</span>
  <a name="kNetDoneSelAsId"></a><span class="e">kNetDoneSelAsId</span><span class="p">,</span>      <span class="c"> // node-&ampgtnode sync done</span>
  <a name="kNetErrSelAsId"></a><span class="e">kNetErrSelAsId</span><span class="p">,</span>       <span class="c"> // node-&ampgtnode sync error</span>
  <a name="kNetEvtSelAsId"></a><span class="e">kNetEvtSelAsId</span>        <span class="c"> // src-&ampgtdst send cmDspEvnt_t</span>
<span class="p">}</span><span class="p">;</span>

<span class="c">// Message Layout [ <a href="#cmDspNetMsg_t">cmDspNetMsg_t</a> dstInstLabel[] dstVarLabel[] ]</span>
<a name="cmDspNetMsg_t"></a><span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <span class="k">unsigned</span> <a name="cmDspNetMsg_t.asSubIdx"></a><span class="i">asSubIdx</span><span class="p">;</span>
  <span class="k">unsigned</span> <a name="cmDspNetMsg_t.selId"></a><span class="i">selId</span><span class="p">;</span>       <span class="c"> // <a href="cmAudioSysMsg_h_0.html#kNetSyncSelAsId">kNetSyncSelAsId</a></span>
  <span class="k">unsigned</span> <a name="cmDspNetMsg_t.subSelId"></a><span class="i">subSelId</span><span class="p">;</span>    <span class="c"> // see above kNetXXXSelAsId</span>
  <span class="k">unsigned</span> <a name="cmDspNetMsg_t.srcId"></a><span class="i">srcId</span><span class="p">;</span> 
  <span class="k">unsigned</span> <a name="cmDspNetMsg_t.dstId"></a><span class="i">dstId</span><span class="p">;</span>
  <a href="cmDspValue_h_0.html#cmDspValue_t">cmDspValue_t</a> <a name="cmDspNetMsg_t.value"></a><span class="i">value</span><span class="p">;</span>
  <span class="c">// char dstInstLabel[] - with <a href="cmAudioSysMsg_h_0.html#kNetSyncSelAsId">kNetSyncSelAsId</a> only
  // char dstVarLabel[]  - with <a href="cmAudioSysMsg_h_0.html#kNetSyncSelAsId">kNetSyncSelAsId</a> only</span>  
<span class="p">}</span> <span class="t"><a href="#cmDspNetMsg_t">cmDspNetMsg_t</a></span><span class="p">;</span>

<span class="k">enum</span>
<span class="p">{</span>
  <a name="kOkMsgRC"></a><span class="e">kOkMsgRC</span> <span class="p">=</span> <a href="cmGlobal_h_0.html#cmOkRC">cmOkRC</a><span class="p">,</span>
  <a name="kSerializeFailMsgRC"></a><span class="e">kSerializeFailMsgRC</span><span class="p">,</span>
  <a name="kSendFailMsgRC"></a><span class="e">kSendFailMsgRC</span><span class="p">,</span>
  <a name="kDecodeFailMsgRC"></a><span class="e">kDecodeFailMsgRC</span>
<span class="p">}</span><span class="p">;</span>

<span class="k">typedef</span> <a href="cmGlobal_h_0.html#cmRC_t">cmRC_t</a> <a name="cmMsgRC_t"></a><span class="t">cmMsgRC_t</span><span class="p">;</span>


<span class="k">typedef</span> <a href="#cmMsgRC_t">cmMsgRC_t</a> <span class="p">(</span><span class="p">*</span><a name="cmMsgSendFuncPtr_t"></a><span class="t">cmMsgSendFuncPtr_t</span><span class="p">)</span><span class="p">(</span><span class="k">void</span><span class="p">*</span> <span class="i">cbDataPtr</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">msgByteCnt</span><span class="p">,</span> <span class="k">const</span> <span class="k">void</span><span class="p">*</span> <span class="i">msg</span> <span class="p">)</span><span class="p">;</span>

<a href="#cmMsgRC_t">cmMsgRC_t</a> <a name="cmMsgSend"></a>cmMsgSend<span class="p">(</span> 
<a href="cmErr_h_0.html#cmErr_t">cmErr_t</a><span class="p">*</span>            <span class="i">err</span><span class="p">,</span> 
<span class="k">unsigned</span>            <span class="i">asSubIdx</span><span class="p">,</span>
<span class="k">unsigned</span>            <span class="i">msgTypeId</span><span class="p">,</span>
<span class="k">unsigned</span>            <span class="i">selId</span><span class="p">,</span>
<span class="k">unsigned</span>            <span class="i">flags</span><span class="p">,</span>
<span class="k">unsigned</span>            <span class="i">instId</span><span class="p">,</span>
<span class="k">unsigned</span>            <span class="i">instVarId</span><span class="p">,</span>
<span class="k">const</span> <a href="cmDspValue_h_0.html#cmDspValue_t">cmDspValue_t</a><span class="p">*</span> <span class="i">valPtr</span><span class="p">,</span>
<a href="#cmMsgSendFuncPtr_t">cmMsgSendFuncPtr_t</a>  <span class="i">sendFunc</span><span class="p">,</span>
<span class="k">void</span><span class="p">*</span>               <span class="i">cbDataPtr</span> <span class="p">)</span><span class="p">;</span>

<a href="#cmMsgRC_t">cmMsgRC_t</a> <a name="cmMsgPeekAsSubIndex"></a><span class="f">cmMsgPeekAsSubIndex</span><span class="p">(</span> <span class="k">const</span> <span class="k">void</span><span class="p">*</span> msgArray<span class="p">[</span><span class="i">]</span><span class="p">,</span> <span class="k">unsigned</span> msgByteCntArray<span class="p">[</span><span class="i">]</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">segCnt</span><span class="p">,</span> <span class="k">unsigned</span><span class="p">*</span> <span class="i">retValPtr</span> <span class="p">)</span><span class="p">;</span>
<a href="#cmMsgRC_t">cmMsgRC_t</a> <a name="cmMsgPeekMsgTypeId"></a><span class="f">cmMsgPeekMsgTypeId</span><span class="p">(</span>  <span class="k">const</span> <span class="k">void</span><span class="p">*</span> msgArray<span class="p">[</span><span class="i">]</span><span class="p">,</span> <span class="k">unsigned</span> msgByteCntArray<span class="p">[</span><span class="i">]</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">segCnt</span><span class="p">,</span> <span class="k">unsigned</span><span class="p">*</span> <span class="i">retValPtr</span> <span class="p">)</span><span class="p">;</span>
<a href="#cmMsgRC_t">cmMsgRC_t</a> <a name="cmMsgPeekSelId"></a><span class="f">cmMsgPeekSelId</span><span class="p">(</span>      <span class="k">const</span> <span class="k">void</span><span class="p">*</span> msgArray<span class="p">[</span><span class="i">]</span><span class="p">,</span> <span class="k">unsigned</span> msgByteCntArray<span class="p">[</span><span class="i">]</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">segCnt</span><span class="p">,</span> <span class="k">unsigned</span><span class="p">*</span> <span class="i">retValPtr</span> <span class="p">)</span><span class="p">;</span>
<a href="#cmMsgRC_t">cmMsgRC_t</a> <a name="cmMsgPeekFlags"></a><span class="f">cmMsgPeekFlags</span><span class="p">(</span>      <span class="k">const</span> <span class="k">void</span><span class="p">*</span> msgArray<span class="p">[</span><span class="i">]</span><span class="p">,</span> <span class="k">unsigned</span> msgByteCntArray<span class="p">[</span><span class="i">]</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">segCnt</span><span class="p">,</span> <span class="k">unsigned</span><span class="p">*</span> <span class="i">retValPtr</span> <span class="p">)</span><span class="p">;</span>
<a href="#cmMsgRC_t">cmMsgRC_t</a> <a name="cmMsgPeekInstId"></a><span class="f">cmMsgPeekInstId</span><span class="p">(</span>     <span class="k">const</span> <span class="k">void</span><span class="p">*</span> msgArray<span class="p">[</span><span class="i">]</span><span class="p">,</span> <span class="k">unsigned</span> msgByteCntArray<span class="p">[</span><span class="i">]</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">segCnt</span><span class="p">,</span> <span class="k">unsigned</span><span class="p">*</span> <span class="i">retValPtr</span> <span class="p">)</span><span class="p">;</span>
<a href="#cmMsgRC_t">cmMsgRC_t</a> <a name="cmMsgPeekInstVarId"></a><span class="f">cmMsgPeekInstVarId</span><span class="p">(</span>  <span class="k">const</span> <span class="k">void</span><span class="p">*</span> msgArray<span class="p">[</span><span class="i">]</span><span class="p">,</span> <span class="k">unsigned</span> msgByteCntArray<span class="p">[</span><span class="i">]</span><span class="p">,</span> <span class="k">unsigned</span> <span class="i">segCnt</span><span class="p">,</span> <span class="k">unsigned</span><span class="p">*</span> <span class="i">retValPtr</span> <span class="p">)</span><span class="p">;</span>
</pre>
</div>
<!-- End nodes -->
</div>
</body>
</html>
